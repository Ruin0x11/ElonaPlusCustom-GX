*act_throw
	if ( inv(INV_ITEM_PROPERTY, ci) == PROPERTY_NPC | inv(INV_ITEM_PROPERTY, ci) == PROPERTY_SPECIAL ) {
		snd SOUNDLIST_FAIL1
		txt lang("それはあなたの物ではない。", "It's not your property."), lang("盗むなんてとんでもない。", "You can't just take it."), lang("それは拾えない。", "It's not yours.")
		goto *pc_turn
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT ) {
		if ( limit(inv(INV_ITEM_WEIGHT, ci) / 1000, 0, 1000) > sdata(SKILL_NORMAL_WEIGHT_LIFTING, CHARA_PLAYER) + 5 ) {
			txt lang("重すぎて投げられない…！", "It is too heavy!")
			snd SOUNDLIST_FAIL1
			goto *pc_turn
		}
	}
	if ( ibit(ITEM_BIT_NO_DROP, ci) ) {
		snd SOUNDLIST_FAIL1
		txt lang("それはあなたの大事なものだ。<調べる>メニューから解除できる。", "It's set as no-drop. You can reset it from the <examine> menu.")
		goto *pc_turn
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION | inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO | inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER | inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT | inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
		if ( inv(INV_ITEM_ID, ci) != ITEM_ID_EMPTY_BOTTLE ) {
			stc = -1
			if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
				stc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cc == CHARA_PLAYER ) {
					if ( cdata(CDATA_IN_TAGTEAM, stc) != 0 ) {
						txtselecttc 2
						repeat 2
							promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
							promptmax++
						loop
						val = promptx, prompty, 200, 0
						gosub *prompt_key
						if ( rtval == 1 ) {
							stc = cdata(CDATA_TAGTEAM_PARTNER, stc)
						}
					}
				}
			}
		}
	}
	if ( kakeru != 100 ) {
		if ( synccheck(cc, -1) ) {
			txt lang(name(cc) + "は" + itemname(ci, 1) + "を投げた。", name(cc) + " throw" + _s(cc) + " " + itemname(ci, 1) + ".")
		}
	}
	if ( kakeru == 100 ) {
		if ( synccheck(cc, -1) ) {
			txt lang(name(cc) + "は" + itemname(ci, 1) + "を自分にかけた。", name(cc) + " pour on " + itemname(ci, 1) + ".")
		}
	}
	if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tlocx, tlocy) * 4 > rnd(sdata(SKILL_WEAPON_THROWING, cc) + 10) + sdata(SKILL_WEAPON_THROWING, cc) / 4 ) {
		x = tlocx + rnd(2) - rnd(2)
		y = tlocy + rnd(2) - rnd(2)
		if ( x >= 0 ) {
			if ( y >= 0 ) {
				if ( x < mdata(MDATA_WIDTH) ) {
					if ( y < mdata(MDATA_HEIGHT) ) {
						if ( (chipm(CHIPM_ATTRIB, map(x, y, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS) == 0 ) {
							tlocx = x
							tlocy = y
						}
					}
				}
			}
		}
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CHESTNUT & inv(INV_ITEM_PARAM2, ci) == 0 & cdatan(CDATAN_FAKE_CLASS, cc) == "錬金術士" ) {
		if ( jp ) {
			txt "「うにーっ！」"
		}
	}
	animeid = ANIMATION_THROW
	aniref = inv(INV_ITEM_PIC, ci), inv(INV_ITEM_COL, ci)
	anix = tlocx
	aniy = tlocy
	gosub *anime
	ti = inv_getfreeid(-1)
	removeitem ci, 1
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MONSTER_BALL | (inv(INV_ITEM_ID, ci) == ITEM_ID_CHESTNUT & inv(INV_ITEM_PARAM2, ci) == 0) | inv(INV_ITEM_ID, ci) == ITEM_ID_DUEL_GLOVE | inv(INV_ITEM_ID, ci) == ITEM_ID_LULWYS_PHOTO_COLLECTION | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
		if ( ti != (-1) ) {
			item_copy ci, ti
			inv(INV_ITEM_NUM, ti) = 1
			inv(INV_ITEM_X, ti) = tlocx
			inv(INV_ITEM_Y, ti) = tlocy
			ci = ti
		}
	}
	if ( cc == CHARA_PLAYER ) {
		gosub *calcBurdenPc
	}
	animeid = ANIMATION_CRUSH
	x = tlocx
	y = tlocy
	gosub *anime
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MONSTER_BALL | inv(INV_ITEM_ID, ci) == ITEM_ID_LITTLE_BALL ) {
		snd SOUNDLIST_THROW2
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
				if ( tc != CHARA_PLAYER ) {
					if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
					txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
				}
			}
			txtmore
			txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MONSTER_BALL ) {
				if ( tc < MAX_CHARA_SAVE | cdata(CDATA_ROLE, tc) != ROLE_NONE | cdata(CDATA_QUALITY, tc) == FIX_QUALITY_UNIQUE | cbit(CHARA_BIT_PRECIOUS, tc) == TRUE | cbit(CHARA_BIT_NECRO, tc) == TRUE | gdata(GDATA_FLAG_DUEL_TARGET) == tc ) {
					txt lang("その生物には無効だ。", "The creature can't be captured.")
					goto *turn_end
				}
				if ( cdata(CDATA_LEVEL, tc) > inv(INV_ITEM_PARAM2, ci) ) {
					txt lang("その生物を捕獲するには、より高レベルのモンスターボールが必要だ。", "Power level of the ball is not enough to capture the creature.")
					goto *turn_end
				}
				if ( cdata(CDATA_HP, tc) > cdata(CDATA_MAX_HP, tc) / 10 ) {
					txt lang("捕獲するためにはもっと弱らせる必要がある。", "You need to weaken the creature to capture it.")
					goto *turn_end
				}
				if ( gdata(GDATA_AREA) == AREA_ARENA | gdata(GDATA_AREA) == AREA_PET_ARENA | gdata(GDATA_AREA) == AREA_SHOW_HOUSE | (gdata(GDATA_AREA) == AREA_SHELTER & gdata(GDATA_LEVEL) == 1) ) {
					txt lang("この場所では捕獲できない。", "This doesn't work in this area.")
					goto *turn_end
				}
				txtef COLOR_GREEN
				txt lang(name(tc) + "をモンスターボールに捕獲した。", "You capture " + name(tc) + ".")
				animeload 8, tc
				inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, tc)
				inv(INV_ITEM_PARAM3, ci) = cdata(CDATA_LEVEL, tc)
				inv(INV_ITEM_WEIGHT, ci) = 10000
				inv(INV_ITEM_VALUE, ci) = 1000
			}
			else {
				if ( cdata(CDATA_ID, tc) != CREATURE_ID_LITTLE_SISTER | tc < MAX_CHARA_FOLLOWER | gdata(GDATA_FLAG_DUEL_TARGET) == tc ) {
					txt lang("何もおきない… ", "Nothing happens...")
					goto *turn_end
				}
				if ( gdata(GDATA_AREA) == AREA_ARENA | gdata(GDATA_AREA) == AREA_PET_ARENA | gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
					txt lang("この場所では効果がない。", "This doesn't work in this area.")
					goto *turn_end
				}
				rc = tc
				gosub *add_ally
			}
			chara_vanquish tc
			check_quest
		}
		goto *turn_end
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION | inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO | inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER | inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT | inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
		if ( inv(INV_ITEM_ID, ci) != ITEM_ID_EMPTY_BOTTLE ) {
			if ( synccheck(tlocx, tlocy) ) {
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
					snd SOUNDLIST_SNOW
				}
				else {
					if ( inv(INV_ITEM_ID, ci) != ITEM_ID_NATTO ) {
						snd SOUNDLIST_CRUSH2
					}
					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
						snd SOUNDLIST_WATER2
					}
				}
			}
			if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
				tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( stc != (-1) ) {
					tc = stc
				}
				if ( kakeru != 100 ) {
					txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
				}
				if ( kakeru != 0 ) {
					kakeru = 0
				}
				if ( inv(INV_ITEM_ID, ci) != ITEM_ID_MOLOTOV & inv(INV_ITEM_ID, ci) != ITEM_ID_BOTTLE_SULFURIC & inv(INV_ITEM_ID, ci) != ITEM_ID_HANDFUL_SNOW & inv(INV_ITEM_ID, ci) != ITEM_ID_TOMATO & inv(INV_ITEM_ID, ci) != ITEM_ID_ESSENTIAL_OIL & inv(INV_ITEM_ID, ci) != ITEM_ID_GASOLINE & inv(INV_ITEM_ID, ci) != ITEM_ID_BUTTER & inv(INV_ITEM_ID, ci) != ITEM_ID_YOGURT & inv(INV_ITEM_ID, ci) != ITEM_ID_NATTO ) {
					wet tc, 25
				}
				rowact_check tc
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
					if ( synccheck(tc, -1) ) {
						if ( tc != CHARA_PLAYER ) {
							txtef COLOR_SKY_BLUE
							txtmore
							txt lang("「いてー！」", cnvtalk("Hey!")), lang("「やったな」", cnvtalk("Now you did it.")), lang(" *クスクス* ", "*chuckle*"), lang("「キャハハ」", cnvtalk("Tee-hee-hee!")), lang("「こやつめ」", cnvtalk("You'll pay for this.")), lang("「むむっ」", "*grin*")
						}
					}
					goto *turn_end
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_BLUE
						txt lang(" *ぷちゅ* ", "*crumble*")
					}
					if ( inv(INV_ITEM_PARAM3, ci) == (-1) ) {
						if ( synccheck(tc, -1) ) {
							txtef COLOR_BLUE
							txt lang(name(tc) + "は怒りに体を奮わせた！", name(tc) + " " + is(tc) + " engulfed in fury!")
						}
						if ( cdata(CDATA_CONDITION_ANGRY, tc) == 0 ) {
							cdata(CDATA_CONDITION_ANGRY, tc) += rnd(10) + 5
						}
					}
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					goto *turn_end
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_BLUE
						txt lang(" *ねばー* ", "*crumble*")
					}
					if ( synccheck(tc, -1) ) {
						txtef COLOR_BLUE
						txt lang(name(tc) + "は怒りに体を奮わせた！", name(tc) + " " + is(tc) + " engulfed in fury!")
					}
					if ( cdata(CDATA_CONDITION_ANGRY, tc) == 0 ) {
						cdata(CDATA_CONDITION_ANGRY, tc) += 5 + inv(INV_ITEM_LEVEL, ci)
					}
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					goto *turn_end
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_YELLOW
						txt lang(name(tc) + "は香ばしいバターまみれになった。「べちゃべちゃする…」", name(tc) + " " + is(tc) + " engulfed in fury!")
					}
					if ( cdata(CDATA_BRUSH_LEVEL, tc) <= 1 ) {
						cdata(CDATA_BRUSH_LEVEL, tc)++
					}
					cdata(CDATA_CONDITION_OIL, tc) += 15
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					goto *turn_end
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_BLUE
						txt lang(name(tc) + "は怒りに体を奮わせた！", name(tc) + " " + is(tc) + " engulfed in fury!")
					}
					cdata(CDATA_CONDITION_ANGRY, tc) += rnd(3) + 5
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					goto *turn_end
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MOLOTOV ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_BLUE
						txt lang(name(tc) + "は、燃料まみれになった。", name(tc) + " became the oil covered.")
					}
					cdata(CDATA_CONDITION_OIL, tc) += 5
				}
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					if ( cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE ) {
						hostileaction cc, tc
					}
				}
				ccthrowpotion = cc
				potionthrow = 100
				cc = tc
				dbmode = DBMODE_ON_DRINK
				dbid = inv(INV_ITEM_ID, ci)
				gosub *db_item
				cc = ccthrowpotion
				if ( gdata(GDATA_QUICK_USE) == 1 & cc == CHARA_PLAYER ) {
					snd SOUNDLIST_THROW2
					gdata(GDATA_QUICK_USE) = 0
					goto *pc_turn
				}
				else {
					goto *turn_end
				}
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
				if ( map(tlocx, tlocy, MAP_ITEM_CHIPS) != 0 ) {
					cell_itemlist tlocx, tlocy
					f = 0
					repeat listmax
						p = list(0, cnt)
						if ( inv(INV_ITEM_ID, p) == ITEM_ID_SNOW_MAN ) {
							if ( synccheck(tlocx, tlocy) ) {
								txtmore
								txt lang(itemname(p, 1) + "に命中して、雪だるまは崩れた。", "It hits " + itemname(p, 1) + " and breaks it.")
							}
							inv(INV_ITEM_NUM, p)--
							f = 1
							break
						}
					loop
					if ( f == 1 ) {
						cell_refresh tlocx, tlocy
						goto *turn_end
					}
				}
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
				if ( chipm(CHIPM_ROLE, map(tlocx, tlocy, MAP_TILE_ID)) == MAP_CHIP_ROLE_SNOW ) {
					goto *turn_end
				}
				if ( synccheck(tlocx, tlocy) ) {
					txtmore
					txt lang("それは地面に落ちて溶けた。", "It falls on the ground and melts.")
				}
			}
			else {
				if ( synccheck(tlocx, tlocy) ) {
					txtmore
					txt lang("それは地面に落ちて砕けた。", "It falls on the ground and shatters.")
				}
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_YOGURT | inv(INV_ITEM_ID, ci) == ITEM_ID_BUTTER | inv(INV_ITEM_ID, ci) == ITEM_ID_NATTO ) {
				if ( synccheck(tlocx, tlocy) ) {
					txtef COLOR_BLUE
					txt lang(" *べちゃ* ", "*crumble*")
				}
				goto *turn_end
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOMATO ) {
				if ( synccheck(tlocx, tlocy) ) {
					txtef COLOR_BLUE
					txt lang(" *ぷちゅ* ", "*crumble*")
				}
				goto *turn_end
			}
			efp = 50 + sdata(SKILL_WEAPON_THROWING, cc) * 10
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BOTTLE_SULFURIC ) {
				addmef tlocx, tlocy, MEF_TYPE_ACID, xy2pic(19, 0), rnd(15) + 5, efp, cc
				goto *turn_end
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MOLOTOV ) {
				addmef tlocx, tlocy, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 25, efp, cc
				mapitem_fire tlocx, tlocy
				goto *turn_end
			}
			addmef tlocx, tlocy, MEF_TYPE_POTION, xy2pic(27, 0), -1, efp, cc, inv(INV_ITEM_ID, ci), inv(INV_ITEM_STATUS, ci), inv(INV_ITEM_COL, ci)
			if ( gdata(GDATA_QUICK_USE) == 1 & cc == CHARA_PLAYER ) {
				snd SOUNDLIST_THROW2
				gdata(GDATA_QUICK_USE) = 0
				goto *pc_turn
			}
			else {
				goto *turn_end
			}
		}
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SUIGARA ) {
		snd SOUNDLIST_THROW2
		snd SOUNDLIST_FIRE1
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( synccheck(tc, -1) ) {
				txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
			}
			rowact_check tc
			if ( tc >= MAX_CHARA_FOLLOWER ) {
				hostileaction cc, tc
			}
			efid = SKILL_EFFECT_POTION_MOLOTOV
			efp = 40
			gosub *effect
		}
		else {
			addmef tlocx, tlocy, MEF_TYPE_FIRE, xy2pic(24, 0), 0, 40, cc
			mapitem_fire tlocx, tlocy
		}
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CHESTNUT & inv(INV_ITEM_PARAM2, ci) == 0 ) {
		snd SOUNDLIST_THROW2
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
				if ( tc != CHARA_PLAYER ) {
					if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
					txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
				}
			}
			if ( synccheck(tc, -1) ) {
				txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
			}
			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
				skillexp SKILL_NORMAL_TACTICS, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 3 - sdata(SKILL_NORMAL_TACTICS, cc) + 1, 5, 80)
				skillexp SKILL_WEAPON_THROWING, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 3 - sdata(SKILL_WEAPON_THROWING, cc) + 1, 5, 80)
			}
			rowact_check tc
			snd seatk2
			if ( tc >= MAX_CHARA_FOLLOWER ) {
				hostileaction cc, tc
			}
			dmghp tc, rnd(sdata(SKILL_WEAPON_THROWING, cc) * 2) + 1, cc, SKILL_RESDMG_CHESTNUT, 1000
			dmghp tc, (sdata(SKILL_WEAPON_THROWING, cc) + 2) / 2, cc, SKILL_RESDMG_CUT, 500
			if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHESTNUT_GIANT ) {
				txt lang("「お、おのれ！卑劣な真似を！」", "Chestnut giant yells, " + cnvtalk("You idiot!"))
				dmghp tc, cdata(CDATA_MAX_HP, tc) / 10, cc, SKILL_RESDMG_CHESTNUT, 1000
			}
			if ( gdata(GDATA_FLAG_THROWN_CHESTNUTS) < 100 ) {
				gdata(GDATA_FLAG_THROWN_CHESTNUTS)++
			}
		}
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_LULWYS_PHOTO_COLLECTION ) {
		snd SOUNDLIST_THROW2
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( synccheck(tc, -1) ) {
				txt lang(name(tc) + "の足元に落ちた。", "It hits " + name(tc) + "!")
			}
			rowact_check tc
		}
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DUEL_GLOVE ) {
		snd SOUNDLIST_THROW2
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( synccheck(tc, -1) ) {
				txt lang(name(tc) + "の足元に落ちた。", "It hits " + name(tc) + "!")
			}
			rowact_check tc
			if ( cdata(CDATA_CONDITION_SLEEP, tc) != 0 | cdata(CDATA_CONDITION_PARALYZE, tc) != 0 | cdata(CDATA_CONDITION_BLIND, tc) != 0 | cdata(CDATA_CONDITION_FEAR, tc) != 0 | cdata(CDATA_CONDITION_DIM, tc) != 0 ) {
				goto *turn_end
			}
			if ( gdata(GDATA_FLAG_DUEL_TARGET) <= 0 & gdata(GDATA_FLAG_DUEL_TARGET) != tc & cdata(CDATA_RELATION, tc) == RELATION_NEUTRAL & tc >= MAX_CHARA_FOLLOWER ) {
				gdata(GDATA_FLAG_DUEL_TARGET) = tc
				gdata(GDATA_FLAG_TIMES_DUELED)++
				snd SOUNDLIST_GET1
				txt lang(name(tc) + "は手袋を拾い上げ、臨戦態勢に入った。＊決闘開始＊", "*Duel!!*")
				inv(INV_ITEM_NUM, ci)--
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				snd SOUNDLIST_CHEER
				cdata(CDATA_EMO_ICON, tc) = 18 + 100 * 4
				cdata(CDATA_RELATION, tc) = RELATION_ENEMY
				cdata(CDATA_AI_AGGRO, tc) = 80
				cdata(CDATA_TARGET, tc) = 0
			}
			else {
				if ( tc != CHARA_PLAYER ) {
					txt lang(name(tc) + "に鼻で笑われた。", name(tc) + " ridiculed you.")
				}
			}
		}
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SOYBEAN | inv(INV_ITEM_ID, ci) == ITEM_ID_TOFU ) {
		snd SOUNDLIST_THROW2
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( synccheck(tc, -1) ) {
				txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
			}
			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
				skillexp SKILL_NORMAL_TACTICS, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 3 - sdata(SKILL_NORMAL_TACTICS, cc) + 1, 5, 80)
				skillexp SKILL_WEAPON_THROWING, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 3 - sdata(SKILL_WEAPON_THROWING, cc) + 1, 5, 80)
			}
			rowact_check tc
			snd seatk2
			if ( tc >= MAX_CHARA_FOLLOWER ) {
				hostileaction cc, tc
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SOYBEAN ) {
				dmghp tc, sdata(SKILL_WEAPON_THROWING, cc), cc, SKILL_RES_DARKNESS, 3000 * inv(INV_ITEM_LEVEL, ci)
				if ( cdata(CDATA_ID, tc) >= CREATURE_ID_SMASH_OGRE & cdata(CDATA_ID, tc) <= CREATURE_ID_SHINE_OGRE ) {
					if ( cdata(CDATA_HP, tc) > 10 ) {
						dmghp tc, cdata(CDATA_HP, tc) - rnd(10), cc
					}
					else {
						dmghp tc, rnd(20000), cc
					}
				}
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOFU ) {
				snd SOUNDLIST_BASH1
				dmghp tc, sdata(SKILL_WEAPON_THROWING, cc) * inv(INV_ITEM_LEVEL, ci) + rnd(sdata(SKILL_WEAPON_THROWING, cc) + 10) + 1, cc, SKILL_RESDMG_TOFU, 1000
			}
		}
		goto *turn_end
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_FURNITURE | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_JUNK | refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ENVIRONMENT ) {
		if ( map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
			tc = map(tlocx, tlocy, MAP_CHARA_INDEX_PLUS_ONE) - 1
			if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
				if ( tc != CHARA_PLAYER ) {
					if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
					txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
				}
			}
			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_FOOD ) {
				if ( synccheck(tc, -1) ) {
					txt lang(name(tc) + "に見事に命中した！", "It hits " + name(tc) + "!")
				}
			}
			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
				skillexp SKILL_NORMAL_TACTICS, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 3 - sdata(SKILL_NORMAL_TACTICS, cc) + 1, 5, 80)
				skillexp SKILL_WEAPON_THROWING, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 3 - sdata(SKILL_WEAPON_THROWING, cc) + 1, 5, 80)
			}
			rowact_check tc
			if ( inv(INV_ITEM_ID, ci) != ITEM_ID_OHUDA ) {
				snd SOUNDLIST_BASH1
			}
			if ( tc >= MAX_CHARA_FOLLOWER ) {
				hostileaction cc, tc
			}
			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD & cdata(CDATA_HUNGER, tc) < 10000 & cdata(CDATA_CONDITION_SLEEP, tc) == 0 & cdata(CDATA_CONDITION_DIM, tc) < 60 ) {
				cc = tc
				txt lang(name(tc) + "は思わず" + itemname(ci, 1) + "に食いついた！", "It hits " + name(tc) + "!")
				gosub *insta_eat
				cc = CHARA_PLAYER
				if ( tc != CHARA_PLAYER ) {
					if ( cdata(CDATA_CONDITION_SUFFOCATION, tc) > 10 ) {
						cdata(CDATA_CONDITION_SUFFOCATION, tc) = 10
					}
				}
				if ( rnd(8) == 0 ) {
					if ( cdata(CDATA_CONDITION_SUFFOCATION, tc) == 0 ) {
						snd SOUNDLIST_EAT1
						txt lang(name(tc) + "はむせた。「げほっげほっ！」", "It hits " + name(tc) + "!")
					}
					if ( tc != CHARA_PLAYER ) {
						if ( cdata(CDATA_CONDITION_SUFFOCATION, tc) < 10 ) {
							cdata(CDATA_CONDITION_SUFFOCATION, tc) = 10
						}
					}
					if ( tc == CHARA_PLAYER ) {
						cdata(CDATA_CONDITION_SUFFOCATION, tc) = 10
					}
				}
			}
			else {
				if ( inv(INV_ITEM_ID, ci) != ITEM_ID_MAGISTUS & inv(INV_ITEM_ID, ci) != ITEM_ID_TRISMAGISTUS & inv(INV_ITEM_ID, ci) != ITEM_ID_OHUDA & inv(INV_ITEM_ID, ci) != ITEM_ID_PRESENT & inv(INV_ITEM_ID, ci) != ITEM_ID_WILD_FLOWER ) {
					dmghp tc, limit(sdata(SKILL_WEAPON_THROWING, cc) / 5, 1, 200) * limit(inv(INV_ITEM_WEIGHT, ci) / 1000, 1, 500) + rnd(inv(INV_ITEM_WEIGHT, ci) / 1000 + sdata(SKILL_WEAPON_THROWING, cc) + 1), cc
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SKULL_SWORD | inv(INV_ITEM_ID, ci) == ITEM_ID_VIOLENT_SKULL_SWORD ) {
					if ( inv(INV_ITEM_PARAM2, ci) == 0 ) {
						inv(INV_ITEM_PARAM2, ci) = 1
					}
					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SKULL_SWORD ) {
						dmghp tc, limit(sdata(SKILL_WEAPON_THROWING, cc) / 5, 1, 200) * limit(inv(INV_ITEM_PARAM2, ci) / 4, 1, 500) + rnd(inv(INV_ITEM_PARAM2, ci) / 4 + sdata(SKILL_WEAPON_THROWING, cc) + 1), cc, SKILL_RES_NETHER, 1000
					}
					if ( inv(INV_ITEM_ID, ci) == ITEM_ID_VIOLENT_SKULL_SWORD ) {
						dmghp tc, limit(sdata(SKILL_WEAPON_THROWING, cc) / 5, 1, 200) * limit(inv(INV_ITEM_PARAM2, ci) / 4, 1, 500) * 2 + rnd(inv(INV_ITEM_PARAM2, ci) / 4 + sdata(SKILL_WEAPON_THROWING, cc) + 1), cc, SKILL_RES_NETHER, 1000
						dmghp tc, limit(sdata(SKILL_WEAPON_THROWING, cc) / 5, 1, 200) * limit(inv(INV_ITEM_PARAM2, ci) / 4, 1, 500) + rnd(inv(INV_ITEM_PARAM2, ci) / 4 + sdata(SKILL_WEAPON_THROWING, cc) + 1), cc, SKILL_RES_MAGIC, 1000
					}
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_OHUDA ) {
					repeat 8 + 8
						i = 8 + 8 - cnt - 1
						if ( bdataref(BDATAREF_BUFF_TYPE, cdata(STARTING_CDATA_BUFF + i * ARRAY_CDATA_BUFF, tc)) != BUFF_TYPE_BUFF ) {
							continue
						}
						if ( cdata(STARTING_CDATA_BUFF + i * ARRAY_CDATA_BUFF, tc) == BUFF_PUNISHMENT ) {
							continue
						}
						if ( cdata(STARTING_CDATA_BUFF + i * ARRAY_CDATA_BUFF, tc) == BUFF_NONE ) {
							continue
						}
						delbuff tc, i
						break
					loop
					waitbk = cfg_animewait
					if ( cfg_animewait > 0 ) {
						cfg_animewait = 1
					}
					animeload 10, tc
					cfg_animewait = waitbk
					dmghp tc, limit(sdata(SKILL_WEAPON_THROWING, cc) / 5, 1, 200) * limit((sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) + 1) / 3, 1, 500) + rnd(sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) + sdata(SKILL_WEAPON_THROWING, cc) + 1), cc, SKILL_RES_MAGIC, 1000
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PRESENT ) {
					if ( cdata(CDATA_RELATION, tc) == RELATION_ENEMY | tc == CHARA_PLAYER ) {
						dmghp tc, limit(sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) / 5, 1, 400) * limit(sdata(SKILL_ATTR_WIL, cc) / 6, 1, 200) + rnd(sdata(SKILL_ATTR_WIL, cc) + 1) + sdata(SKILL_NORMAL_MAGIC_DEVICE, cc), cc, SKILL_RES_CHAOS, 3000
					}
					else {
						snd SOUNDLIST_HEAL1
						healhp tc, sqrt(sdata(SKILL_ATTR_WIL, tc)) * limit(sdata(SKILL_ATTR_WIL, cc) / 4, 1, 500) + sdata(SKILL_ATTR_WIL, cc) + rnd(sdata(SKILL_ATTR_WIL, tc) + 1)
					}
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_WILD_FLOWER ) {
					if ( inv(INV_ITEM_PARAM2, ci) != 5 ) {
						dmghp tc, limit(sdata(SKILL_WEAPON_THROWING, cc) / 5, 1, 200) * limit(inv(INV_ITEM_WEIGHT, ci) / 1000, 1, 500) + rnd(inv(INV_ITEM_WEIGHT, ci) / 1000 + sdata(SKILL_WEAPON_THROWING, cc) + 1), cc
					}
					if ( inv(INV_ITEM_PARAM2, ci) == 5 ) {
						dmghp tc, sdata(SKILL_WEAPON_THROWING, cc) * (10 + inv(INV_ITEM_LEVEL, ci)) / 5, cc, SKILL_RESDMG_CUT, 400 * (10 + inv(INV_ITEM_LEVEL, ci)) / 10
					}
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MAGISTUS ) {
					tcbk = tc
					efid = SKILL_SPELL_MAGIC_STORM
					efp = inv(INV_ITEM_PARAM2, ci) * 6 + 5
					gosub *effect
					tc = tcbk
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TRISMAGISTUS ) {
					tcbk = tc
					magist = 3
					repeat 3
						efid = SKILL_SPELL_MAGIC_STORM
						efp = inv(INV_ITEM_PARAM2, ci) * 6 + 5
						gosub *effect
					loop
					magist = 0
					tc = tcbk
				}
			}
		}
		else {
			snd SOUNDLIST_THROW2
		}
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		goto *turn_end
	}
	if ( synccheck(tlocx, tlocy) ) {
		txt lang("それは地面に落ちて砕けた。", "It falls on the ground and shatters.")
		snd SOUNDLIST_CRUSH2
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_KITTY_BANK ) {
		if ( inv(INV_ITEM_PROPERTY, ci) != PROPERTY_SPECIAL ) {
			flt
			itemcreate -1, ITEM_ID_GOLD_PIECE, tlocx, tlocy, inv(INV_ITEM_PARAM1, ci)
		}
	}
	goto *turn_end

*act_pray
	item_find 60002
	if ( stat != (-1) ) {
		ci = stat
		if ( inv(INV_ITEM_PARAM1, ci) != cdata(CDATA_GOD, CHARA_PLAYER) ) {
			gosub *god_select
			goto *turn_end
		}
	}
	goto *god_pray

*act_exchange
	item_exchange ci, ti
	return

*act_get
	if ( cc != (-1) ) {
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_GOLD_PIECE | inv(INV_ITEM_ID, ci) == ITEM_ID_PLATINUM_COIN ) {
			snd SOUNDLIST_GETGOLD1
			ti = ci
			in = inv(INV_ITEM_NUM, ci)
			inv(INV_ITEM_NUM, ci) = 0
			msgkeep = 1
			txt lang(name(cc) + "は" + itemname(ti, in) + "を拾った。", name(cc) + " pick" + _s(cc) + " up " + itemname(ti, in) + ".")
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_GOLD_PIECE ) {
				cdata(CDATA_GOLD, cc) += in
			}
			else {
				cdata(CDATA_PLATINUM, cc) += in
				gdata(GDATA_FLAG_TOTAL_PLATINUM) += in
			}
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_GOLD_PIECE ) {
				if ( in > 1 ) {
					if ( cdata(CDATA_ALLIED, cc) == 100 ) {
						if ( cdata(CDATA_IN_TAGTEAM, cc) != 0 ) {
							txt lang(name(cc) + "はパートナーに金貨を分けてあげた。", name(cc) + " shared coins with partner.")
							cdata(CDATA_GOLD, cdata(CDATA_TAGTEAM_PARTNER, cc)) += in / 2
							cdata(CDATA_GOLD, cc) -= in / 2
						}
					}
				}
			}
			return 1
		}
	}
	if ( cc == CHARA_PLAYER ) {
		if ( inv(INV_ITEM_SHOP_SAMPLE, ci) == 100 ) {
			inv(INV_ITEM_SHOP_SAMPLE, ci) = 0
		}
		if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
			if ( inv_sum(CHARA_PLAYER) > 20 ) {
				txt lang("これ以上持ち歩けない。", "Your inventory is full.")
				return 0
			}
		}
		if ( gdata(GDATA_RIDER) != 0 ) {
			if ( cdata(CDATA_ROW_ACT, gdata(GDATA_RIDER)) != ACTION_NONE ) {
				if ( cdata(CDATA_ITEM_USING, gdata(GDATA_RIDER)) == ci ) {
					txt lang("それは" + name(gdata(GDATA_RIDER)) + "が使用中だ。", name(gdata(GDATA_RIDER)) + " " + is(gdata(GDATA_RIDER)) + " using it.")
					return 1
				}
			}
		}
		if ( cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER) > 0 ) {
			if ( cdata(CDATA_ROW_ACT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) != ACTION_NONE ) {
				if ( cdata(CDATA_ITEM_USING, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) == ci ) {
					txt lang("それはタッグパートナーが使用中だ。", "Tag partner is using it.")
					return 1
				}
			}
		}
		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
			if ( inv(INV_ITEM_PROPERTY, ci) == PROPERTY_QUEST ) {
				if ( cdata(CDATA_ROW_ACT, CHARA_PLAYER) == ACTION_NONE ) {
					if ( inv_getspace(CHARA_PLAYER) == 0 ) {
						txt lang("バックパックが一杯だ。", "Your inventory is full.")
						return 0
					}
					gdata(GDATA_ROW_ACT) = ACTION_HARVEST
					gosub *generalAct
					return -1
				}
			}
		}
		if ( inv(INV_ITEM_PROPERTY, ci) == PROPERTY_CONSTRUCT ) {
			txt lang(itemname(ci) + "を撤去する？ ", "Do you want to remove " + itemname(ci) + "? ")
			promptl(0, 0) = stryes, "y", "0"
			promptl(0, 1) = strno, "n", "1"
			promptmax = 2
			val = promptx, prompty, 160, 1
			gosub *prompt_key
			if ( rtval == 0 ) {
				snd SOUNDLIST_BUILD1
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SHELTER ) {
					midbk = mid
					mid = "" + 30 + "_" + (100 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci))
					existwrapper exedir + "tmp\\mdata_" + mid + ".s2"
					if ( strsize != (-1) ) {
						fmode = 11
						gosub *game_ctrlFile
					}
					mid = midbk
					inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 0
					inv(INV_ITEM_PARAM2, ci) = 100
					inv(INV_ITEM_PROPERTY, ci) = PROPERTY_NONE
				}
			}
			else {
				return 0
			}
		}
		if ( inv_getfreeid(cc) == (-1) ) {
			txt lang("バックパックには、もうアイテムを入れる余裕がない。", "Your inventory is full.")
			return 0
		}
	}
	if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_HARVEST ) {
		if ( gdata(GDATA_ROW_ACT) == ACTION_HARVEST ) {
			in = 1
			gdata(GDATA_ROW_ACT) = ACTION_NONE
		}
	}
	inumbk = inv(INV_ITEM_NUM, ci) - in
	inv(INV_ITEM_NUM, ci) = in
	if ( cc == CHARA_PLAYER ) {
		if ( trait(TRAIT_ETHER_ABSORB_ROD) != 0 ) {
			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_ROD ) {
				if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) > 0 ) {
					dbmode = DBMODE_ON_ZAP
					dbid = inv(INV_ITEM_ID, ci)
					gosub *db_item
					txt lang("あなたは" + itemname(ci) + "から魔力を吸い取った。", "You absorb magic from " + itemname(ci) + ".")
					if ( efid >= SKILL_SPELL_HEAL_LIGHT & efid < MAX_SPELL ) {
						skillgain CHARA_PLAYER, efid, 1, inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 5 * inv(INV_ITEM_NUM, ci) + 10
						txtef COLOR_BLUE
						txt lang(name(0) + "は" + skillname(efid) + "の魔法のストックを得た。", s + "you gain knowledge of a spell, " + skillname(efid) + ".")
					}
					else {
						healmp CHARA_PLAYER, inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 5 * inv(INV_ITEM_NUM, ci)
						txt lang(name(0) + "のマナが回復した。", name(0) + your(CHARA_PLAYER) + " mana is restored.")
					}
					inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 0
				}
			}
		}
		if ( trait(TRAIT_ETHER_POISON_HANDS) != 0 ) {
			if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
				if ( inv(INV_ITEM_ID, ci) != ITEM_ID_POISON & inv(INV_ITEM_ID, ci) != ITEM_ID_POTION_CURE_CORRUPTION ) {
					if ( rnd(5) == 0 ) {
						txt lang("あなたの手から毒が滴った。", "Poison drips from your hands.")
						if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HANDFUL_SNOW ) {
							txt lang("毒で雪が溶けてしまった…。", "Poison has melted the snow...")
							inv(INV_ITEM_NUM, ci)--
							cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
							return 0
						}
						inv(INV_ITEM_ID, ci) = ITEM_ID_POISON
					}
				}
			}
		}
	}
	if ( inv(INV_ITEM_PROPERTY, ci) < PROPERTY_NONE ) {
		inv(INV_ITEM_PROPERTY, ci) = PROPERTY_NONE
	}
	ibitmod ITEM_BIT_DROP, ci, FALSE
	item_stack cc, ci
	if ( stat == 0 ) {
		ti = inv_getfreeid(cc)
		if ( ti == (-1) ) {
			inv(INV_ITEM_NUM, ci) = inumbk + in
			if ( invctrl == INVCTRL_SHOP_SELL ) {
				txt lang("店の倉庫が一杯のため売れない。", "Shopkeeper's inventory is full.")
			}
			else {
				txt lang("バックパックには、もうアイテムを入れる余裕がない。", "Your inventory is full.")
			}
			return 0
		}
		item_copy ci, ti
		inv(INV_ITEM_NUM, ti) = in
	}
	inv(INV_ITEM_NUM, ci) = inumbk
	if ( mode == MODELIST_SHOP ) {
		if ( refitem(inv(INV_ITEM_ID, ti), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
			if ( invctrl == INVCTRL_SHOP_BUY | invctrl == INVCTRL_INV_FILE_GET ) {
				if ( invctrl == INVCTRL_INV_FILE_GET & invctrl(1) == 3 ) {
					if ( inv(INV_ITEM_PARAM3, ti) > 0 ) {
						inv(INV_ITEM_PARAM3, ti) += gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
					}
				}
				else {
					if ( inv(INV_ITEM_MATERIAL, ci) == ITEM_MATERIAL_RAW ) {
						if ( inv(INV_ITEM_PARAM3, ti) != 0 ) {
							inv(INV_ITEM_PARAM3, ti) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + refitem(inv(INV_ITEM_ID, ti), DBSPEC_PARAM3_ORG)
							if ( inv(INV_ITEM_PARAM2, ti) != 0 ) {
								inv(INV_ITEM_PARAM3, ti) += 72
							}
						}
					}
				}
			}
			if ( invctrl == INVCTRL_PUT & invctrl(1) == 3 ) {
				if ( inv(INV_ITEM_PARAM3, ti) > 0 ) {
					inv(INV_ITEM_PARAM3, ti) = inv(INV_ITEM_PARAM3, ti) - (gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12)
				}
			}
		}
		if ( invctrl == INVCTRL_SHOP_BUY ) {
			msgkeep = 1
			txtmore
			txt lang(itemname(ti, in) + "を買った。", "You buy " + itemname(ti, in) + ".")
			sellgold = calcitemvalue(ti, 0) * in
			snd SOUNDLIST_PAYGOLD1
			cdata(CDATA_GOLD, CHARA_PLAYER) -= sellgold
			cdata(CDATA_GOLD, tc) += sellgold
			if ( cdata(CDATA_ROLE, tc) == ROLE_SHOP_TRADE ) {
				if ( inv(INV_ITEM_PARAM2, ti) == 0 ) {
					p = sellgold + cdata(CDATA_SHOP_INVEST, tc)
					repeat 30
						if ( p >= calcinvestvalue() ) {
							p -= calcinvestvalue()
							cdata(CDATA_ROLE_SHOP_LEVEL, tc) += rnd(2) + 2
						}
					loop
					cdata(CDATA_SHOP_INVEST, tc) = p
				}
			}
			if ( refitem(inv(INV_ITEM_ID, ti), DBSPEC_TYPE) == FILTER_CARGO_TRADE ) {
				inv(INV_ITEM_PARAM2, ti) = calcitemvalue(ti, 0)
				inv(INV_ITEM_PARAM3, ti) = gdata(GDATA_AREA)
			}
		}
		if ( invctrl == INVCTRL_SHOP_SELL ) {
			msgkeep = 1
			sellgold = calcitemvalue(ci, 1) * in
			if ( ibit(ITEM_BIT_STOLEN, ti) == FALSE ) {
				txt lang(itemname(ti, in) + "を売った。", "You sell " + itemname(ti, in) + ".")
				if ( cdata(CDATA_ROLE, tc) == ROLE_SHOP_TRADE ) {
					if ( inv(INV_ITEM_PARAM3, ti) != gdata(GDATA_AREA) ) {
						repeat 245
							if ( cdata(CDATA_ROLE, cnt) == ROLE_SHOP_TRADE ) {
								continue
							}
							if ( (cdata(CDATA_ROLE, cnt) >= (1000 /*!!!@[ROLE_SHOP_MIN @@@ ROLE_SHOP_WEAPON]@!!! */) & cdata(CDATA_ROLE, cnt) < (2000 /*!!!@[ROLE_GUEST_BEGGAR @@@ ROLE_GUEST_MIN]@!!! */) | cdata(CDATA_ROLE, cnt) == ROLE_GUEST_MERCHANT) != 1 ) {
								continue
							}
							cdata(CDATA_FAME, cnt) += sellgold
						loop
					}
				}
			}
			else {
				ibitmod ITEM_BIT_STOLEN, ti, FALSE
				txt lang("盗品の" + itemname(ti, in) + "を売却した。", "You sell " + itemname(ti, in) + ".(Stolen item sold) ")
				if ( gdata(GDATA_FLAG_GUILD_THIEF_NORMA) > 0 ) {
					gdata(GDATA_FLAG_GUILD_THIEF_NORMA) -= sellgold
					if ( gdata(GDATA_FLAG_GUILD_THIEF_NORMA) < 0 ) {
						gdata(GDATA_FLAG_GUILD_THIEF_NORMA) = 0
					}
					txtmore
					txt lang("盗賊ギルドのノルマ達成まで、あと金貨" + gdata(GDATA_FLAG_GUILD_THIEF_NORMA) + "枚相当の盗品を売却する必要がある。", "You still need to sell stuff worth " + gdata(GDATA_FLAG_GUILD_THIEF_NORMA) + " gold pieces in order to advance ranks in the Thieves Guild.")
				}
			}
			snd SOUNDLIST_GETGOLD1
			cdata(CDATA_GOLD, CHARA_PLAYER) += sellgold
			cdata(CDATA_GOLD, tc) -= sellgold
			if ( cdata(CDATA_GOLD, tc) < 0 ) {
				cdata(CDATA_GOLD, tc) = 0
			}
			inv(INV_ITEM_KNOWN, ti) = ITEM_KNOWN_FULL
		}
		if ( invctrl == INVCTRL_INV_FILE_GET | invctrl == INVCTRL_PUT ) {
			snd 14 + rnd(2)
			msgkeep = 1
			if ( invctrl == INVCTRL_INV_FILE_GET ) {
				txt lang(name(cc) + "は" + itemname(ti, in) + "を拾った。", name(cc) + " pick" + _s(cc) + " up " + itemname(ti, in) + ".")
			}
			else {
				txt lang(itemname(ti, in) + "を保管した。", "You put " + itemname(ti, in) + " in the container.")
			}
		}
		else {
			r1 = 0
			r2 = sellgold
			gosub *expTrade
		}
	}
	else {
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		map(inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci), MAP_ITEM_CHIPS_MEMORY) = map(inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci), MAP_ITEM_CHIPS)
		snd 14 + rnd(2)
		msgkeep = 1
		txt lang(name(cc) + "は" + itemname(ti, in) + "を拾った。", name(cc) + " pick" + _s(cc) + " up " + itemname(ti, in) + ".")
	}
	if ( cc == CHARA_PLAYER ) {
		if ( inv(INV_ITEM_ID, ti) == ITEM_ID_CAMPFIRE ) {
			inv_getheader -1
			if ( mdata(MDATA_FIRE_SOUND) == 1 ) {
				f = 0
				repeat invrange, invhead
					if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
						continue
					}
					if ( inv(INV_ITEM_ID, cnt) == ITEM_ID_CAMPFIRE ) {
						f = 1
						break
					}
				loop
				if ( f == 0 ) {
					mdata(MDATA_FIRE_SOUND) = 0
					gosub *music_play
				}
			}
		}
		convertartifact ti
		ti = stat
		if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM ) {
			if ( mode == MODELIST_MAIN ) {
				gosub *museum_update
			}
		}
		if ( gdata(GDATA_AREA) == AREA_HOME ) {
			if ( mode == MODELIST_MAIN ) {
				gosub *house_update
			}
		}
		gosub *calcBurdenPc
	}
	if ( cc == (-1) ) {
		gosub *calcBurdenPc
	}
	return 1

*act_drop
	inumbk = inv(INV_ITEM_NUM, ci) - in
	inv(INV_ITEM_NUM, ci) = in
	inv(INV_ITEM_X, ci) = cdata(CDATA_X, cc)
	inv(INV_ITEM_Y, ci) = cdata(CDATA_Y, cc)
	itemturn ci
	if ( inv(INV_ITEM_ID, ci) != ITEM_ID_BOTTLE_WATER ) {
		item_stack -1, ci
	}
	if ( stat == 0 | dropval == 0 ) {
		ti = inv_getfreeid(-1)
		if ( ti == (-1) ) {
			txt lang("もう周りに物を置くスペースがない！ ", "The place is too crowded. You can't drop stuff anymore.")
			gosub *screen_draw
			return 0
		}
		item_copy ci, ti
	}
	if ( dropval == 1 ) {
		inv(INV_ITEM_PROPERTY, ti) = PROPERTY_CONSTRUCT
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ti) = gdata(GDATA_COUNT_SHELTER) + 5
		gdata(GDATA_COUNT_SHELTER)++
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ti) > 50 ) {
			inv(INV_ITEM_PARAM2, ti) = 10
		}
	}
	inv(INV_ITEM_NUM, ci) = inumbk
	cell_refresh inv(INV_ITEM_X, ti), inv(INV_ITEM_Y, ti)
	if ( dropval == 0 ) {
		screenupdate = -1
		gosub *screen_draw
		snd SOUNDLIST_DROP1
		txt lang(itemname(ti, in) + "を地面に置いた。", "You drop " + itemname(ti, in) + ".")
	}
	gosub *calcBurdenPc
	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP ) {
		if ( chipm(CHIPM_ROLE, map(inv(INV_ITEM_X, ti), inv(INV_ITEM_Y, ti), MAP_TILE_ID)) == MAP_CHIP_ROLE_DISPLAY_SPACE ) {
			inv(INV_ITEM_SHOP_SAMPLE, ti) = 100
		}
	}
	if ( inv(INV_ITEM_ID, ti) == ITEM_ID_BOTTLE_WATER ) {
		item_find FILTER_FURNITURE_ALTAR, ITEM_FIND_MODE_TYPE
		if ( stat != (-1) ) {
			p = stat
			if ( inv(INV_ITEM_PARAM1, p) == cdata(CDATA_GOD, cc) ) {
				if ( inv(INV_ITEM_STATUS, ti) != ITEM_STATUS_BLESSED ) {
					snd SOUNDLIST_PRAY1
					inv(INV_ITEM_STATUS, ti) = ITEM_STATUS_BLESSED
					txtef COLOR_GREEN
					txt lang("水は祝福を受けた。", "The water is blessed.")
				}
			}
		}
		item_stack -1, ti
	}
	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM ) {
		if ( mode == MODELIST_MAIN ) {
			gosub *museum_update
		}
	}
	if ( gdata(GDATA_AREA) == AREA_HOME ) {
		if ( mode == MODELIST_MAIN ) {
			gosub *house_update
		}
	}
	if ( inv(INV_ITEM_ID, ti) == ITEM_ID_CAMPFIRE ) {
		mdata(MDATA_FIRE_SOUND) = 1
		gosub *music_play
	}
	return 1

*act_equip
	if ( ci == (-1) ) {
		return 0
	}
	if ( cdata(body, r1) \ EXT_EQUIP_SLOTS != 0 ) {
		return 0
	}
	if ( inv(INV_ITEM_EQUIP, ci) != 0 ) {
		return 0
	}
	item_separate ci
	if ( r1 == 0 ) {
		item_identify ci, ITEM_KNOWN_QUALITY
	}
	inv(INV_ITEM_EQUIP, ci) = body
	cdata(body, r1) = cdata(body, r1) / EXT_EQUIP_SLOTS * 10000 + ci + 1
	return 1

*act_unequip
	p = cdata(body, r1) \ EXT_EQUIP_SLOTS
	if ( p == 0 ) {
		rtval = -2
		return
	}
	ci = p - 1
	cdata(body, r1) = cdata(body, r1) / EXT_EQUIP_SLOTS * 10000
	inv(INV_ITEM_EQUIP, ci) = 0
	item_stack r1, ci
	return

*act_unequip_part
	repeat 30, 100
		if ( cdata(cnt, r1) / EXT_EQUIP_SLOTS == body ) {
			p = cdata(cnt, r1) \ EXT_EQUIP_SLOTS
			if ( p == 0 ) {
				continue
			}
			p--
			inv(INV_ITEM_EQUIP, p) = 0
			cdata(cnt, r1) = cdata(cnt, r1) / EXT_EQUIP_SLOTS * 10000
		}
	loop
	return

*act_read
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_RECIPE ) {
		if ( inv(INV_ITEM_SUB_NAME, ci) == 0 ) {
			txt lang("最後に調合したアイテムを、レシピに加えることができる。", "You can add a recipe of the item you previously created.(Not implemented yet)")
			goto *turn_end
		}
	}
	efid = (0 /*!!!@[BUFF_NONE @@@ SKILL_NONE]@!!! */)
	dbmode = DBMODE_ON_READ
	dbid = inv(INV_ITEM_ID, ci)
	gosub *db_item
	if ( efid == SKILL_EFFECT_CREATE_BUILDING ) {
		goto *building_new
	}
	if ( gdata(GDATA_QUICK_USE) == 1 & cc == CHARA_PLAYER ) {
		snd SOUNDLIST_THROW2
		gdata(GDATA_QUICK_USE) = 0
		goto *pc_turn
	}
	else {
		goto *turn_end
	}

*act_eat
	if ( cc == CHARA_PLAYER ) {
		cargocheck
		if ( stat == 0 ) {
			gosub *screen_draw
			goto *pc_turn
		}
		if ( itemusingfind(ci) > 0 ) {
			txt lang("そのアイテムは他の誰かが使用中だ。", "Someone else is using the item.")
			goto *pc_turn
		}
	}
	else {
		if ( itemusingfind(ci) != (-1) ) {
			tc = itemusingfind(ci)
			if ( tc != cc ) {
				rowactend tc
				if ( synccheck(cc, -1) ) {
					txt lang(name(cc) + "は" + name(tc) + "の食べ物を横取りした。", name(cc) + " snatch" + _s(cc) + " " + name(tc) + your(tc) + " food.")
				}
			}
		}
	}
	cdata(CDATA_EMO_ICON, cc) = 16 + 100
	gosub *eat
	goto *turn_end

*act_drink
	dbmode = DBMODE_ON_DRINK
	dbid = inv(INV_ITEM_ID, ci)
	gosub *db_item
	if ( gdata(GDATA_QUICK_USE) == 1 & cc == CHARA_PLAYER ) {
		snd SOUNDLIST_THROW2
		gdata(GDATA_QUICK_USE) = 0
		goto *pc_turn
	}
	else {
		goto *turn_end
	}

*act_zap
	if ( cc != CHARA_PLAYER ) {
		if ( rnd(2) == 0 | cdata(CDATA_TARGET, cc) == 0 | cdata(CDATA_TARGET, cc) == 0 | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
			goto *ai_action
		}
	}
	dbmode = DBMODE_ON_ZAP
	dbid = inv(INV_ITEM_ID, ci)
	gosub *db_item
	gosub *zapStaff
	if ( cc == CHARA_PLAYER ) {
		if ( stat == 0 ) {
			gosub *screen_draw
			goto *pc_turn
		}
	}
	if ( cc != CHARA_PLAYER ) {
		if ( stat == 0 ) {
			gosub *screen_draw
			goto *ai_action
		}
	}
	if ( gdata(GDATA_QUICK_USE) == 1 & cc == CHARA_PLAYER ) {
		snd SOUNDLIST_THROW2
		gdata(GDATA_QUICK_USE) = 0
		goto *pc_turn
	}
	else {
		goto *turn_end
	}

*act_bash
	if ( map(x, y, MAP_ITEM_CHIPS_MEMORY) != 0 ) {
		if ( mapitemfind(x, y, ITEM_ID_TREE_FRUIT) != (-1) ) {
			ci = mapitemfind(x, y, ITEM_ID_TREE_FRUIT)
			item_separate ci
			snd SOUNDLIST_BASH1
			txt lang(itemname(ci) + "に体当たりした。", "You throw your weight against " + itemname(ci) + ".")
			if ( inv(INV_ITEM_PROPERTY, ci) == PROPERTY_SPECIAL | inv(INV_ITEM_PARAM1, ci) <= 0 ) {
				txtmore
				txt lang("もう実はないようだ… ", "It seems there are no fruits left on the tree.")
				goto *turn_end
			}
			inv(INV_ITEM_PARAM1, ci)--
			if ( inv(INV_ITEM_PARAM1, ci) <= 0 ) {
				inv(INV_ITEM_PIC, ci) = xy2pic(31, 17)
				cell_refresh x, y
			}
			if ( y + 1 < mdata(MDATA_HEIGHT) ) {
				if ( (chipm(CHIPM_ATTRIB, map(x, y + 1, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS) == 0 ) {
					y++
				}
			}
			flt
			itemcreate -1, inv(INV_ITEM_PARAM2, ci), x, y, 0
			txt lang(itemname(ci, 1) + "が降ってきた。", itemname(ci, 1) + " falls down from the tree.")
			goto *turn_end
		}
	}
	if ( map(x, y, MAP_ITEM_CHIPS_MEMORY) != 0 ) {
		if ( mapitemfind(x, y, ITEM_ID_KITTY_BANK) != (-1) ) {
			ci = mapitemfind(x, y, ITEM_ID_KITTY_BANK)
			item_separate ci
			snd SOUNDLIST_BASH1
			txt lang(itemname(ci) + "に体当たりした。", "You throw your weight against " + itemname(ci) + ".")
			if ( inv(INV_ITEM_PROPERTY, ci) != PROPERTY_SPECIAL ) {
				okane = inv(INV_ITEM_PARAM1, ci)
				inv(INV_ITEM_NUM, ci)--
				snd SOUNDLIST_CRUSH2
				flt
				itemcreate -1, ITEM_ID_GOLD_PIECE, tlocx, tlocy, okane
			}
			goto *turn_end
		}
	}
	if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
		tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
		if ( cc == CHARA_PLAYER ) {
			if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
				txtselecttc 2
				repeat 2
					promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
					promptmax++
				loop
				val = promptx, prompty, 200, 0
				gosub *prompt_key
				if ( rtval == 1 ) {
					tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
				}
			}
		}
		if ( cdata(CDATA_CONDITION_SLEEP, tc) == 0 & cdata(CDATA_CONDITION_DIM, tc) < 60 ) {
			if ( cc == CHARA_PLAYER ) {
				if ( cdata(CDATA_RELATION, tc) >= RELATION_NEUTRAL ) {
					gosub *com_confirmAttack
					if ( stat == 0 ) {
						goto *pc_turn
					}
				}
			}
			if ( cdata(CDATA_CONDITION_SUFFOCATION, tc) ) {
				snd SOUNDLIST_BASH1
				txt lang(name(cc) + "は" + name(tc) + "に全力で体当たりした。", name(cc) + " bash" + _s(cc) + " up " + name(tc) + " at full power.")
				dmghp tc, sdata(SKILL_ATTR_STR, cc) * 2, cc
				if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
					txt lang(name(tc) + "は食べ物を吐き出した。", name(tc) + " spit" + _s(tc) + " food.")
					txtvalid = 0
					txt lang("「助かったよ！」", cnvtalk("You saved me!"))
					cdata(CDATA_CONDITION_SUFFOCATION, tc) = 0
					if ( tc != CHARA_PLAYER ) {
						modimp tc, 10
					}
				}
			}
			else {
				snd SOUNDLIST_BASH1
				txt lang(name(cc) + "は" + name(tc) + "に体当たりした。", name(cc) + " bash" + _s(cc) + " up " + name(tc) + ".")
				hostileaction cc, tc
			}
		}
		else {
			snd SOUNDLIST_BASH1
			txt lang(name(cc) + "は" + name(tc) + "に体当たりした。", name(cc) + " bash" + _s(cc) + " up " + name(tc) + ".")
			txtvalid = 0
			txt lang(name(tc) + "は睡眠を妨害された。", name(cc) + " disturb" + _s(cc) + " " + his(tc) + " sleep.")
			modkarma cc, -1
			cdata(CDATA_EMO_ICON, tc) = 18 + 100 * 4
		}
		if ( cdata(CDATA_CONDITION_DIM, tc) > 60 ) {
			cdata(CDATA_CONDITION_DIM, tc) = 59
		}
		cdata(CDATA_CONDITION_SLEEP, tc) = 0
		goto *turn_end
	}
	if ( map(x, y, MAP_FEATS_ON_TILE) != 0 ) {
		cell_featread x, y
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_POT ) {
			map(x, y, MAP_FEATS_ON_TILE) = 0
			spillfrag x, y, 2
			flt calcobjlv(gdata(GDATA_LEVEL) * (gdata(GDATA_AREA) != AREA_SHELTER)), calcfixlv(FIX_QUALITY_GOOD)
			flttypemajor = fsetbarrel(rnd(length(fsetbarrel)))
			itemcreate -1, ITEM_ID_DUMMY, x, y, 0
			if ( synccheck(cc, -1) ) {
				snd SOUNDLIST_BASH1
				txt lang(name(cc) + "は壷を割った。", name(cc) + " shatter" + _s(cc) + " the pot.")
				snd SOUNDLIST_CRUSH1
				animeid = ANIMATION_CRUSH
				gosub *anime
			}
			goto *turn_end
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_DOOR_CLOSED ) {
			snd SOUNDLIST_BASH1
			p = feat(FEAT_CELL_SUB_FEATURE_ID) * 3 + 30
			if ( gdata(GDATA_AREA) == AREA_JAIL ) {
				p *= 20
			}
			if ( rnd(p) < sdata(SKILL_ATTR_STR, cc) & rnd(2) ) {
				txt lang("扉に体当たりして破壊した。", "You bash up the door. The door is destroyed.")
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) > sdata(SKILL_ATTR_STR, cc) ) {
					skillexp SKILL_ATTR_STR, cc, (feat(FEAT_CELL_SUB_FEATURE_ID) - sdata(SKILL_ATTR_STR, cc)) * 15
				}
				cell_featset x, y, 0, CELL_FEATURE_NONE, 0, 0
				goto *turn_end
			}
			else {
				txt lang("扉に体当たりした。", "You bash up the door.")
				if ( gdata(GDATA_AREA) == AREA_JAIL ) {
					txt lang("さすがに牢獄の扉は頑丈だ。", "As might be expected, the door of the Jail is hard.")
				}
				if ( rnd(4) == 0 ) {
					tc = cc
					efid = SKILL_EFFECT_CONFUSE
					efp = 200
					gosub *effect
				}
				if ( rnd(3) == 0 ) {
					tc = cc
					efid = SKILL_EFFECT_PARALYZE
					efp = 200
					gosub *effect
				}
				if ( rnd(3) == 0 ) {
					if ( cdata(CDATA_QUALITY, cc) < FIX_QUALITY_MIRACLE & encfind(cc, 6 * 10000 + 10) == (-1) ) {
						cdata(STARTING_CDATA_ATTR, cc)--
						r1 = cc
						gosub *charaRefresh
						if ( synccheck(cc, -1) ) {
							txtmore
							txtef COLOR_PURPLE
							txt lang(name(cc) + "は筋肉を痛めた。", name(cc) + " hurt" + _s(cc) + " " + his(cc) + " muscle.")
						}
					}
				}
				if ( rnd(3) == 0 ) {
					if ( feat(FEAT_CELL_SUB_FEATURE_ID) > CELL_SUB_FEATURE_TRAP_IMPALEMENT ) {
						feat(FEAT_CELL_SUB_FEATURE_ID)--
						cell_featset x, y, feat(FEAT_CELL_PIC), feat(FEAT_CELL_FEATURE_ID), feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1)
						if ( synccheck(cc, -1) ) {
							txt lang("扉は少しだけ壊れた。", "The door is cracked a bit.")
						}
					}
				}
				goto *turn_end
			}
		}
	}
	txt_check 0
	txt lang(name(cc) + "は空気に体当たりした。", name(cc) + " bash" + _s(cc) + " up the air.")
	snd SOUNDLIST_MISS
	goto *turn_end
	gosub *search_for_chara
	if ( cc == CHARA_PLAYER ) {
	}
	return

*search_for_chara
	listmax2 = 0
	if ( cc == CHARA_PLAYER ) {
		repeat 17
			y = cdata(CDATA_Y, cc) - 17 / 2 + cnt
			if ( y < 0 | y >= mdata(MDATA_HEIGHT) ) {
				continue
			}
			repeat fovlist(1, cnt), fovlist(0, cnt)
				x = cdata(CDATA_X, cc) - 17 / 2 + cnt
				if ( x < 0 | x >= mdata(MDATA_WIDTH) ) {
					continue
				}
				if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
					p = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
					if ( cc != p ) {
						if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), x, y) != 0 ) {
							listmax2++
						}
					}
				}
			loop
		loop
	}
	else {
		repeat cdata(CDATA_FOV, cc) - 2
			y = cdata(CDATA_Y, cc) - cdata(CDATA_FOV, cc) / 2 + cnt + 1
			if ( y < 0 | y >= mdata(MDATA_HEIGHT) ) {
				continue
			}
			repeat cdata(CDATA_FOV, cc) - 2
				x = cdata(CDATA_X, cc) - cdata(CDATA_FOV, cc) / 2 + cnt + 1
				if ( x < 0 | x >= mdata(MDATA_WIDTH) ) {
					continue
				}
				if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
					p = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
					if ( cc != p ) {
						if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), x, y) != 0 ) {
							listmax2++
						}
					}
				}
			loop
		loop
	}
	return

*act_movePC
	f = 0
	if ( cdata(CDATA_CONDITION_DRUNK, cc) != 0 ) {
		if ( rnd(5 + cdata(CDATA_ALCOHOL_CONSUMED, cc)) == 0 ) {
			txtef COLOR_SKY_BLUE
			txtmore
			txt lang(" *ふらり* ", "*stagger*")
			f = 1
		}
	}
	if ( cdata(CDATA_CONDITION_SUFFOCATION, cc) != 0 | cdata(CDATA_CONDITION_CONFUSE, cc) != 0 | f == 1 ) {
		cdata(CDATA_X_NEW, cc) = cdata(CDATA_X, cc) + rnd(3) - 1
		cdata(CDATA_Y_NEW, cc) = cdata(CDATA_Y, cc) + rnd(3) - 1
	}
	if ( gdata(GDATA_RIDER) != 0 ) {
		if ( cdata(CDATA_ROW_ACT, gdata(GDATA_RIDER)) != ACTION_NONE ) {
			if ( cdata(CDATA_ACTION_PERIOD, gdata(GDATA_RIDER)) > 0 ) {
				if ( cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) < 200 ) {
					txt lang(name(gdata(GDATA_RIDER)) + "はあなたを睨み付けた。", name(gdata(GDATA_RIDER)) + " glare" + _s(gdata(GDATA_RIDER)) + " you.")
				}
				if ( cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) >= 200 & cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) < 250 ) {
					txt lang(name(gdata(GDATA_RIDER)) + "はあなたを不満げに見つめた。", name(gdata(GDATA_RIDER)) + " looked away you with dissatisfaction.")
				}
				if ( cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) >= 250 & cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) < 300 ) {
					txt lang(name(gdata(GDATA_RIDER)) + "は残念そうにうなだれた。", name(gdata(GDATA_RIDER)) + " looked disappointing.")
				}
				if ( cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) >= 300 & cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) < 350 ) {
					txt lang(name(gdata(GDATA_RIDER)) + "は小さく頷いた。", name(gdata(GDATA_RIDER)) + " nodded small.")
				}
				if ( cdata(CDATA_IMPRESSION, gdata(GDATA_RIDER)) + cdata(CDATA_MASTER_SERVANT, gdata(GDATA_RIDER)) >= 350 ) {
					txt lang(name(gdata(GDATA_RIDER)) + "は何も言わず一歩下がった。", name(gdata(GDATA_RIDER)) + " went down one step without saying anything.")
				}
				cdata(CDATA_ROW_ACT, gdata(GDATA_RIDER)) = ACTION_NONE, 0
				txtmore
			}
		}
	}
	if ( cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER) > 0 ) {
		if ( cdata(CDATA_ROW_ACT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) != ACTION_NONE ) {
			if ( cdata(CDATA_ACTION_PERIOD, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) > 0 ) {
				if ( cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) < 200 ) {
					txt lang("タッグパートナーはあなたを睨み付けた。", "Tag partner glare" + _s(cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + " you.")
				}
				if ( cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) >= 200 & cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) < 250 ) {
					txt lang("タッグパートナーはあなたを不満げに見つめた。", "Tag partner looked away you with dissatisfaction.")
				}
				if ( cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) >= 250 & cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) < 300 ) {
					txt lang("タッグパートナーは残念そうにうなだれた。", "Tag partner looked disappointing.")
				}
				if ( cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) >= 300 & cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) < 350 ) {
					txt lang("タッグパートナーは小さく頷いた。", "Tag partner nodded small.")
				}
				if ( cdata(CDATA_IMPRESSION, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) + cdata(CDATA_MASTER_SERVANT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) >= 350 ) {
					txt lang("タッグパートナーは何も言わず一歩下がった。", "Tag partner went down one step without saying anything.")
				}
				cdata(CDATA_ROW_ACT, cdata(CDATA_TAGTEAM_PARTNER, CHARA_PLAYER)) = ACTION_NONE, 0
				txtmore
			}
		}
	}
	cell_check cdata(CDATA_X_NEW, cc), cdata(CDATA_Y_NEW, cc)
	if ( cdata(CDATA_BURDEN, CHARA_PLAYER) >= 4 ) {
		if ( dbg_noweight == 0 ) {
			msgdup++
			txt lang("潰れていて動けない！ ", "You carry too much to move!")
			gosub *screen_draw
			goto *pc_turn
		}
	}
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		if ( gdata(GDATA_CARGO_WEIGHT) > gdata(GDATA_CARGO_LIMIT) * 2 ) {
			msgdup++
			txt lang("荷車が重すぎて動けない！ ", "You carry too heavy cargo to move!")
			gosub *screen_draw
			goto *pc_turn
		}
	}
	if ( cellchara != (-1) & cellchara != 0 ) {
		tc = cellchara
		if ( cdata(CDATA_RELATION, tc) >= RELATION_ALLY | (cdata(CDATA_RELATION, tc) == RELATION_DISLIKE & cfg_ignoredislike != 0) | (cdata(CDATA_RELATION, tc) == RELATION_NEUTRAL & (adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_MUSEUM | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_SHOP)) ) {
			if ( cbit(CHARA_BIT_SANDBAG, tc) == FALSE ) {
				if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
					goto *move_skip
				}
				if ( cfg_scroll ) {
					cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, tc)
					cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, tc)
					gosub *screen_scroll
				}
				cell_swap cc, tc
				txt lang(name(tc) + "と入れ替わった。", "You displace " + name(tc) + ".")
				txtmore
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_ROGUE ) {
					if ( rnd(5) == 0 ) {
						if ( cdata(CDATA_CONDITION_SLEEP, tc) == 0 ) {
							p = rnd(limit(cdata(CDATA_GOLD, cc), 0, 20) + 1)
							if ( cbit(CHARA_BIT_RES_STEAL, cc) ) {
								p = 0
							}
							if ( p != 0 ) {
								snd SOUNDLIST_GETGOLD1
								cdata(CDATA_GOLD, cc) -= p
								cdata(CDATA_GOLD, tc) += p
								txt lang("「おっと、ごめんよ」", cnvtalk("Ops, sorry.")), lang("「気をつけな」", cnvtalk("Watch it."))
							}
						}
					}
				}
				if ( cdata(CDATA_ROW_ACT, tc) == ACTION_EAT ) {
					if ( cdata(CDATA_ACTION_PERIOD, tc) > 0 ) {
						if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) == 10 ) {
							if ( cdata(CDATA_ITEM_USING, tc) >= 5080 ) {
								txt lang(name(tc) + "はバツが悪そうにあなたを見た。", name(tc) + " stares in your face.")
								cdata(CDATA_ROW_ACT, tc) = ACTION_NONE, 0
							}
							if ( cdata(CDATA_CUSTOM_TALK_LINE, tc) < gdata(GDATA_YEAR) * 10000 + gdata(GDATA_MONTH) * 100 + gdata(GDATA_DAY) ) {
								modimp2 tc, 20
								cdata(CDATA_CUSTOM_TALK_LINE, tc) = gdata(GDATA_YEAR) * 10000 + gdata(GDATA_MONTH) * 100 + gdata(GDATA_DAY)
							}
							txtmore
						}
					}
				}
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					if ( cdata(CDATA_ROW_ACT, ttc) == ACTION_EAT ) {
						if ( cdata(CDATA_TAMER_WHIP_PICKUP, ttc) == 10 ) {
							if ( cdata(CDATA_ACTION_PERIOD, ttc) > 0 ) {
								if ( cdata(CDATA_ITEM_USING, ttc) >= 5080 ) {
									txt lang(cdatan(CDATAN_NAME, ttc) + "はバツが悪そうにあなたを見た。", cdatan(CDATAN_NAME, ttc) + " stares in your face.")
									cdata(CDATA_ROW_ACT, ttc) = ACTION_NONE, 0
								}
							}
							if ( cdata(CDATA_CUSTOM_TALK_LINE, ttc) < gdata(GDATA_YEAR) * 10000 + gdata(GDATA_MONTH) * 100 + gdata(GDATA_DAY) ) {
								modimp2 ttc, 20
								cdata(CDATA_CUSTOM_TALK_LINE, ttc) = gdata(GDATA_YEAR) * 10000 + gdata(GDATA_MONTH) * 100 + gdata(GDATA_DAY)
							}
							txtmore
						}
					}
				}
				if ( cdata(CDATA_ROW_ACT, tc) == ACTION_EAT ) {
					if ( cdata(CDATA_ACTION_PERIOD, tc) > 0 ) {
						if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) != 10 ) {
							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) < 200 ) {
								txt lang(name(tc) + "はあなたを睨み付けた。", name(tc) + " glare" + _s(tc) + " you.")
							}
							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) >= 200 & cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) < 250 ) {
								txt lang(name(tc) + "はあなたを不満げに見つめた。", name(tc) + " looked away you with dissatisfaction.")
							}
							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) >= 250 & cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) < 300 ) {
								txt lang(name(tc) + "は残念そうにうなだれた。", name(tc) + " looked disappointing.")
							}
							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) >= 300 & cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) < 350 ) {
								txt lang(name(tc) + "は小さく頷いた。", name(tc) + " nodded small.")
							}
							if ( cdata(CDATA_IMPRESSION, tc) + cdata(CDATA_MASTER_SERVANT, tc) >= 350 ) {
								txt lang(name(tc) + "は何も言わず一歩下がった。", name(tc) + " went down one step without saying anything.")
							}
							cdata(CDATA_ROW_ACT, tc) = ACTION_NONE, 0
							txtmore
						}
					}
				}
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					ttc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					if ( cdata(CDATA_ROW_ACT, ttc) == ACTION_EAT ) {
						if ( cdata(CDATA_TAMER_WHIP_PICKUP, ttc) != 10 ) {
							if ( cdata(CDATA_ACTION_PERIOD, ttc) > 0 ) {
								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) < 200 ) {
									txt lang(cdatan(CDATAN_NAME, ttc) + "はあなたを睨み付けた。", cdatan(CDATAN_NAME, ttc) + " glare" + _s(ttc) + " you.")
								}
								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) >= 200 & cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) < 250 ) {
									txt lang(cdatan(CDATAN_NAME, ttc) + "はあなたを不満げに見つめた。", cdatan(CDATAN_NAME, ttc) + " looked away you with dissatisfaction.")
								}
								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) >= 250 & cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) < 300 ) {
									txt lang(cdatan(CDATAN_NAME, ttc) + "は残念そうにうなだれた。", cdatan(CDATAN_NAME, ttc) + " looked disappointing.")
								}
								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) >= 300 & cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) < 350 ) {
									txt lang(cdatan(CDATAN_NAME, ttc) + "は小さく頷いた。", cdatan(CDATAN_NAME, ttc) + " nodded small.")
								}
								if ( cdata(CDATA_IMPRESSION, ttc) + cdata(CDATA_MASTER_SERVANT, ttc) >= 350 ) {
									txt lang(cdatan(CDATAN_NAME, ttc) + "は何も言わず一歩下がった。", cdatan(CDATAN_NAME, ttc) + " went down one step without saying anything.")
								}
								cdata(CDATA_ROW_ACT, ttc) = ACTION_NONE, 0
								txtmore
							}
						}
					}
				}
				gosub *cell_info
				goto *turn_end
			}
		}
		if ( gdata(GDATA_RIDER) != 0 ) {
			if ( cdata(CDATA_RELATION, tc) < RELATION_DISLIKE ) {
				if ( findbuff(CHARA_PLAYER, BUFF_HYPER_DASH) != (-1) ) {
					cdata(CDATA_TARGET, CHARA_PLAYER) = tc
					if ( cbit(CHARA_BIT_INVISIBLE, tc) == TRUE ) {
						if ( cbit(CHARA_BIT_SEE_INVISIBLE, CHARA_PLAYER) == FALSE ) {
							if ( cdata(CDATA_CONDITION_WET, tc) == 0 ) {
								cdata(CDATA_TARGET, CHARA_PLAYER) = 0
							}
						}
					}
					if ( cfg_scroll ) {
						cdata(CDATA_X_NEW, CHARA_PLAYER) = cdata(CDATA_X, tc)
						cdata(CDATA_Y_NEW, CHARA_PLAYER) = cdata(CDATA_Y, tc)
						gosub *screen_scroll
					}
					cell_swap cc, tc
					snd SOUNDLIST_BASH1
					txt lang(name(tc) + "を轢いた。", "You blew " + name(tc) + ".")
					txtmore
					dmghp tc, (sdata(SKILL_ACTIVE_RIDING, CHARA_PLAYER) / 4 + 4) * (sdata(SKILL_ATTR_WIL, CHARA_PLAYER) / 4 + 3) + rnd(sdata(SKILL_ATTR_SPD, CHARA_PLAYER) + 5), (0 /*!!!@[CHARA_PLAYER @@@ DAMAGE_FROM_CHARA]@!!! */), SKILL_RESDMG_CRUSH, 1000
					if ( cdata(CDATA_CONDITION_WINCE, tc) < 0 ) {
						cdata(CDATA_CONDITION_WINCE, tc) = 1
					}
					if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cbit(CHARA_BIT_SANDBAG, tc) != TRUE & tc != CHARA_PLAYER ) {
						skillexp SKILL_ACTIVE_RIDING, CHARA_PLAYER, 30
						skillexp SKILL_ACTIVE_RIDING, gdata(GDATA_RIDER), 20
					}
					gosub *cell_info
					goto *turn_end
				}
			}
		}
		if ( running ) {
			if ( cdata(CDATA_RELATION, tc) >= RELATION_HATE | keybd_wait >= 40 ) {
				goto *pc_turn
			}
		}
		if ( cdata(CDATA_RELATION, tc) <= RELATION_DISLIKE ) {
			cdata(CDATA_TARGET, CHARA_PLAYER) = tc
			if ( cbit(CHARA_BIT_INVISIBLE, tc) == TRUE ) {
				if ( cbit(CHARA_BIT_SEE_INVISIBLE, CHARA_PLAYER) == FALSE ) {
					if ( cdata(CDATA_CONDITION_WET, tc) == 0 ) {
						cdata(CDATA_TARGET, CHARA_PLAYER) = 0
					}
				}
			}
			if ( keybd_attacking == 0 ) {
				keybd_wait = 1
				keybd_attacking = 1
			}
			gosub *act_melee
			goto *turn_end
		}
		gosub *chat
		if ( chatteleport == 1 ) {
			chatteleport = 0
			goto *map_exit
		}
		goto *turn_end
	}
	else {
		keybd_attacking = 0
	}
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		if ( dbg_freemove ) {
			x = cdata(CDATA_X_NEW, CHARA_PLAYER)
			y = cdata(CDATA_Y_NEW, CHARA_PLAYER)
			if ( x >= 0 & x < mdata(MDATA_WIDTH) & y >= 0 & y < mdata(MDATA_HEIGHT) ) {
				if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) == 0 ) {
					cellaccess = 1
				}
			}
		}
	}

	if ( cellaccess == 1 ) {
*move_skip
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			if ( xy2pic(0, 8) <= map(cdata(CDATA_X_NEW, cc), cdata(CDATA_Y_NEW, cc), MAP_TILE_ID) & map(cdata(CDATA_X_NEW, cc), cdata(CDATA_Y_NEW, cc), MAP_TILE_ID) < xy2pic(0, 11) ) {
				goto *pc_turn
			}
		}
		goto *act_move
	}
	if ( gdata(GDATA_LEVEL) == 1 | mdata(MDATA_TYPE) == MAP_TYPE_FIELD ) {
		if ( gdata(GDATA_AREA) != AREA_DOCK ) {
			if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
				if ( cdata(CDATA_X_NEW, cc) < 0 | cdata(CDATA_X_NEW, cc) > mdata(MDATA_WIDTH) - 1 | cdata(CDATA_Y_NEW, cc) < 0 | cdata(CDATA_Y_NEW, cc) > mdata(MDATA_HEIGHT) - 1 ) {
					if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
						snd SOUNDLIST_FAIL1
						txt lang("決闘から逃げるわけにはいかない！", "You can not run away from the duel!")
						goto *pc_turn
					}
					if ( adata(ADATA_FESTIVAL, gdata(GDATA_AREA)) != 9999 ) {
						if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DUNGEON ) {
							mdatan(0) = lang("ダンジョン", "dungeon")
						}
					}
					txt lang(mdatan(0) + "を去る？ ", "Do you want to leave " + mdatan(0) + "? ")
					if ( mdata(MDATA_TYPE) == MAP_TYPE_QUEST ) {
						if ( gdata(GDATA_QUEST) == QUEST_TYPE_PARTY | gdata(GDATA_QUEST) == QUEST_TYPE_HARVEST | gdata(GDATA_QUEST) == QUEST_TYPE_MINEFIELD ) {
							txtmore
							txt lang("注意！現在のクエストは現時点で終了となる。", "Warning! You are going to abandon your current quest.")
						}
						else {
							if ( gdata(GDATA_QUEST_STATE) != QUEST_STATE_SUCCESS ) {
								txtmore
								txt lang("注意！現在のクエストは失敗に終わってしまう。", "Warning! You are going to abandon your current quest.")
							}
						}
					}
					promptl(0, 0) = stryes, "y", "0"
					promptl(0, 1) = strno, "n", "1"
					promptmax = 2
					val = promptx, prompty, 160, 1
					gosub *prompt_key
					gosub *screen_draw
					if ( rtval == 0 ) {
						if ( gdata(GDATA_QUEST) == QUEST_TYPE_PARTY | gdata(GDATA_QUEST) == QUEST_TYPE_HARVEST | gdata(GDATA_QUEST) == QUEST_TYPE_MINEFIELD ) {
							gdata(GDATA_TIME_LIMIT) = 0
							if ( qexit == 0 ) {
								evadd EVENT_QUEST_TIMEOUT
							}
							goto *turn_end
						}
						gdata(GDATA_LAST_EDGE_X) = cdata(CDATA_X, CHARA_PLAYER)
						gdata(GDATA_LAST_EDGE_Y) = cdata(CDATA_Y, CHARA_PLAYER)
						snd SOUNDLIST_EXITMAP1
						if ( gdata(GDATA_QUEST) == QUEST_TYPE_THIEVES ) {
							gdata(GDATA_QUEST) = QUEST_TYPE_NONE
						}
						if ( qexit == 0 ) {
							gdata(GDATA_LEVEL)--
							levelexitby = MAP_EXIT_NORMAL
							goto *map_exit
						}
						if ( qexit == 100 ) {
							goto *turn_end
						}
					}
					goto *pc_turn
				}
			}
		}
	}
	if ( cellfeat != (-1) ) {
		if ( cellfeat == 21 ) {
			goto *act_move
		}
		keyhalt = 1
		if ( cellfeat == 23 ) {
			snd SOUNDLIST_CHAT
			goto *com_quest
		}
		if ( cellfeat == 31 ) {
			snd SOUNDLIST_CHAT
			gosub *com_vote_new
			goto *turn_end
		}
		if ( cellfeat == 33 ) {
			menucycle = 1
			gosub *com_politics_chart
			goto *pc_turn
		}
	}
	if ( cdata(CDATA_CONDITION_CONFUSE, CHARA_PLAYER) != 0 ) {
		msgdup++
		txt lang(" *ごつん* ", "*bump*")
		gosub *screen_draw
	}
	goto *pc_turn

*act_move
	if ( cc == CHARA_PLAYER ) {
		gdata(GDATA_FLAG_CURTAIN_CALL) = 0
	}
	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE ) {
		if ( cdata(CDATA_TARGET, cc) != 0 ) {
			goto *turn_end
		}
	}
	if ( cdata(CDATA_CONDITION_BIND, cc) > 0 ) {
		goto *turn_end
	}
	if ( cdata(CDATA_IN_TAGTEAM, cc) == (-1) ) {
		tcc = cdata(CDATA_TAGTEAM_PARTNER, cc)
		if ( cdata(CDATA_ROW_ACT, tcc) == ACTION_EAT ) {
			if ( cdata(CDATA_ACTION_PERIOD, tcc) > 0 ) {
				goto *turn_end
			}
		}
	}
	if ( cbit(CHARA_BIT_RIDE, cc) ) {
		goto *turn_end
	}
	if ( cdata(CDATA_IN_TAGTEAM, cc) == 1 ) {
		goto *turn_end
	}
	dx = cdata(CDATA_X_NEW, cc)
	dy = cdata(CDATA_Y_NEW, cc)
	if ( cc < MAX_CHARA_FOLLOWER ) {
		if ( cc != CHARA_PLAYER ) {
			if ( dx != cdata(CDATA_X, cc) ) {
				if ( cdata(CDATA_X, cc) > dx ) {
					cdata(CDATA_DIR, cc) = 1
				}
				else {
					cdata(CDATA_DIR, cc) = 2
				}
			}
			if ( dy != cdata(CDATA_Y, cc) ) {
				if ( cdata(CDATA_Y, cc) > dy ) {
					cdata(CDATA_DIR, cc) = 3
				}
				else {
					cdata(CDATA_DIR, cc) = 0
				}
			}
		}
	}
	if ( map(dx, dy, MAP_FEATS_ON_TILE) != 0 ) {
		cell_featread dx, dy
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_DOOR_CLOSED ) {
			goto *act_openDoor
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_POT ) {
			x = dx
			y = dy
			goto *act_bash
		}
	}
	if ( map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_MEF_INDEX_PLUS_ONE) != 0 ) {
		i = map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_MEF_INDEX_PLUS_ONE) - 1
		if ( mef(MEF_TYPE, i) == MEF_TYPE_WEB ) {
			if ( cdatan(CDATAN_RACE, cc) != "spider" ) {
				txtmore
				if ( rnd(mef(MEF_POWER, i) + 25) < rnd(sdata(SKILL_ATTR_STR, cc) + sdata(SKILL_ATTR_DEX, cc) + 1) ) {
					if ( synccheck(cc, -1) ) {
						txt lang(name(cc) + "は蜘蛛の巣を振り払った。", name(cc) + " destroy" + _s(cc) + " the cobweb.")
					}
					delmef i
				}
				else {
					mef(MEF_POWER, i) = mef(MEF_POWER, i) * 3 / 4
					if ( synccheck(cc, -1) ) {
						txt lang(name(cc) + "は蜘蛛の巣にひっかかった。", name(cc) + " " + is(cc) + " caught in a cobweb.")
					}
					goto *turn_end
				}
			}
		}
	}
	if ( dbg_notravel == 0 ) {
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			if ( cc == CHARA_PLAYER ) {
				if ( traveldone == 0 ) {
					gosub *travel
					keybd_wait = 1
					goto *turn_end
				}
				else {
					traveldone = 0
				}
			}
		}
	}
	gosub *procMove
	p = map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_TILE_ID)
	if ( chipm(CHIPM_ROLE, p) == MAP_CHIP_ROLE_WATER ) {
		if ( chipm(CHIPM_ROLE_SUB, p) == MAP_CHIP_ROLE_MOUNTAIN_WATER ) {
			if ( gdata(GDATA_AREA) == AREA_LARNA | gdata(GDATA_AREA) == AREA_ARCBELC | gdata(GDATA_AREA) == AREA_SMOKE_AND_PIPE | gdata(GDATA_AREA) == AREA_LUDUS ) {
				healsan cc, 1
			}
		}
		addefmap cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 1, 3
		if ( cdata(CDATA_CONDITION_WET, cc) == 0 ) {
			wet cc, 20
		}
		if ( gdata(GDATA_FLAG_CHOCOLATE_KIT_YOURSELF) != 0 ) {
			txtef COLOR_YELLOW
			txt lang("付着していたチョコが流れ落ちた。", "Chocolate that adheres body was fell down.")
			gdata(GDATA_FLAG_CHOCOLATE_KIT_YOURSELF) = 0
		}
	}
	gosub *cell_info
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
		if ( gdata(GDATA_WORLD) != AREA_AIMWELL ) {
			if ( cc == CHARA_PLAYER ) {
				encounter = ENCOUNTER_NONE
				gdata(GDATA_WORLD_TILE) = map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_TILE_ID)
				if ( gdata(GDATA_FLAG_ENCOUNTER_CANCELLER_DISTANCE_REMAINING) > 0 ) {
					gdata(GDATA_FLAG_ENCOUNTER_CANCELLER_DISTANCE_REMAINING)--
					if ( gdata(GDATA_FLAG_ENCOUNTER_CANCELLER_DISTANCE_REMAINING) <= 0 ) {
						txtef COLOR_RED
						txt lang("魔よけが切れた。", "Encount canceller is gone.")
					}
					mile = gdata(GDATA_FLAG_ENCOUNTER_CANCELLER_DISTANCE_REMAINING) * 4
					txt lang("残り" + mile + "マイル。", "Encount cancel " + mile + " miles.")
				}
				if ( map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_FEATS_ON_TILE) == 0 ) {
					if ( gdata(GDATA_AREA) == AREA_NORTH_TYRIS ) {
						enarea = 1
					}
					if ( gdata(GDATA_AREA) == AREA_SOUTH_TYRIS ) {
						enarea = 2
					}
					p = map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_TILE_ID)
					if ( rnd(30) == 0 ) {
						encounter = ENCOUNTER_ENEMY
					}
					if ( gdata(GDATA_WEATHER) == WEATHER_HARD_RAIN ) {
						if ( rnd(10) == 0 ) {
							encounter = ENCOUNTER_ENEMY
						}
					}
					if ( gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
						if ( rnd(13) == 0 ) {
							encounter = ENCOUNTER_ENEMY
						}
					}
					if ( gdata(GDATA_FLAG_THROWN_CHESTNUTS) >= 100 ) {
						if ( rnd(5) == 0 ) {
							encounter = ENCOUNTER_CHESTNUT_GIANT
						}
					}
					if ( 33 <= p & p < 66 ) {
						if ( rnd(2) == 0 ) {
							encounter = ENCOUNTER_NONE
						}
						if ( rnd(100) == 0 ) {
							encounter = ENCOUNTER_MERCHANT
						}
					}
					plevel = limit(cdata(CDATA_LEVEL, CHARA_PLAYER) * 10, 1, 500)
					if ( rnd(220 + plevel - limit(gdata(GDATA_CARGO_WEIGHT) * 150 / (gdata(GDATA_CARGO_LIMIT) + 1), 0, 210 + plevel)) == 0 ) {
						encounter = ENCOUNTER_ROGUE
					}
					if ( rnd(40) == 0 | 0 ) {
						repeat 5
							rq = gdata(GDATA_QUEST_POOL + cnt)
							if ( qdata(QDATA_EXIST, rq) == QUEST_TYPE_ESCORT ) {
								if ( qdata(QDATA_STATE, rq) == QUEST_STATE_ONGOING ) {
									if ( qdata(QDATA_VAR, rq) == 0 ) {
										if ( qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq) < 2 ) {
											encounter = ENCOUNTER_ASSASSIN
											encounterref = rq
											qdata((10 /*!!!@[QDATA_DEST_CLIENT @@@ QDATA_ENCOUNTER]@!!! */), rq)++
											break
										}
									}
								}
							}
						loop
					}
				}
				if ( encounter == ENCOUNTER_ROGUE ) {
					encounterlv = cdata(CDATA_FAME, CHARA_PLAYER) / 1000
					levelexitby = MAP_EXIT_NORMAL
					goto *map_exit
				}
				if ( encounter == ENCOUNTER_ASSASSIN ) {
					gdata(GDATA_RETURN_AREA) = gdata(GDATA_AREA), gdata(GDATA_LEVEL), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
					levelexitby = MAP_EXIT_NORMAL
					goto *map_exit
				}
				if ( encounter == ENCOUNTER_MERCHANT ) {
					encounterlv = 10 + rnd(100)
					levelexitby = MAP_EXIT_NORMAL
					goto *map_exit
				}
				if ( encounter == ENCOUNTER_CHESTNUT_GIANT ) {
					encounterlv = 111 + sdata(SKILL_WEAPON_THROWING, CHARA_PLAYER)
					levelexitby = MAP_EXIT_NORMAL
					goto *map_exit
				}
				if ( dbg_freetravel == 0 & gdata(GDATA_FLAG_ENCOUNTER_CANCELLER_DISTANCE_REMAINING) <= 0 ) {
					if ( encounter == ENCOUNTER_ENEMY ) {
						p = rnd(gdata(GDATA_DEEPEST_LEVEL) + 1) + 50
						if ( enarea == 1 ) {
							p = limit(rnd(rnd(gdata(GDATA_DEEPEST_LEVEL) + 1) + 1), 1, 50)
						}
						if ( enarea == 2 ) {
							p = limit(rnd(gdata(GDATA_DEEPEST_LEVEL) + 1), 50, 100)
						}
						encounterlv = p * 4 / 5 - 10
						if ( cdata(CDATA_LEVEL, CHARA_PLAYER) <= 5 ) {
							encounterlv /= 2
						}
						if ( xy2pic(0, 1) <= map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_TILE_ID) & map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_TILE_ID) < xy2pic(0, 2) ) {
							encounterlv /= 2
						}
						else {
							if ( gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
								encounterlv = encounterlv * 3 / 2 + 10
							}
						}
						if ( encounterlv < 0 ) {
							encounterlv = 1
						}
						if ( encounterlv >= 999 ) {
							p = 999
						}
						valn = lang(" (危険度:" + p + " 敵勢力:", " (Danger Level:" + p + " Enemy strength:")
						repeat 1
							if ( encounterlv < 5 ) {
								valn += lang("プチ級", "Puti Rank")
								break
							}
							if ( encounterlv < 10 ) {
								valn += lang("オーク級", "Orc Rank")
								break
							}
							if ( encounterlv < 20 ) {
								valn += lang("グリズリー級", "Grizzly Bear Rank")
								break
							}
							if ( encounterlv < 30 ) {
								valn += lang("ドレイク級", "Drake Rank")
								break
							}
							if ( encounterlv < 40 ) {
								valn += lang("リッチ級", "Lich Rank")
								break
							}
							if ( encounterlv < 60 ) {
								valn += lang("ドラゴン級", "Dragon Rank")
								break
							}
							if ( encounterlv < 70 ) {
								valn += lang("イス級", "Yith Rank")
								break
							}
							if ( encounterlv >= 70 ) {
								valn += lang("不明", "???? Rank")
							}
						loop
						valn += ")"
						txt lang("襲撃だ！", "Ambush!") + valn
						msg_halt
						levelexitby = MAP_EXIT_NORMAL
						goto *map_exit
					}
				}
				encounter = ENCOUNTER_NONE
			}
		}
	}
	goto *turn_end

*cell_info
	if ( cc == CHARA_PLAYER ) {
		gdata(GDATA_LAST_EDGE_X) = -1
		gdata(GDATA_LAST_EDGE_Y) = -1
		x = cdata(CDATA_X, CHARA_PLAYER)
		y = cdata(CDATA_Y, CHARA_PLAYER)
		if ( key_shift & gdata(GDATA_RUN) == 0 & cdata(CDATA_CONDITION_CONFUSE, CHARA_PLAYER) == 0 ) {
			if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
				gdata(GDATA_RUN) = 1
				cell_check cdata(CDATA_X, cc) + 1, cdata(CDATA_Y, cc)
				gdata(GDATA_RUN_RIGHT) = cellaccess
				cell_check cdata(CDATA_X, cc) - 1, cdata(CDATA_Y, cc)
				gdata(GDATA_RUN_LEFT) = cellaccess
				cell_check cdata(CDATA_X, cc), cdata(CDATA_Y, cc) + 1
				gdata(GDATA_RUN_DOWN) = cellaccess
				cell_check cdata(CDATA_X, cc), cdata(CDATA_Y, cc) - 1
				gdata(GDATA_RUN_UP) = cellaccess
			}
		}
		if ( map(x, y, MAP_ITEM_CHIPS) != 0 ) {
			if ( cdata(CDATA_CONDITION_BLIND, CHARA_PLAYER) == 0 ) {
				txt txtitemoncell(x, y)
			}
			else {
				txt lang("地面に何かがあるようだ。", "You sense something under your foot.")
			}
		}
		p = chipm(CHIPM_ROLE, map(x, y, MAP_TILE_ID))
		if ( p != 0 ) {
			if ( tname(p) != "" ) {
				txtmore
				txt lang("足元には" + tname(p) + "がある。", "You walk into " + tname(p) + ".")
			}
			if ( p == 3 ) {
				snd SOUNDLIST_WATER2
			}
			if ( p == 12 ) {
				snd SOUNDLIST_FOOT1A
			}
			if ( p == 13 ) {
				snd SOUNDLIST_PIANO1
			}
			if ( p == 14 ) {
				snd SOUNDLIST_PIANO2B
			}
			if ( p == 15 ) {
				snd SOUNDLIST_PIANO3
			}
			if ( p == 16 ) {
				snd SOUNDLIST_PIANO4B
			}
			if ( p == 17 ) {
				snd SOUNDLIST_PIANO5
			}
			if ( p == 18 ) {
				snd SOUNDLIST_PIANO6
			}
			if ( p == 19 ) {
				snd SOUNDLIST_PIANO7B
			}
			if ( p == 20 ) {
				snd SOUNDLIST_PIANO8
			}
			if ( p == 21 ) {
				snd SOUNDLIST_PIANO9B
			}
			if ( p == 22 ) {
				snd SOUNDLIST_PIANO10
			}
			if ( p == 23 ) {
				snd SOUNDLIST_PIANO11B
			}
			if ( p == 24 ) {
				snd SOUNDLIST_PIANO12
			}
			if ( p == 25 ) {
				snd SOUNDLIST_PIANO13
			}
			if ( p == 26 ) {
				snd SOUNDLIST_PIANO14B
			}
			if ( p == 27 ) {
				snd SOUNDLIST_PIANO15
			}
			if ( p == 28 ) {
				snd SOUNDLIST_PIANO16B
			}
			if ( p == 29 ) {
				snd SOUNDLIST_PIANO17
			}
			if ( p == 30 ) {
				snd SOUNDLIST_PIANO18
			}
			if ( p == 31 ) {
				snd SOUNDLIST_PIANO19B
			}
			if ( p == 32 ) {
				snd SOUNDLIST_PIANO20
			}
			if ( p == 33 ) {
				snd SOUNDLIST_PIANO21B
			}
			if ( p == 34 ) {
				snd SOUNDLIST_PIANO22
			}
			if ( p == 35 ) {
				snd SOUNDLIST_PIANO23B
			}
			if ( p == 36 ) {
				snd SOUNDLIST_PIANO24
			}
			if ( p == 4 ) {
				addefmap cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 3, 10, dirsub, rnd(2)
				if ( keybd_wait <= cfg_walkwait * cfg_startrun | cdata(CDATA_TURN, CHARA_PLAYER) \ 2 == 0 | mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
					snd 83 + foot \ 3
					foot += 1 + rnd(2)
				}
			}
			if ( p == 7 | p == 8 ) {
				addefmap cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2, 10, dirsub
				snd 83 + foot \ 3
				foot += 1 + rnd(2)
			}
		}
		else {
			if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
				addefmap cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 2, 10, dirsub
				snd 81 + foot \ 2
				foot++
			}
		}
		if ( map(x, y, MAP_FEATS_ON_TILE) != 0 ) {
			cell_featread x, y
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SMALL_MEDAL ) {
				txtef COLOR_YELLOW
				txt lang(" *キラン* ", "*twinkle*")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_NEFIA ) {
				txt mapname(feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100, 1)
				if ( adata(ADATA_ID, feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100) == AREA_RANDOM_DUNGEON ) {
					if ( cfg_extrahelp ) {
						if ( gdata(STARTING_GDATA_HELP + 6) == 0 ) {
							if ( mode == MODELIST_MAIN ) {
								if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
									gdata(STARTING_GDATA_HELP + 6) = 1
									ghelp = 6
									gosub *elona_help
									if ( 0 == 1 ) {
										screenupdate = -1
										gosub *screen_draw
									}
								}
							}
						}
					}
				}
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_BUILDING ) {
				txt txtbuilding(feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1))
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_DOWNSTAIRS ) {
				txt lang("降り階段がある。", "There is a stair leading downwards here.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_UPSTAIRS ) {
				txt lang("昇り階段がある。", "There is a stair leading upwards here.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_DETECTION ) {
				txt lang("何かが見つかりそうだ。", "You can search this location to collect some materials.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_GENE_ENGINEER ) {
				txt lang("何かの残骸がある。", "You can collect materials from the remains lying here.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_MINING ) {
				txt lang("採掘場がある。", "You can collect materials from the mining spot here.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_FISHING ) {
				txt lang("泉がある。", "You can collect materials from the spring here.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_GARDENING ) {
				txt lang("色んな植物が生えている。", "You can collect materials from plants here.")
			}
			if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_PLANTED_SEED ) {
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_VEGETABLE ) {
					s = lang("野菜", "vegetable")
				}
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_FRUIT ) {
					s = lang("果物", "fruit")
				}
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_HERB ) {
					s = lang("ハーブ", "herb")
				}
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_STRANGE ) {
					s = lang("何か", "strange")
				}
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_ARTIFACT ) {
					s = lang("アーティファクト", "artifact")
				}
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_GEM ) {
					s = lang("宝石", "gem")
				}
				if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_MAGIC ) {
					s = lang("魔法の木", "magic")
				}
				if ( feat == tile_plant ) {
					txt lang("" + s + "の種が植えてある。", "A " + s + " seed is planted.")
				}
				if ( feat == tile_plant + 1 ) {
					txt lang("" + s + "が育っている。", "A " + s + " bud is growing.")
				}
				if ( feat == tile_plant + 2 ) {
					txt lang("" + s + "の実が成っている。", "A" + s + " tree has bore a lot of fruit.")
				}
				if ( feat == tile_plant + 3 ) {
					txt lang("" + s + "の草は枯れてしまっている… ", "A " + s + " tree has withered...")
				}
				if ( feat == tile_plant + 6 ) {
					txt lang("" + s + "の実が成っている。", "A" + s + " tree has bore a lot of fruit.")
				}
			}
			if ( feat(FEAT_CELL_FEATURE_ID) >= CELL_FEATURE_SAMPLING_SPOT_DETECTION & feat(FEAT_CELL_FEATURE_ID) <= CELL_FEATURE_SAMPLING_SPOT_GARDENING ) {
				if ( cfg_extrahelp ) {
					if ( gdata(STARTING_GDATA_HELP + 5) == 0 ) {
						if ( mode == MODELIST_MAIN ) {
							if ( cdata(CDATA_ACTION_PERIOD, CHARA_PLAYER) == 0 ) {
								gdata(STARTING_GDATA_HELP + 5) = 1
								ghelp = 5
								gosub *elona_help
								if ( 0 == 1 ) {
									screenupdate = -1
									gosub *screen_draw
								}
							}
						}
					}
				}
			}
		}
	}
	return

*act_moveLevel
	if ( dbg_freemove ) {
		txt lang("デバッグ中はその操作はできない。", "You can't perform the action while in the debug mode.")
		goto *pc_turn
	}
	item_find ITEM_ID_MOON_GATE, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_GROUND
	if ( stat != (-1) ) {
		if ( mdata(MDATA_TYPE) == MAP_TYPE_TOWN | mdata(MDATA_TYPE) == MAP_TYPE_VILLAGE ) {
			if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
				snd SOUNDLIST_FAIL1
				txt lang("今は決闘中だ！", "You can not run away from the duel!")
				goto *pc_turn
			}
			inv(INV_ITEM_NUM, stat)--
			cell_refresh inv(INV_ITEM_X, stat), inv(INV_ITEM_Y, stat)
			comctrl = 2
			gosub *com_import
			if ( stat == 1 ) {
				goto *extract_map
			}
		}
	}
	cell_featread cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
	movelevelbystairs = FALSE
	if ( val == 1 ) {
		if ( mapitemfind(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), ITEM_ID_KOTATSU) != (-1) ) {
			txt lang("本当にこたつの中に入る？", "Really get into the Kotatsu?")
			promptl(0, 0) = stryes, "y", "0"
			promptl(0, 1) = strno, "n", "1"
			promptmax = 2
			val = promptx, prompty, 160, 1
			gosub *prompt_key
			if ( rtval != 0 ) {
				gosub *screen_draw
				goto *pc_turn
			}
			txt lang("まっくらだ！", "It's dark here!")
			cdata(CDATA_CONDITION_BLIND, CHARA_PLAYER) += 2
			goto *turn_end
		}
	}
	if ( gdata(GDATA_FLAG_MAIN) >= 715 & gdata(GDATA_FLAG_MAIN) < 760 & gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179 ) {
		snd SOUNDLIST_FAIL1
		txt lang("無力化しないと奴が神の間から出てきてしまう！", "If you do not weaken the <Chaos Child>, it will come out of God's prison!")
		goto *pc_turn
	}
	if ( gdata(GDATA_AREA) == AREA_HOME ) {
		if ( val == 1 ) {
			if ( mapitemfind(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), ITEM_ID_DOWNSTAIRS) != (-1) ) {
				if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
					snd SOUNDLIST_FAIL1
					txt lang("決闘から逃げるわけにはいかない！", "You can not run away from the duel!")
					goto *pc_turn
				}
				if ( gdata(GDATA_LEVEL) >= adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) ) {
					txt lang("これ以上降りられない。", "You can't go down any more.")
					goto *pc_turn
				}
				else {
					movelevelbystairs = TRUE
				}
			}
		}
		if ( val == 2 ) {
			if ( mapitemfind(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), ITEM_ID_UPSTAIRS) != (-1) ) {
				if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
					snd SOUNDLIST_FAIL1
					txt lang("決闘から逃げるわけにはいかない！", "You can not run away from the duel!")
					goto *pc_turn
				}
				if ( gdata(GDATA_LEVEL) <= adata(ADATA_MIN_LEVEL, gdata(GDATA_AREA)) ) {
					txt lang("これ以上昇れない。", "You can't go up any more.")
					goto *pc_turn
				}
				else {
					movelevelbystairs = TRUE
				}
			}
		}
	}
	if ( movelevelbystairs == FALSE ) {
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
				snd SOUNDLIST_FAIL1
				txt lang("決闘から逃げるわけにはいかない！", "You can not run away from the duel!")
				goto *pc_turn
			}
			if ( val == 1 ) {
				if ( feat(FEAT_CELL_FEATURE_ID) != CELL_FEATURE_DOWNSTAIRS ) {
					txt lang("降りる階段は見つからない。", "There're no downstairs here.")
					gosub *screen_draw
					goto *pc_turn
				}
				else {
					movelevelbystairs = TRUE
					if ( gdata(GDATA_AREA) == AREA_VOID & gdata(GDATA_LEVEL) >= gdata(GDATA_VOID_BOSS) ) {
						txt lang("階段は不思議なバリアで塞がれている。", "The path is blocked by a strange barrier.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_LESIMAS & gdata(GDATA_LEVEL) == 30 & gdata(GDATA_FLAG_ASSASSIN_EVENTS_FOR_ALSAPIA_GILPHEM) < 35 ) {
						txt lang("階段は不思議なバリアで塞がれている。「先には進ませない」", "The path is blocked by a strange barrier.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_LESIMAS & gdata(GDATA_LEVEL) == 40 & gdata(GDATA_FLAG_ASSASSIN_EVENTS_FOR_ALSAPIA_GILPHEM) < 55 ) {
						txt lang("階段は不思議なバリアで塞がれている。「緊急防御プラグラム作動中」", "The path is blocked by a strange barrier.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_REMIDO & gdata(GDATA_LEVEL) == 114 & gdata(GDATA_FLAG_MAIN) < 270 ) {
						txt lang("階段は混沌の力で塞がれている。", "The path is blocked by chaos barrier.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 143 & gdata(GDATA_FLAG_MAIN) < 382 ) {
						txt lang("エリステアに銀熊のことを報告するのが先だ。", "I need to bring information of the silver bear to Eristia at once.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 146 & gdata(GDATA_FLAG_MAIN) < 455 ) {
						txt lang("階段は混沌の力で塞がれている。", "The path is blocked by chaos barrier.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 149 & gdata(GDATA_FLAG_MAIN) < 490 ) {
						txt lang("先に依頼を完了させて報告しなくては。", "I need to report to Gavela completion of the request.")
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 154 & gdata(GDATA_FLAG_MAIN) < 525 ) {
						txt lang("ノルン「神は言っているよ。まだ進む定めではないと…」", cnvtalk("You need to take the request of the Norne!"))
						goto *pc_turn
					}
					if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 173 ) {
						tc = findchara(CREATURE_ID_ALFRED_THE_CANGNAN_WIND)
						if ( tc != CHARA_PLAYER ) {
							animeload 7, tc
							snd SOUNDLIST_BALL1
							txt lang(name(tc) + "の身体が弾け飛んだ。", name(tc) + " shatter" + _s(tc) + ".")
							dmghp tc, 99999, DAMAGE_FROM_SUICIDE
							chara_vanquish tc
							gdata(GDATA_FLAG_MAIN) = 640
							gdata(GDATA_FLAG_MAIN_CHAOS_CRADLE_34) = 1
						}
					}
				}
			}
			if ( val == 2 ) {
				if ( feat(FEAT_CELL_FEATURE_ID) != CELL_FEATURE_UPSTAIRS ) {
					txt lang("昇る階段は見つからない。", "There're no upstaris here.")
					gosub *screen_draw
					goto *pc_turn
				}
				else {
					movelevelbystairs = TRUE
				}
			}
		}
	}
	if ( feat == tile_downlocked ) {
		f = 0
		if ( gdata(GDATA_AREA) == AREA_LESIMAS ) {
			if ( gdata(GDATA_LEVEL) == 3 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 65 ) {
					f = 1
				}
			}
			if ( gdata(GDATA_LEVEL) == 17 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 115 ) {
					f = 1
				}
			}
			if ( gdata(GDATA_LEVEL) == 25 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 125 ) {
					f = 1
				}
			}
			if ( gdata(GDATA_LEVEL) == 44 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 125 ) {
					f = 1
				}
			}
		}
		if ( gdata(GDATA_AREA) == AREA_REMIDO ) {
			if ( gdata(GDATA_LEVEL) == 106 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 267 ) {
					f = 1
				}
			}
			if ( gdata(GDATA_LEVEL) == 122 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 282 ) {
					f = 1
				}
			}
		}
		if ( gdata(GDATA_AREA) == AREA_CHAOS_CRADLE ) {
			if ( gdata(GDATA_LEVEL) == 142 ) {
				f = 1
			}
			if ( gdata(GDATA_LEVEL) == 159 ) {
				if ( gdata(GDATA_FLAG_MAIN) >= 560 ) {
					f = 1
				}
			}
		}
		if ( f == 1 ) {
			if ( gdata(GDATA_LEVEL) == 44 ) {
				txt lang("厳重に封印された扉の前に立つと、三つの魔石が鈍い光を放った。", "The magic stones shine softly as you approach the sealed door.")
			}
			else {
				txt lang("地下への扉を開けた。", "You unlock the door")
			}
			snd SOUNDLIST_CHEST1
			cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tile_downstairs, CELL_FEATURE_DOWNSTAIRS
			goto *turn_end
		}
		snd SOUNDLIST_LOCKED1
		txt lang("鍵のかかった扉が行く手を塞いでいる。", "The door is locked. It seems you need a specific key to unlock the door.")
		goto *turn_end
	}
	if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
		if ( gdata(GDATA_LEVEL) == adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) ) {
			if ( adata(ADATA_BOSS, gdata(GDATA_AREA)) != (-1) ) {
				txt lang("クエストを放棄して階を移動する？", "Really give up the quest and move over?")
				promptl(0, 0) = stryes, "y", "0"
				promptl(0, 1) = strno, "n", "1"
				promptmax = 2
				val = promptx, prompty, 160, 1
				gosub *prompt_key
				if ( rtval != 0 ) {
					gosub *screen_draw
					goto *pc_turn
				}
			}
		}
	}
	if ( movelevelbystairs == TRUE ) {
		actionsp CHARA_PLAYER, 15
		if ( stat == 0 | cdata(CDATA_BURDEN, CHARA_PLAYER) >= 3 ) {
			if ( stat == 0 | rnd(4 + 1 - cdata(CDATA_BURDEN, CHARA_PLAYER)) == 0 ) {
				txt lang("うわああ！" + name(0) + "は階段から足を踏み外した。", "Noooo! You lost your step and roll down!")
				dmghp cc, cdata(CDATA_MAX_HP, cc) * (cdata(CDATA_INV_WEIGHT, CHARA_PLAYER) * 10 / cdata(CDATA_CARRY_LIMIT, CHARA_PLAYER) + 10) / 100 + 1, DAMAGE_FROM_TUMBLE
				msg_halt
			}
			if ( cdata(CDATA_EXIST, CHARA_PLAYER) == CHAR_STATE_DEAD ) {
				goto *main_init
			}
		}
	}
	if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_NEFIA ) {
		if ( feat(FEAT_CELL_SUB_FEATURE_ID) + feat(FEAT_CELL_PARAM_1) * 100 == 35 ) {
			comctrl = 0
			gosub *com_import
			if ( stat == 1 ) {
				goto *extract_map
			}
			else {
				goto *pc_turn
			}
		}
	}
	snd SOUNDLIST_EXITMAP1
	levelexitby = MAP_EXIT_NORMAL
	goto *map_exit

*lockpick_val
	nannido = val

*lockpick
	if ( 1 == 0 ) {
		goto *lockpick_WEND1
	}
	item_find ITEM_ID_LOCKPICK, ITEM_FIND_MODE_DBID
	if ( stat == (-1) ) {
		txt lang("ロックピックを所持していない。", "You don't have lockpicks.")
		return 0
	}
	ti = stat
	txt lang("ロックピックを使用した。", "You use a lockpick.")
	txtmore
	snd SOUNDLIST_LOCKED1
	item_find ITEM_ID_SKELETON_KEY, ITEM_FIND_MODE_DBID
	if ( stat != (-1) ) {
		i = sdata(SKILL_NORMAL_LOCK_PICKING, CHARA_PLAYER) * 150 / 100 + 5
		txt lang("スケルトンキーも使用した。", "You also use the skeleton key.")
	}
	else {
		i = sdata(SKILL_NORMAL_LOCK_PICKING, CHARA_PLAYER)
	}
	f = 0
	if ( i * 2 < nannido ) {
		txt lang("この鍵を開ける技術はない。", "The lock mechanism is beyond your skill.")
		f = 1
	}
	if ( f == 0 ) {
		if ( i / 2 >= nannido ) {
			txt lang("楽勝だ。", "Easy.")
		}
		else {
			if ( rnd(rnd(i * 2) + 1) < nannido ) {
				txt lang("開錠に失敗した。", "You fail to unlock it.")
				f = 1
			}
		}
	}
	if ( f ) {
		if ( rnd(3) == 0 ) {
			inv(INV_ITEM_NUM, ti)--
			cell_refresh inv(INV_ITEM_X, ti), inv(INV_ITEM_Y, ti)
			txtmore
			txt lang("ロックピックは壊れた。", "Your lockpick breaks.")
		}
		txtnew
		txt lang("もう一度試みる？", "Try again?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval == 0 ) {
			goto *lockpick_WHILE1_CONTINUE
		}
		return 0
	}
	goto *lockpick_WEND1

*lockpick_WHILE1_CONTINUE
	goto *lockpick

*lockpick_WEND1
	txtmore
	txt lang("開錠に成功した。", "You successfully unlock it.")
	skillexp SKILL_NORMAL_LOCK_PICKING, cc, 100 + limit(nannido * 2, 1, 400)
	return 1

*act_open
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SHOPKEEPERS_TRUNK ) {
		modkarma 0, -10
		invctrl = INVCTRL_INV_FILE_GET, 0
		invfile = inv(INV_ITEM_PARAM1, ci)
		snd SOUNDLIST_CHEST1
		gosub *shop
		screenupdate = -1
		gosub *screen_draw
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_MASTERS_DELIVERY_CHEST ) {
		invctrl = INVCTRL_PUT, 0
		snd SOUNDLIST_INV
		goto *com_inventory
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TAX_MASTERS_TAX_BOX ) {
		invctrl = INVCTRL_PUT, 2
		snd SOUNDLIST_INV
		goto *com_inventory
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_GIANTS_SHACKLE ) {
		snd SOUNDLIST_LOCKED1
		txt lang("足枷を外した。", "You unlock the shackle.")
		if ( gdata(GDATA_AREA) == AREA_NOYEL ) {
			if ( gdata(GDATA_LEVEL) == 1 ) {
				if ( gdata(GDATA_FLAG_FIRE_GIANT) == 0 ) {
					if ( cdata(CDATA_EXIST, gdata(GDATA_FLAG_GIANT_ID)) == CHAR_STATE_ALIVE ) {
						tc = findchara(CREATURE_ID_MOYER_THE_CROOKED)
						if ( tc != CHARA_PLAYER ) {
							txtef COLOR_SKY_BLUE
							txtmore
							txt lang("モイアー「馬鹿やろう！！」", "Moyer yells, " + cnvtalk("You idiot!"))
							cdata(CDATA_TARGET, gdata(GDATA_FLAG_GIANT_ID)) = tc
							cdata(CDATA_AI_AGGRO, gdata(GDATA_FLAG_GIANT_ID)) = 1000
						}
						gdata(GDATA_FLAG_FIRE_GIANT) = 1
					}
				}
			}
		}
		goto *turn_end
	}
	if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) != 0 ) {
		invfile = inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)
		invcontainer(1) = ci
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_COOLER_BOX ) {
			refweight = -1
		}
		else {
			refweight = 0
		}
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 3 | inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 4 | inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 6 | inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 10 | inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 12 | inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 11 ) {
			if ( gdata(GDATA_AREA) != AREA_HOME & gdata(GDATA_AREA) != AREA_MAID_MANSION ) {
				txt lang("それは家の中でのみ使用できる。", "You can only use it at your home.")
				gosub *screen_draw
				goto *pc_turn
			}
		}
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) == 5 ) {
			if ( adata(ADATA_ID, gdata(GDATA_AREA)) != AREA_SHOP ) {
				txt lang("それは店の中でのみ使用できる。", "You can only use it at your shop")
				gosub *screen_draw
				goto *pc_turn
			}
		}
		file = "shoptmp.s2"
		fmode = 4
		gosub *game_ctrlFile
		file = "shop" + invfile + ".s2"
		existwrapper exedir + "tmp\\" + file
		if ( strsize != (-1) ) {
			fmode = 3
			gosub *game_ctrlFile
		}
		else {
			inv_getheader -1
			repeat invrange, invhead
				inv(INV_ITEM_NUM, cnt) = 0
			loop
		}
		shoptrade = 0
		invsubroutine = 1
		invctrl = INVCTRL_INV_FILE_GET, 2
		if ( invfile == 3 ) {
			txt lang("残り" + gdata(GDATA_HEIR_DEED) + "個分のアイテムの相続権を持っている。", "You can claim " + gdata(GDATA_HEIR_DEED) + " more heirloom" + _s2(gdata(GDATA_HEIR_DEED)) + ".")
			invctrl(1) = 1
		}
		if ( invfile == 6 | inv(INV_ITEM_ID, invcontainer(1)) == ITEM_ID_COOLER_BOX ) {
			if ( invfile == 6 ) {
				invcontainer = 15
			}
			else {
				invcontainer = 4
			}
			menucycle = 1
			invctrl(1) = 3
		}
		if ( invfile == 9 ) {
			invcontainer = 15
			menucycle = 1
			invctrl(1) = 6
		}
		if ( invfile == 10 ) {
			invcontainer = 60
			menucycle = 1
			invctrl(1) = 7
		}
		if ( invfile == 11 ) {
			invcontainer = 20
			menucycle = 1
			invctrl(1) = 8
		}
		if ( invfile == 12 ) {
			invcontainer = 100
			menucycle = 1
			invctrl(1) = 9
		}
		mode = MODELIST_SHOP
		snd SOUNDLIST_INV
		gosub *com_inventory
		invcontainer = 0
		if ( refweight == (-1) ) {
			refweight = inv_weight(-1) + 2500
		}
		file = "shop" + invfile + ".s2"
		fmode = 4
		gosub *game_ctrlFile
		file = "shoptmp.s2"
		fmode = 3
		gosub *game_ctrlFile
		if ( refweight != 0 ) {
			inv(INV_ITEM_WEIGHT, invcontainer(1)) = refweight
			gosub *calcBurdenPc
		}
		gosub *screen_draw
		mode = MODELIST_MAIN
		goto *turn_end
	}
	item_separate ci
	if ( inv(INV_ITEM_PARAM1, ci) != 0 ) {
		if ( inv(INV_ITEM_PARAM2, ci) != 0 ) {
			if ( inv(INV_ITEM_ID, ci) != ITEM_ID_CARD_PACK & inv(INV_ITEM_ID, ci) != ITEM_ID_MYSTERIOUS_ENVELOPE ) {
				val = inv(INV_ITEM_PARAM2, ci)
				gosub *lockpick_val
				if ( stat == 0 ) {
					screenupdate = -1
					gosub *screen_draw
					goto *turn_end
				}
			}
		}
	}

	if ( inv(INV_ITEM_PARAM1, ci) == 0 ) {
		txt lang("中身は空っぽだ。", "It's empty!")
	}
	else {
		_switch_val = inv(INV_ITEM_ID, ci)
		if ( 0 ) {
			_switch_sw++
		}
		if ( _switch_val == 752 | _switch_sw ) {
			_switch_sw = 0
			gosub *open_newYear
			goto *act_open_SWEND1
			_switch_sw++
		}
		if ( _switch_val == 744 | _switch_sw ) {
			_switch_sw = 0
			gosub *open_catbox
			goto *act_open_SWEND1
			_switch_sw++
		}
		if ( _switch_val == 1105 | _switch_sw ) {
			_switch_sw = 0
			snd SOUNDLIST_BOOK1
			txt lang("あなたは" + itemname(ci) + "を開けた。", "You open " + itemname(ci) + ".")
			msg_halt
			museum = inv(INV_ITEM_PARAM1, ci)
			inv(INV_ITEM_PARAM1, ci) = 0
			flt
			itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), museum
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			goto *act_open_SWEND1
			_switch_sw++
		}
		if ( _switch_val == 784 | _switch_sw ) {
			_switch_sw = 0
			snd SOUNDLIST_CHEST1
			txt lang("あなたは" + itemname(ci) + "を開けた。", "You open " + itemname(ci) + ".")
			msg_halt
			snd SOUNDLIST_DING2
			randomize
			ri = ci
			cc = CHARA_PLAYER
			inv(INV_ITEM_PARAM1, ri) = 0
			if ( gdata(GDATA_FLAG_MAIN) < 200 ) {
				cardno = rnd(347) + 1
				if ( cardno <= 2 ) {
					cardno = 3
				}
				if ( cardno <= 23 & cardno > 18 ) {
					cardno = 18
				}
			}
			if ( gdata(GDATA_FLAG_MAIN) < 350 & gdata(GDATA_FLAG_MAIN) >= 200 ) {
				cardno = rnd(528) + 1
				if ( cardno <= 458 & cardno > 453 ) {
					cardno = 453
				}
				if ( cardno <= 435 & cardno > 430 ) {
					cardno = 430
				}
				if ( cardno <= 380 & cardno > 375 ) {
					cardno = 375
				}
				if ( cardno <= 534 & cardno > 529 ) {
					cardno = 529
				}
			}
			if ( gdata(GDATA_FLAG_MAIN) >= 350 ) {
				cardno = rnd(918) + 1
				if ( gdata(GDATA_FLAG_SUB_REGULUS_ZANAN) < 1003 ) {
					if ( cardno <= 805 & cardno > 800 ) {
						cardno = 800
					}
				}
				if ( gdata(GDATA_FLAG_MAIN) < 540 ) {
					if ( cardno <= 842 & cardno > 837 ) {
						cardno = 837
					}
				}
				if ( gdata(GDATA_FLAG_MAIN) < 540 ) {
					if ( cardno <= 911 & cardno > 904 ) {
						cardno = 904
					}
				}
			}
			if ( gdata(GDATA_FLAG_MAIN) >= 715 ) {
				cardno = rnd(932) + 1
			}
			flt
			itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			inv(INV_ITEM_SUB_NAME, ci) = cardno
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			flt
			itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			inv(INV_ITEM_SUB_NAME, ci) = cardno + 1
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			flt
			itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			inv(INV_ITEM_SUB_NAME, ci) = cardno + 2
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			flt
			itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			inv(INV_ITEM_SUB_NAME, ci) = cardno + 3
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			flt
			itemcreate -1, ITEM_ID_CARD, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
			inv(INV_ITEM_SUB_NAME, ci) = cardno + 4
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
			goto *act_open_SWEND1
		}
		if ( 1 ) {
			gosub *open_chest
			goto *act_open_SWEND1
		}
*act_open_SWEND1
		item_stack cc, ri
	}
	screenupdate = -1
	gosub *screen_draw
	goto *turn_end

*open_chest
	snd SOUNDLIST_CHEST1
	txt lang("あなたは" + itemname(ci) + "を開けた。", "You open " + itemname(ci) + ".")
	msg_halt
	ri = ci
	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_MATERIAL_BOX ) {
		tc = cc
		efid = SKILL_EFFECT_CREATE_MATERIAL
		efp = 100 + inv(INV_ITEM_PARAM1, ri) * 10
		inv(INV_ITEM_PARAM1, ri) = 0
		gosub *effect
		return
	}
	p = 3 + rnd(5)
	if ( breakstr != 0 ) {
		snd SOUNDLIST_AMMO
		p = 2 + rnd(5)
	}
	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_TREASURE_BALL | inv(INV_ITEM_ID, ri) == ITEM_ID_RARE_TREASURE_BALL | inv(INV_ITEM_ID, ri) == ITEM_ID_SMALL_GAMBLE_CHEST ) {
		p = 1
	}
	randomize inv(INV_ITEM_PARAM3, ri)
	repeat p
		dbid = 0
		if ( cnt == 0 ) {
			p = 3
		}
		else {
			p = 2
		}
		if ( inv(INV_ITEM_ID, ri) == ITEM_ID_BEJEWELED_CHEST ) {
			if ( cnt == 0 & rnd(3) == 0 ) {
				p = 4
			}
			else {
				p = 3
			}
			if ( rnd(60) == 0 ) {
				dbid = 559
			}
		}
		flt calcobjlv(inv(INV_ITEM_PARAM1, ri)), calcfixlv(p)
		flttypemajor = fsetchest(rnd(length(fsetchest)))
		if ( cnt > 0 ) {
			if ( rnd(3) != 0 ) {
				if ( rnd(3) != 0 ) {
					flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
					flttypemajor = FILTER_GOLD
				}
				else {
					flttypemajor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
					flttypeminor = FILTER_ORE_GEM
				}
			}
		}
		if ( inv(INV_ITEM_ID, ri) == ITEM_ID_SAFE ) {
			if ( rnd(3) != 0 ) {
				flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
				flttypemajor = FILTER_GOLD
			}
			else {
				flttypemajor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
				flttypeminor = FILTER_ORE_GEM
			}
		}
		if ( inv(INV_ITEM_ID, ri) == ITEM_ID_TREASURE_BALL | inv(INV_ITEM_ID, ri) == ITEM_ID_RARE_TREASURE_BALL ) {
			flttypeminor = (0 /*!!!@[FILTER_NOTHING @@@ FILTER_NOTHING]@!!! */)
			flttypemajor = fsetwear(rnd(length(fsetwear)))
			fixlv = FIX_QUALITY_GREAT
			if ( inv(INV_ITEM_ID, ri) == ITEM_ID_RARE_TREASURE_BALL ) {
				fixlv = FIX_QUALITY_MIRACLE
			}
			if ( rnd(30) == 0 ) {
				dbid = 559
			}
		}
		in = 0
		if ( inv(INV_ITEM_ID, ri) == ITEM_ID_SMALL_GAMBLE_CHEST ) {
			dbid = 54
			atari = 0
			randomize
			if ( rnd(30) == 0 & gdata(GDATA_FLAG_RARE_DROP) == 100 ) {
				in = 20 * inv(INV_ITEM_VALUE, ci)
				atari = 1
			}
			else {
				in = rnd(inv(INV_ITEM_VALUE, ci) / 10 + 1) + 1
			}
			randomize
			if ( rnd(75) == 0 & gdata(GDATA_FLAG_RARE_DROP) == 100 ) {
				in = 50 * inv(INV_ITEM_VALUE, ci) + 7500
				atari = 2
			}
			r1 = 0
			gosub *expOpenLock
			if ( atari == 1 ) {
				snd SOUNDLIST_DING1
				txtef COLOR_SKY_BLUE
				txt lang("当たりだ！", "Jackpot!")
			}
			if ( atari == 2 ) {
				snd SOUNDLIST_COMPLETE1
				snd SOUNDLIST_CHEER
				txtef COLOR_YELLOW2
				txt lang("これは…大当たりだ！！", "<Jackpot>")
			}
		}
		if ( inv(INV_ITEM_ID, ri) == ITEM_ID_WALLET ) {
			dbid = 54
			in = rnd(1000) + 1
			if ( rnd(5) == 0 ) {
				in = rnd(9) + 1
			}
			if ( rnd(10) == 0 ) {
				in = rnd(5000) + 5000
			}
			if ( rnd(20) == 0 ) {
				in = rnd(20000) + 10000
			}
		}
		itemcreate -1, dbid, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), in
	loop
	randomize
	f = 0
	if ( inv(INV_ITEM_ID, ri) != ITEM_ID_SMALL_GAMBLE_CHEST ) {
		if ( rnd(10) == 0 ) {
			f = 1
		}
	}
	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_BEJEWELED_CHEST | inv(INV_ITEM_ID, ri) == ITEM_ID_CHEST ) {
		if ( rnd(10) == 0 ) {
			f = 1
		}
	}
	if ( f ) {
		flt
		itemcreate -1, ITEM_ID_SMALL_MEDAL, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
	}
	f = 0
	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_CHEST ) {
		if ( inv(INV_ITEM_ATTACK, ri) == 7 ) {
			if ( rnd(30) == 0 ) {
				f = 1
			}
		}
	}
	if ( f ) {
		flt
		itemcreate -1, ITEM_ID_ROD_WISHING, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
	}
	snd SOUNDLIST_DING2
	txtmore
	txt lang(itemname(ri) + "から溢れ出た高級品が、足元に散らばった。", "Several quality goods spread out from " + itemname(ri) + ".")
	autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
	inv(INV_ITEM_PARAM1, ri) = 0
	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_WALLET ) {
		modkarma 0, -4
	}
	if ( inv(INV_ITEM_ID, ri) == ITEM_ID_SUITCASE ) {
		modkarma 0, -8
	}
	return

*open_newYear
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift" + " ct:" + ct
	snd SOUNDLIST_CHEST1
	txt lang("あなたは" + itemname(ci) + "を開けた。", "You open " + itemname(ci) + ".")
	msg_halt
	snd SOUNDLIST_DING2
	randomize
	ri = ci
	cc = CHARA_PLAYER
	inv(INV_ITEM_PARAM1, ri) = 0
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift1" + " ct:" + ct
	if ( inv(INV_ITEM_PARAM3, ri) < 100 ) {
		if ( rnd(3) == 0 ) {
			procid = (procid + 1) \ 4
			proclist(procid) = "new year gift1-1" + " ct:" + ct
			if ( synccheck(cc, -1) ) {
				txt lang("悪意を持った何かが袋から飛び出してきた！", "Something jumps out from the pack!")
			}
			repeat 3 + rnd(3)
				flt calcobjlv(cdata(CDATA_LEVEL, CHARA_PLAYER) * 3 / 2 + 3), calcfixlv(FIX_QUALITY_GOOD)
				characreate -1, CREATURE_ID_BUG, cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
			loop
			return
		}
		if ( rnd(3) == 0 ) {
			procid = (procid + 1) \ 4
			proclist(procid) = "new year gift1-2" + " ct:" + ct
			if ( synccheck(cc, -1) ) {
				txt lang("罠だ！お年玉袋は発火した。", "It's trap! The gift ignites.")
			}
			repeat 6
				tlocx = cdata(CDATA_X, CHARA_PLAYER) + rnd(3) - rnd(3)
				tlocy = cdata(CDATA_Y, CHARA_PLAYER) - rnd(3) + rnd(3)
				if ( tlocx < 0 | tlocx >= mdata(MDATA_WIDTH) | tlocy < 0 | tlocy >= mdata(MDATA_HEIGHT) ) {
					continue
				}
				addmef tlocx, tlocy, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(15) + 20, 50, CHARA_PLAYER
				mapitem_fire tlocx, tlocy
			loop
			return
		}
		if ( synccheck(cc, -1) ) {
			txt lang("中には呪いの手紙が入っていた。", "You find a cursed letter inside.")
		}
		efid = SKILL_EFFECT_CURSE
		efp = 1000
		tc = CHARA_PLAYER
		gosub *effect
		return
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift2" + " ct:" + ct
	if ( inv(INV_ITEM_PARAM3, ri) < 200 ) {
		if ( rnd(4) == 0 ) {
			if ( synccheck(cc, -1) ) {
				txtef COLOR_YELLOW
				txt lang(" *チリリリリーン* ", "*ring ring ring*")
			}
			flt
			characreate -1, 328 + rnd(2), cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
			if ( stat != 0 ) {
				if ( cdata(CDATA_RELATION, cc) <= RELATION_ENEMY ) {
					cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
					cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
				}
			}
			return
		}
		if ( rnd(5) == 0 ) {
			if ( synccheck(cc, -1) ) {
				txt lang("妹が入っていた！", "The pack contains your younger sister!")
			}
			flt
			characreate -1, CREATURE_ID_YOUNGER_SISTER, cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
			if ( stat != 0 ) {
				cdata(CDATA_GOLD, rc) = 5000
			}
			return
		}
		if ( synccheck(cc, -1) ) {
			txt lang("何かが袋から出てきた。", "There's something inside the pack.")
		}
		flt
		itemcreate -1, isetgiftminor(rnd(length(isetgiftminor))), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
		return
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift3" + " ct:" + ct
	if ( rnd(3) == 0 ) {
		if ( synccheck(cc, -1) ) {
			txtef COLOR_YELLOW
			txt lang(" *チリリリリーン* ", "*ring ring ring*")
		}
		repeat 2 + rnd(3)
			flt
			characreate -1, 328 + rnd(2), cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
			if ( stat != 0 ) {
				if ( cdata(CDATA_RELATION, cc) <= RELATION_ENEMY ) {
					cdata(CDATA_RELATION, rc) = RELATION_DISLIKE
					cdata(CDATA_RELATION_ORG, rc) = RELATION_DISLIKE
				}
			}
		loop
		return
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift4" + " ct:" + ct
	if ( rnd(10) == 0 ) {
		if ( synccheck(cc, -1) ) {
			txt lang("これは素晴らしい贈り物だ！", "This is truely a wonderful gift!")
		}
		flt
		itemcreate -1, isetgiftgrand(rnd(length(isetgiftgrand))), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
		return
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift5" + " ct:" + ct
	if ( synccheck(cc, -1) ) {
		txt lang("何かが袋から出てきた。", "There's something inside the pack.")
	}
	flt
	itemcreate -1, isetgiftmajor(rnd(length(isetgiftmajor))), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
	procid = (procid + 1) \ 4
	proclist(procid) = "new year gift end" + " ct:" + ct
	return

*open_catbox
	procid = (procid + 1) \ 4
	proclist(procid) = "catbox" + " ct:" + ct
	snd SOUNDLIST_CHEST1
	txt lang("あなたは" + itemname(ci) + "を開けた。", "You open " + itemname(ci) + ".")
	msg_halt
	snd SOUNDLIST_DING2
	randomize
	ri = ci
	cc = CHARA_PLAYER
	inv(INV_ITEM_PARAM1, ri) = 0
	if ( rnd(2) == 0 ) {
		if ( synccheck(cc, -1) ) {
			txt lang("猫が入っていた！", "The box contains a cat!")
		}
		flt
		characreate -1, CREATURE_ID_CAT, cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
		if ( stat != 0 ) {
			cdata(CDATA_GOLD, rc) = 1000
		}
		return
	}
	else {
		if ( synccheck(cc, -1) ) {
			txt lang("死んだ猫が入ってい…ゾンビだこれー！？", "There's something inside the box.")
		}
		flt
		characreate -1, CREATURE_ID_CAT_ZOMBIE, cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
		if ( stat != 0 ) {
			cdata(CDATA_GOLD, rc) = 1000
		}
		return
	}
	procid = (procid + 1) \ 4
	proclist(procid) = "catbox end" + " ct:" + ct
	return

*act_openDoor
	cell_featread dx, dy
	if ( feat == tile_doorclosed4 & feat(FEAT_CELL_SUB_FEATURE_ID) > CELL_SUB_FEATURE_TRAP_IMPALEMENT ) {
		if ( cc == CHARA_PLAYER ) {
			val = feat(FEAT_CELL_SUB_FEATURE_ID)
			gosub *lockpick_val
			if ( stat == 0 ) {
				screenupdate = -1
				gosub *screen_draw
				await 100
				goto *turn_end
			}
			feat(FEAT_CELL_SUB_FEATURE_ID) = CELL_SUB_FEATURE_TRAP_IMPALEMENT
		}
		else {
			goto *turn_end
		}
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) > CELL_SUB_FEATURE_TRAP_IMPALEMENT ) {
		f = 0
		if ( rnd(feat(FEAT_CELL_SUB_FEATURE_ID) * 20 + 150) < sdata(SKILL_NORMAL_LOCK_PICKING, cc) * 20 + 20 ) {
			f = 1
		}
	}
	else {
		if ( cdata(CDATA_ALLIED, cc) == 100 ) {
			if ( cc != CHARA_PLAYER ) {
				goto *turn_end
			}
		}
		f = 1
	}
	if ( f ) {
		if ( feat(FEAT_CELL_SUB_FEATURE_ID) > CELL_SUB_FEATURE_TRAP_IMPALEMENT ) {
			skillexp SKILL_NORMAL_LOCK_PICKING, cc, 100 + limit(feat(FEAT_CELL_SUB_FEATURE_ID), 1, 100)
		}
		cell_featset dx, dy, tile_dooropen, CELL_FEATURE_DOOR_OPENED, 0, -1
		if ( synccheck(cc, -1) ) {
			txt lang(name(cc) + "は扉を開けた。", name(cc) + " open" + _s(cc) + " the door.")
			if ( mdata(MDATA_TILESET) == MAP_TILESET_SF | (gdata(GDATA_AREA) == AREA_MACHINERY_FORT & gdata(GDATA_LEVEL) == adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA))) ) {
				snd SOUNDLIST_DOOR2
			}
			else {
				if ( mdata(MDATA_TILESET) == MAP_TILESET_EASTERN | (gdata(GDATA_AREA) == AREA_KURUALM & gdata(GDATA_LEVEL) == 5) ) {
					snd SOUNDLIST_CARD1
				}
				else {
					snd SOUNDLIST_DOOR1
				}
			}
		}
	}
	else {
		msgdup++
		if ( synccheck(cc, -1) ) {
			snd SOUNDLIST_LOCKED1
			txt lang(aln(cc) + "開錠に失敗した。", name(cc) + " fail" + _s(cc) + " to open the door.")
		}
	}
	if ( cc == CHARA_PLAYER ) {
		await 100
	}
	goto *turn_end

*act_close
	txt lang("何を閉める？", "Which door do you want to close? ")
	gosub *screen_draw
	val = 0
	gosub *prompt_direction
	if ( stat == 0 ) {
		txt lang("それは無理だ。", "It's impossible.")
		gosub *screen_draw
		goto *pc_turn
	}
	cell_featread x, y
	if ( feat(FEAT_CELL_FEATURE_ID) != CELL_FEATURE_DOOR_OPENED ) {
		txt lang("その方向に閉められるものはない。", "There's nothing to close.")
		gosub *screen_draw
		goto *pc_turn
	}
	if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
		txt lang("何かが邪魔で閉められない。", "There's something on the floor.")
		gosub *screen_draw
		goto *pc_turn
	}
	cell_featset x, y, tile_doorclosed, CELL_FEATURE_DOOR_CLOSED, -1, -1
	txt lang(name(cc) + "は扉を閉めた。", name(cc) + " close the door.")
	goto *turn_end

*act_fire
	if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
		actaa = 414
		bvar = sdata(SKILL_RES_MAGIC, cc)
		if ( sdata(SKILL_RES_DARKNESS, cc) > bvar ) {
			actaa = 418
			bvar = sdata(SKILL_RES_DARKNESS, cc)
		}
		if ( sdata(SKILL_RES_NETHER, cc) > bvar ) {
			actaa = 415
			bvar = sdata(SKILL_RES_NETHER, cc)
		}
		if ( sdata(SKILL_RES_CHAOS, cc) > bvar ) {
			actaa = 417
			bvar = sdata(SKILL_RES_CHAOS, cc)
		}
		if ( sdata(SKILL_RES_NERVE, cc) > bvar ) {
			actaa = 416
			bvar = sdata(SKILL_RES_NERVE, cc)
		}
		if ( sdata(SKILL_RES_MAGIC, cc) >= bvar ) {
			actaa = 414
		}
		bvar = 0
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) != 0 ) {
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 4 ) {
				actaa = 418
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 7 ) {
				actaa = 415
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 9 ) {
				actaa = 416
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 10 ) {
				actaa = 417
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 11 ) {
				actaa = 414
			}
		}
		efid = actaa
		gosub *cast
		return
	}
	attackrange = 1
	attacknum = 0
	ele = SKILL_NONE
	ammoproc = ENCHANT_AMMO_NONE
	ammox = cdata(CDATA_X, tc)
	ammoy = cdata(CDATA_Y, tc)
	attackitem = cw
	if ( ammo != (-1) ) {
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) != (-1) ) {
			if ( inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2 + 1, ammo) \ 1000 <= 0 ) {
				txt lang("通常弾を装填した。", "You load normal ammo.")
				inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) = -1
			}
			else {
				ammoproc = inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2, ammo) \ 10000
				if ( cc == CHARA_PLAYER ) {
					if ( cdata(CDATA_SP, CHARA_PLAYER) < 50 ) {
						if ( cdata(CDATA_SP, CHARA_PLAYER) < rnd(75) ) {
							txt lang("疲労し過ぎて失敗した！", "You are too exhausted!")
							dmgsp CHARA_PLAYER, encammoref(ENCAMMOREF_SP_COST, ammoproc) / 2 + 1
							ammoproc = ENCHANT_AMMO_NONE
							return 1
						}
					}
					dmgsp CHARA_PLAYER, rnd(encammoref(ENCAMMOREF_SP_COST, ammoproc) + 1)
				}
				inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ammo) * 2 + 1, ammo)--
			}
		}
	}
	if ( ammo != (-1) ) {
		if ( cc >= MAX_CHARA_FOLLOWER & cdata(CDATA_ALLIED, cc) == 0 ) {
			if ( sdata(SKILL_NORMAL_MARKSMAN, cc) >= 50 ) {
				if ( cdata(CDATA_QUALITY, cc) * cdata(CDATA_QUALITY, cc) > rnd(720) ) {
					ammoproc = ENCHANT_AMMO_NONE
					if ( cdata(CDATA_PV, tc) < 200 | rnd(10) == 0 ) {
						ammoproc = ENCHANT_AMMO_RAPID
					}
					if ( cdata(CDATA_PV, tc) >= 200 | rnd(10) == 0 ) {
						ammoproc = ENCHANT_AMMO_PIERCING
					}
					if ( cdata(CDATA_DV, tc) >= 200 | rnd(10) == 0 ) {
						ammoproc = ENCHANT_AMMO_EXPLOSIVE
					}
					if ( rnd(10) == 0 ) {
						ammoproc = ENCHANT_AMMO_BURST
					}
					if ( rnd(10) == 0 ) {
						ammoproc = ENCHANT_AMMO_MAGIC
					}
					if ( ammoproc != ENCHANT_AMMO_NONE ) {
						snd SOUNDLIST_AMMO
					}
				}
			}
		}
	}
	if ( ammoproc == ENCHANT_AMMO_RAPID ) {
		gdata(GDATA_RAPID_FIRE) = 100
		repeat 3
			gosub *label_5434
			ele = SKILL_NONE
			extraattack = 0
			gosub *act_attack
			if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
				gosub *findTarget
				if ( stat == 0 ) {
					break
				}
				else {
					tc = cdata(CDATA_TARGET, cc)
					if ( relationbetween(cc, tc) != (-3) ) {
						break
					}
				}
			}
		loop
		gdata(GDATA_RAPID_FIRE) = 0
	}
	else {
		if ( ammoproc == ENCHANT_AMMO_BURST ) {
			repeat 20
				gosub *label_5434
				ele = SKILL_NONE
				gosub *com_findTarget
				if ( listmax == 0 ) {
					break
				}
				tc = list(0, rnd(listmax))
				if ( cc == CHARA_PLAYER | cdata(CDATA_RELATION, cc) >= RELATION_NEUTRAL ) {
					if ( cdata(CDATA_RELATION, tc) >= RELATION_NEUTRAL ) {
						if ( cnt == 0 ) {
							continue
						}
					}
					if ( cdata(CDATA_RELATION, tc) >= RELATION_NEUTRAL ) {
						if ( cnt != 0 ) {
							continue cnt + (rnd(5) == 0)
						}
					}
				}
				else {
					if ( cdata(CDATA_RELATION, tc) == cdata(CDATA_RELATION, cc) ) {
						continue cnt + (rnd(5) == 0)
					}
				}
				extraattack = 0
				gosub *act_attack
			loop
		}
		else {
			extraattack = 0
			gosub *act_attack
		}
	}
	attackvar = 0
	ammoproc = ENCHANT_AMMO_NONE
	return

*act_melee
	if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
		actaa = 414
		bvar = sdata(SKILL_RES_MAGIC, cc)
		if ( sdata(SKILL_RES_DARKNESS, cc) > bvar ) {
			actaa = 418
			bvar = sdata(SKILL_RES_DARKNESS, cc)
		}
		if ( sdata(SKILL_RES_NETHER, cc) > bvar ) {
			actaa = 415
			bvar = sdata(SKILL_RES_NETHER, cc)
		}
		if ( sdata(SKILL_RES_CHAOS, cc) > bvar ) {
			actaa = 417
			bvar = sdata(SKILL_RES_CHAOS, cc)
		}
		if ( sdata(SKILL_RES_NERVE, cc) > bvar ) {
			actaa = 416
			bvar = sdata(SKILL_RES_NERVE, cc)
		}
		if ( sdata(SKILL_RES_MAGIC, cc) >= bvar ) {
			actaa = 414
		}
		bvar = 0
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) != 0 ) {
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 4 ) {
				actaa = 418
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 7 ) {
				actaa = 415
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 9 ) {
				actaa = 416
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 10 ) {
				actaa = 417
			}
			if ( cdata(CDATA_ELEMENTS_EYES_ELE, cc) == 11 ) {
				actaa = 414
			}
		}
		efid = actaa
		gosub *cast
		return
	}
	if ( cc != CHARA_PLAYER ) {
		if ( cdata(CDATA_BARRIER, tc) ) {
			if ( distance < 6 ) {
				if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) ) {
					gosub *label_5434
					if ( stat == 1 ) {
						gosub *act_fire
					}
				}
			}
			p = cdata(CDATA_BARRIER, tc) \ 1000
			if ( p == 61 ) {
				if ( cdata(CDATA_HP, cc) < cdata(CDATA_MAX_HP, cc) / 2 ) {
					return
				}
			}
		}
	}
	if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) ) {
		return
	}
	attacknum = 0
	attackrange = 0
	attackskill = SKILL_WEAPON_MARTIAL_ARTS
	ammo = -1
	ele = SKILL_NONE
	powsel = 0
	if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
		if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
			powsel = 100
		}
	}
	if ( gdata(GDATA_FLAG_MAIN) >= 350 ) {
		if ( cdata(CDATA_LEVEL, cc) >= 50 ) {
			powsel = 100
		}
	}
	if ( cc < MAX_CHARA_FOLLOWER | cdata(CDATA_ALLIED, cc) == 100 | cc == CHARA_PLAYER ) {
		powsel = 100
	}
	if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
		powsel = 100
	}
	if ( cc >= MAX_CHARA_FOLLOWER & cdata(CDATA_QUALITY, cc) > FIX_QUALITY_GREAT & cdata(CDATA_HP, cc) > cdata(CDATA_MAX_HP, cc) / 2 & cdata(CDATA_POWER_GAUGE, cc) < 200 ) {
		if ( exgauge != 100 ) {
			powsel = 0
		}
	}
	if ( gdata(GDATA_TEMPORARY_FLAGS2) == 888 ) {
		powsel = 0
	}
	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_TEMPORARY ) {
		if ( cdata(CDATA_DIRECTIVE_MODE_ORG, cc) != 0 ) {
			powsel = 0
		}
	}
	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_INTERCEPT ) {
		powsel = 0
	}
	if ( cc == CHARA_PLAYER ) {
		if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
			powsel = 0
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( powsel == 100 ) {
			if ( cdata(CDATA_SHIELD_STYLE_TYPE, cc) == 1 ) {
				if ( cdata(CDATA_ATTACK_STYLE, cc) & 1 ) {
					weap = sdata(SKILL_NORMAL_SHIELD, cc)
					efid = SKILL_SPACT_SHIELD_STRIKE
					gosub *effect
					weap = 0
				}
			}
		}
	}
	repeat 30
		body = 100 + cnt
		if ( cdata(body, cc) \ EXT_EQUIP_SLOTS == 0 ) {
			continue
		}
		if ( cdata(body, cc) / EXT_EQUIP_SLOTS == 10 ) {
			continue
		}
		if ( cdata(body, cc) / EXT_EQUIP_SLOTS == 11 ) {
			continue
		}
		cw = cdata(body, cc) \ EXT_EQUIP_SLOTS - 1
		attackitem = cw
		if ( inv(INV_ITEM_DICE1, cw) > 0 ) {
			attackskill = inv(INV_ITEM_SKILL_REF, cw)
			if ( iequiploc(cw) == 10 ) {
				attackskill = SKILL_WEAPON_BLUNT
			}
			attacknum++
			extraattack = 0
			gosub *act_attack
		}
	loop
	if ( attackskill == SKILL_WEAPON_MARTIAL_ARTS ) {
		extraattack = 0
		gosub *act_attack
	}
	attackvar = 0
	return

*act_attack
	if ( cdata(CDATA_EXIST, cc) != CHAR_STATE_ALIVE ) {
		return
	}
	if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
		return
	}
	if ( cdata(CDATA_CONDITION_FEAR, cc) != 0 ) {
		msgdup++
		txt lang(name(cc) + "は怖気づいた。", name(cc) + " " + is(cc) + " frightened.")
		return
	}
	gdata(GDATA_FLAG_CURTAIN_CALL)++
	if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
		if ( cdata(CDATA_GAUGE_COOLDOWN, cc) == 0 ) {
			cdata(CDATA_GAUGE_COOLDOWN, cc) = 1
			cdata(CDATA_POWER_GAUGE, cc) += 2
			if ( cdata(CDATA_ID, cc) == CREATURE_ID_TALON_SOLDIER ) {
				cdata(CDATA_POWER_GAUGE, cc) += 2
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) > 100 ) {
		if ( cdata(CDATA_SHIFT_FORM, cc) <= SHIFT_FORM_NONE & (cdata(CDATA_EVOLUTION_STAGE, cc) <= 0 | cc == CHARA_PLAYER) & (cdata(CDATA_QUALITY, cc) < FIX_QUALITY_MIRACLE | cc < MAX_CHARA_FOLLOWER) ) {
			cdata(CDATA_POWER_GAUGE, cc) = 100
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) > 200 ) {
		cdata(CDATA_POWER_GAUGE, cc) = 200
	}
	if ( cbit(CHARA_BIT_QUICK_SHOOTING, tc) ) {
		if ( cbit(CHARA_BIT_SANDBAG, tc) != TRUE ) {
			if ( slinger == 0 ) {
				if ( gdata(GDATA_TEMPORARY_FLAGS3) == 0 ) {
					if ( gdata(GDATA_TEMPORARY_FLAGS2) == 0 ) {
						if ( attackrange != 0 ) {
							if ( cdata(CDATA_CONDITION_DIM, tc) < 60 & cdata(CDATA_CONDITION_SLEEP, tc) == 0 & cdata(CDATA_CONDITION_PARALYZE, tc) == 0 & cdata(CDATA_CONDITION_BLIND, tc) == 0 & gdata(GDATA_TIME_STOP_TIME) == 0 ) {
								if ( synccheck(cc, -1) ) {
									txtef COLOR_PURPLE
									txt lang(name(tc) + "は反射的に先制射撃を行った。" + name(cc) + "は怯んだ。", name(cc) + " " + is(cc) + " stuck by several thorns.")
								}
								waitbk = cfg_animewait
								if ( cfg_animewait > 0 ) {
									cfg_animewait = 1
								}
								snd SOUNDLIST_PUNISH1
								animeload 62, cc
								cfg_animewait = waitbk
								slinger = 100
								if ( cdata(CDATA_CONDITION_WINCE, cc) < 2 ) {
									cdata(CDATA_CONDITION_WINCE, cc) = 2
								}
								dmghp cc, sdata(SKILL_NORMAL_MARKSMAN, tc) + rnd(10) + 1, tc
							}
						}
					}
				}
			}
		}
	}
	if ( cdata(CDATA_EXIST, cc) != CHAR_STATE_ALIVE ) {
		return
	}
	if ( map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_MEF_INDEX_PLUS_ONE) != 0 ) {
		i = map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_MEF_INDEX_PLUS_ONE) - 1
		if ( mef(MEF_TYPE, i) == MEF_TYPE_MIST ) {
			if ( rnd(4) == 0 ) {
				if ( synccheck(cc, -1) ) {
					txtmore
					txt lang(name(cc) + "は霧の中の幻影を攻撃した。", name(cc) + " attack" + _s(cc) + " an illusion in the mist.")
				}
				return
			}
		}
	}
	if ( attackrange == 1 ) {
		animeid = attackskill
		aniref = cw
		gosub *anime
	}
	if ( attacknum > 1 | cc != CHARA_PLAYER ) {
		txtmore
	}
	expmodifer = 1 + cbit(CHARA_BIT_SANDBAG, tc) * 1000 + cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) * 1000 + cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) * 1000 + (gdata(GDATA_AREA) == AREA_SHOW_HOUSE) * 1000
	hit = calcattackhit()
	i = 0
	if ( hit == 1 ) {
		dmg = calcattackdmg()
		if ( cc == CHARA_PLAYER & cfg_attackanime == 1 | (cc < MAX_CHARA_FOLLOWER & cfg_attackanime == 2) | cfg_attackanime == 3 ) {
			animeid = ANIMATION_NORMAL_ATTACK
			aniref = dmg * 100 / cdata(CDATA_MAX_HP, tc)
			gosub *anime
		}
		if ( critical ) {
			if ( cc == CHARA_PLAYER ) {
				txtef COLOR_RED
				txt lang("会心の一撃！ ", "Critical Hit!")
				txtmore
			}
		}
		if ( critical ) {
			if ( cc != CHARA_PLAYER ) {
				txtef COLOR_BLUE
				txt lang("会心の一撃！ ", "Critical Hit!")
				txtmore
			}
		}
		if ( attackskill != SKILL_WEAPON_MARTIAL_ARTS ) {
			if ( inv(INV_ITEM_QUALITY, cw) >= FIX_QUALITY_MIRACLE ) {
				if ( inv(INV_ITEM_QUALITY, cw) == FIX_QUALITY_UNIQUE ) {
					s(1) = lang("", "The ") + iknownnameref(inv(INV_ITEM_ID, cw))
				}
				else {
					if ( inv(INV_ITEM_SUB_NAME, cw) >= 40000 ) {
						randomize inv(INV_ITEM_SUB_NAME, cw) - 40000
						s(1) = random_title(1)
						randomize
					}
					else {
						s(1) = lang("", "The ") + iknownnameref(inv(INV_ITEM_ID, cw))
					}
				}
				s(1) = lang("『", "<") + s(1) + lang("』", ">")
				if ( inv(INV_ITEM_PARAM4, cw) != 0 ) {
					if ( inv(INV_ITEM_PARAM4, cw) == 1 ) {
						exist exedir + "user\\item\\plan1.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 2 ) {
						exist exedir + "user\\item\\plan2.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 3 ) {
						exist exedir + "user\\item\\plan3.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 4 ) {
						exist exedir + "user\\item\\plan4.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 5 ) {
						exist exedir + "user\\item\\plan5.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 6 ) {
						exist exedir + "user\\item\\plan6.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 7 ) {
						exist exedir + "user\\item\\plan7.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 8 ) {
						exist exedir + "user\\item\\plan8.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 9 ) {
						exist exedir + "user\\item\\plan9.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 10 ) {
						exist exedir + "user\\item\\plan10.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 11 ) {
						exist exedir + "user\\item\\plan11.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 12 ) {
						exist exedir + "user\\item\\plan12.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 13 ) {
						exist exedir + "user\\item\\plan13.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 14 ) {
						exist exedir + "user\\item\\plan14.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 15 ) {
						exist exedir + "user\\item\\plan15.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 16 ) {
						exist exedir + "user\\item\\plan16.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 17 ) {
						exist exedir + "user\\item\\plan17.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 18 ) {
						exist exedir + "user\\item\\plan18txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 19 ) {
						exist exedir + "user\\item\\plan19.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 20 ) {
						exist exedir + "user\\item\\plan20.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 21 ) {
						exist exedir + "user\\item\\plan21.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 22 ) {
						exist exedir + "user\\item\\plan22.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 23 ) {
						exist exedir + "user\\item\\plan23.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 24 ) {
						exist exedir + "user\\item\\plan24.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 25 ) {
						exist exedir + "user\\item\\plan25.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 26 ) {
						exist exedir + "user\\item\\plan26.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 27 ) {
						exist exedir + "user\\item\\plan27.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 28 ) {
						exist exedir + "user\\item\\plan28.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 29 ) {
						exist exedir + "user\\item\\plan29.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 30 ) {
						exist exedir + "user\\item\\plan30.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 31 ) {
						exist exedir + "user\\item\\plan31.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 32 ) {
						exist exedir + "user\\item\\plan32.txt"
					}
					if ( inv(INV_ITEM_PARAM4, cw) == 33 ) {
						exist exedir + "user\\item\\plan33.txt"
					}
					if ( strsize != (-1) ) {
						sdim buff, strsize
						notesel buff
						if ( inv(INV_ITEM_PARAM4, cw) == 1 ) {
							noteload exedir + "user\\item\\plan1.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 2 ) {
							noteload exedir + "user\\item\\plan2.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 3 ) {
							noteload exedir + "user\\item\\plan3.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 4 ) {
							noteload exedir + "user\\item\\plan4.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 5 ) {
							noteload exedir + "user\\item\\plan5.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 6 ) {
							noteload exedir + "user\\item\\plan6.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 7 ) {
							noteload exedir + "user\\item\\plan7.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 8 ) {
							noteload exedir + "user\\item\\plan8.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 9 ) {
							noteload exedir + "user\\item\\plan9.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 10 ) {
							noteload exedir + "user\\item\\plan10.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 11 ) {
							noteload exedir + "user\\item\\plan11.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 12 ) {
							noteload exedir + "user\\item\\plan12.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 13 ) {
							noteload exedir + "user\\item\\plan13.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 14 ) {
							noteload exedir + "user\\item\\plan14.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 15 ) {
							noteload exedir + "user\\item\\plan15.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 16 ) {
							noteload exedir + "user\\item\\plan16.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 17 ) {
							noteload exedir + "user\\item\\plan17.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 18 ) {
							noteload exedir + "user\\item\\plan18.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 19 ) {
							noteload exedir + "user\\item\\plan19.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 20 ) {
							noteload exedir + "user\\item\\plan20.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 21 ) {
							noteload exedir + "user\\item\\plan21.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 22 ) {
							noteload exedir + "user\\item\\plan22.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 23 ) {
							noteload exedir + "user\\item\\plan23.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 24 ) {
							noteload exedir + "user\\item\\plan24.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 25 ) {
							noteload exedir + "user\\item\\plan25.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 26 ) {
							noteload exedir + "user\\item\\plan26.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 27 ) {
							noteload exedir + "user\\item\\plan27.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 28 ) {
							noteload exedir + "user\\item\\plan28.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 29 ) {
							noteload exedir + "user\\item\\plan29.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 30 ) {
							noteload exedir + "user\\item\\plan30.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 31 ) {
							noteload exedir + "user\\item\\plan31.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 32 ) {
							noteload exedir + "user\\item\\plan32.txt"
						}
						if ( inv(INV_ITEM_PARAM4, cw) == 33 ) {
							noteload exedir + "user\\item\\plan33.txt"
						}
						t = "%txtName"
						p = instr(buff, 0, t + "," + lang("JP", "EN"))
						buff = strmid(buff, p, instr(buff, p + 1, "%"))
						if ( noteinfo(0) > 1 ) {
							p = noteinfo(0) - 1
							noteget t, p
							if ( t != "" ) {
								buff = t
							}
						}
						s(1) = buff
						p = 0
					}
				}
				if ( synccheck(cc, -1) ) {
					if ( rnd(5) == 0 ) {
						txtef COLOR_SKY_BLUE
						txt lang(name(cc) + "は" + s(1) + "を誇らしげに構えた。", name(cc) + " wield" + _s(cc) + " " + s(1) + " proudly.")
						txtmore
					}
				}
				i = 1
			}
		}
		if ( attackskill == SKILL_WEAPON_MARTIAL_ARTS ) {
			if ( cdata(CDATA_ELEMENT, cc) != 0 ) {
				ele = cdata(CDATA_ELEMENT, cc) / 100000
				elep = cdata(CDATA_ELEMENT, cc) \ 100000
			}
		}
		if ( synccheck(tc, -1) ) {
			if ( extraattack ) {
				ele = SKILL_NONE
				dmg = calcattackdmg()
				txt lang("さらに", "Furthermore,")
				txtcontinue
			}
			kickhantei = 0
			if ( rnd(2) == 0 ) {
				kickhantei = 10
			}
			if ( attackskill == SKILL_WEAPON_MARTIAL_ARTS ) {
				if ( cdata(CDATA_CONDITION_JIU_JITSU, cc) != 0 ) {
					melbk = cdata(CDATA_MELEE_STYLE, cc)
					cdata(CDATA_MELEE_STYLE, cc) = 9
				}
				if ( cdata(CDATA_MELEE_STYLE, cc) == 12 ) {
					if ( bakuretu != 200 ) {
						if ( kickhantei == 10 ) {
							if ( tc >= MAX_CHARA_FOLLOWER ) {
								gdata(GDATA_DMG_TYPE) = 2
								txt lang(aln(cc) + name(tc) + "を蹴り抜いて", name(cc) + " kick" + _s(cc) + " " + name(tc) + " and")
							}
							else {
								txt lang(aln(tc) + name(cc) + "に蹴り飛ばされた。", name(cc) + " kick" + _s(cc) + " " + name(tc) + ".")
							}
						}
						if ( kickhantei == 0 ) {
							if ( tc >= MAX_CHARA_FOLLOWER ) {
								gdata(GDATA_DMG_TYPE) = 2
								txt lang(aln(cc) + name(tc) + "を殴って", name(cc) + "punch" + _s(cc) + " " + name(tc) + " and")
							}
							else {
								txt lang(aln(tc) + name(cc) + "に殴られた。", name(cc) + " punch" + _s(cc) + " " + name(tc) + ".")
							}
						}
					}
				}
				if ( cdata(CDATA_MELEE_STYLE, cc) != 12 ) {
					if ( bakuretu != 200 ) {
						if ( tc >= MAX_CHARA_FOLLOWER ) {
							gdata(GDATA_DMG_TYPE) = 2
							txt lang(aln(cc) + name(tc) + "を" + _melee(0, cdata(CDATA_MELEE_STYLE, cc)), name(cc) + " " + _melee(0, cdata(CDATA_MELEE_STYLE, cc)) + _s(cc) + " " + name(tc) + " and")
						}
						else {
							txt lang(aln(tc) + name(cc) + "に" + _melee(1, cdata(CDATA_MELEE_STYLE, cc)), name(cc) + " " + _melee(1, cdata(CDATA_MELEE_STYLE, cc)) + _s(cc) + " " + name(tc) + ".")
						}
					}
				}
				if ( bakuretu == 200 ) {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						gdata(GDATA_DMG_TYPE) = 2
						txt lang(aln(cc) + name(tc) + "を蹴り抜いて", name(cc) + " kick" + _s(cc) + " " + name(tc) + " and")
					}
					else {
						txt lang(aln(tc) + name(cc) + "に蹴り飛ばされた。", name(cc) + " kick" + _s(cc) + " " + name(tc) + ".")
					}
				}
				if ( cdata(CDATA_CONDITION_JIU_JITSU, cc) != 0 ) {
					cdata(CDATA_MELEE_STYLE, cc) = melbk
				}
			}
			if ( attackskill == SKILL_WEAPON_BOW ) {
				s = lang("弓", "bow")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を射撃し", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で撃たれた。", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_CROSSBOW ) {
				s = lang("クロスボウ", "crossbow")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を射撃し", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で撃たれた。", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_FIREARM ) {
				s = lang("銃", "gun")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を射撃し", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で撃たれた。", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_LONGSWORD ) {
				s = lang("長剣", "sword")
				if ( inv(INV_ITEM_ID, cw) == ITEM_ID_FLEURE | inv(INV_ITEM_ID, cw) == ITEM_ID_EPECLAIR ) {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						gdata(GDATA_DMG_TYPE) = 2
						txt lang(aln(cc) + name(tc) + "を突き刺して", name(cc) + " stab" + _s(cc) + " " + name(tc) + " and")
					}
					else {
						txt lang(aln(tc) + name(cc) + "に" + s(i) + "で刺された。", name(cc) + " stab" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
					}
				}
				else {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						gdata(GDATA_DMG_TYPE) = 2
						txt lang(aln(cc) + name(tc) + "を切り払い", name(cc) + " slash" + _s(cc) + " " + name(tc) + " and")
					}
					else {
						txt lang(aln(tc) + name(cc) + "に" + s(i) + "で切られた。", name(cc) + " slash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
					}
				}
			}
			if ( attackskill == SKILL_WEAPON_POLEARM ) {
				s = lang("槍", "spear")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を突き刺して", name(cc) + " stab" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で刺された。", name(cc) + " stab" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_STAVE ) {
				s = lang("杖", "staff")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を打って", name(cc) + " smash" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で打たれた。", name(cc) + " smash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_SHORTSWORD ) {
				s = lang("短剣", "dagger")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を突き刺して", name(cc) + " stab" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で刺された。", name(cc) + " stab" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_BLUNT ) {
				s = lang("鈍器", "mace")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を打って", name(cc) + " smash" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で打たれた。", name(cc) + " smash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_AXE ) {
				s = lang("斧", "axe")
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "を切り払い", name(cc) + " slash" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で切られた。", name(cc) + " slash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
			if ( attackskill == SKILL_WEAPON_SCYTHE ) {
				if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) <= 1 ) {
					s = lang("鎌", "sythe")
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						gdata(GDATA_DMG_TYPE) = 2
						txt lang(aln(cc) + name(tc) + "を切り払い", name(cc) + " slash" + _s(cc) + " " + name(tc) + " and")
					}
					else {
						txt lang(aln(tc) + name(cc) + "に" + s(i) + "で切られた。", name(cc) + " slash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
					}
				}
				if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) >= 2 ) {
					s = lang("鎖分銅", "chain weight")
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						gdata(GDATA_DMG_TYPE) = 2
						txt lang(aln(cc) + name(tc) + "を打って", name(cc) + " smash" + _s(cc) + " " + name(tc) + " and")
					}
					else {
						txt lang(aln(tc) + name(cc) + "に" + s(i) + "で打たれた。", name(cc) + " smash" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
					}
				}
			}
			if ( attackskill == SKILL_WEAPON_THROWING ) {
				s = itemname(cw, 1, 1)
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					gdata(GDATA_DMG_TYPE) = 2
					txt lang(aln(cc) + name(tc) + "に" + s(i) + "を投げ", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " and")
				}
				else {
					txt lang(aln(tc) + name(cc) + "に" + s(i) + "で攻撃された。", name(cc) + " shoot" + _s(cc) + " " + name(tc) + " with " + his(cc) + " " + s(i) + ".")
				}
			}
		}
		dmghp tc, dmg, cc, ele, elep
		ele = SKILL_NONE
		if ( critical ) {
			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) == FALSE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) == FALSE ) {
				skillexp SKILL_NORMAL_EYE_OF_MIND, cc, 60 / expmodifer, 2
			}
			critical = 0
		}
		if ( rtdmg > cdata(CDATA_MAX_HP, tc) / 20 | rtdmg > sdata(SKILL_NORMAL_HEALING, tc) | rnd(5) == 0 ) {
			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
				skillexp carmor(tc), tc, limit(250 * rtdmg / cdata(CDATA_MAX_HP, tc) + 1, 3, 100) / expmodifer, 0, 5
				if ( cdata(CDATA_ATTACK_STYLE, tc) & 1 ) {
					skillexp SKILL_NORMAL_SHIELD, tc, 40 / expmodifer, 0, 4
				}
			}
			if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) == FALSE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) == FALSE ) {
				skillexp attackskill, cc, limit(sdata(SKILL_NORMAL_EVASION, tc) * 2 - sdata(attackskill, cc) + 1, 5, 50) / expmodifer, 0, 4
				if ( attackrange == 0 ) {
					skillexp SKILL_NORMAL_TACTICS, cc, 20 / expmodifer, 0, 4
					if ( cdata(CDATA_ATTACK_STYLE, cc) & 2 ) {
						skillexp SKILL_NORMAL_TWO_HAND, cc, 20 / expmodifer, 0, 4
					}
					if ( cdata(CDATA_ATTACK_STYLE, cc) & 4 ) {
						skillexp SKILL_NORMAL_DUAL_WIELD, cc, 20 / expmodifer, 0, 4
					}
					if ( cdata(CDATA_ATTACK_STYLE, cc) & 1 ) {
						skillexp SKILL_NORMAL_SHIELD, cc, 20 / expmodifer, 0, 4
					}
				}
				else {
					if ( attackskill == SKILL_WEAPON_THROWING ) {
						skillexp SKILL_NORMAL_TACTICS, cc, 10 / expmodifer, 0, 4
					}
					else {
						skillexp SKILL_NORMAL_MARKSMAN, cc, 25 / expmodifer, 0, 4
					}
				}
				if ( tc == CHARA_PLAYER ) {
					if ( gdata(GDATA_RIDER) != 0 ) {
						skillexp SKILL_ACTIVE_RIDING, CHARA_PLAYER, 30 / expmodifer, 0, 5
					}
				}
				if ( tc == gdata(GDATA_RIDER) ) {
					if ( gdata(GDATA_RIDER) != 0 ) {
						skillexp SKILL_ACTIVE_RIDING, gdata(GDATA_RIDER), 20 / expmodifer, 0, 5
					}
				}
			}
		}
		if ( cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) == 0 ) {
			if ( cdata(CDATA_EXTRA_ATTACKS, cc) != 0 ) {
				if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
					if ( orgdmg > 0 ) {
						cw2 = -1
						repeat 30, 100
							if ( cdata(cnt, cc) == 0 ) {
								continue
							}
							if ( rnd(10) != 0 ) {
								continue
							}
							cw2 = cdata(cnt, cc) - cdata(cnt, cc) / EXT_EQUIP_SLOTS * 10000 - 1
							break
						loop
						if ( cw2 != (-1) ) {
							repeat 15
								if ( inv(40 + cnt * 2, cw2) == 0 ) {
									break
								}
								enc = inv(40 + cnt * 2, cw2)
								if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) <= 1 ) {
									if ( enc == 66 ) {
										cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 1
										shootp = inv(40 + cnt * 2 + 1, cw2)
										break
									}
								}
								if ( enc == 65 ) {
									cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) = 2
									shootp = inv(40 + cnt * 2 + 1, cw2)
									break
								}
							loop
							if ( cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) != 0 ) {
								if ( inv(INV_ITEM_QUALITY, cw2) >= FIX_QUALITY_MIRACLE ) {
									if ( inv(INV_ITEM_QUALITY, cw2) == FIX_QUALITY_UNIQUE ) {
										s(1) = lang("", "The ") + iknownnameref(inv(INV_ITEM_ID, cw2))
									}
									else {
										if ( inv(INV_ITEM_SUB_NAME, cw2) >= 40000 ) {
											randomize inv(INV_ITEM_SUB_NAME, cw2) - 40000
											s(1) = random_title(1)
											randomize
										}
										else {
											s(1) = lang("", "The ") + iknownnameref(inv(INV_ITEM_ID, cw2))
										}
									}
									s(1) = lang("『", "<") + s(1) + lang("』", ">")
									if ( inv(INV_ITEM_PARAM4, cw2) != 0 ) {
										if ( inv(INV_ITEM_PARAM4, cw2) == 1 ) {
											exist exedir + "user\\item\\plan1.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 2 ) {
											exist exedir + "user\\item\\plan2.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 3 ) {
											exist exedir + "user\\item\\plan3.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 4 ) {
											exist exedir + "user\\item\\plan4.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 5 ) {
											exist exedir + "user\\item\\plan5.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 6 ) {
											exist exedir + "user\\item\\plan6.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 7 ) {
											exist exedir + "user\\item\\plan7.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 8 ) {
											exist exedir + "user\\item\\plan8.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 9 ) {
											exist exedir + "user\\item\\plan9.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 10 ) {
											exist exedir + "user\\item\\plan10.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 11 ) {
											exist exedir + "user\\item\\plan11.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 12 ) {
											exist exedir + "user\\item\\plan12.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 13 ) {
											exist exedir + "user\\item\\plan13.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 14 ) {
											exist exedir + "user\\item\\plan14.txt"
										}
										if ( inv(INV_ITEM_PARAM4, cw2) == 15 ) {
											exist exedir + "user\\item\\plan15.txt"
										}
										if ( strsize != (-1) ) {
											sdim buff, strsize
											notesel buff
											if ( inv(INV_ITEM_PARAM4, cw2) == 1 ) {
												noteload exedir + "user\\item\\plan1.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 2 ) {
												noteload exedir + "user\\item\\plan2.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 3 ) {
												noteload exedir + "user\\item\\plan3.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 4 ) {
												noteload exedir + "user\\item\\plan4.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 5 ) {
												noteload exedir + "user\\item\\plan5.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 6 ) {
												noteload exedir + "user\\item\\plan6.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 7 ) {
												noteload exedir + "user\\item\\plan7.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 8 ) {
												noteload exedir + "user\\item\\plan8.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 9 ) {
												noteload exedir + "user\\item\\plan9.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 10 ) {
												noteload exedir + "user\\item\\plan10.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 11 ) {
												noteload exedir + "user\\item\\plan11.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 12 ) {
												noteload exedir + "user\\item\\plan12.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 13 ) {
												noteload exedir + "user\\item\\plan13.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 14 ) {
												noteload exedir + "user\\item\\plan14.txt"
											}
											if ( inv(INV_ITEM_PARAM4, cw2) == 15 ) {
												noteload exedir + "user\\item\\plan15.txt"
											}
											t = "%txtName"
											p = instr(buff, 0, t + "," + lang("JP", "EN"))
											buff = strmid(buff, p, instr(buff, p + 1, "%"))
											if ( noteinfo(0) > 1 ) {
												p = noteinfo(0) - 1
												noteget t, p
												if ( t != "" ) {
													buff = t
												}
											}
											s(1) = buff
											p = 0
										}
									}
								}
								else {
									s(1) = ioriginalnameref(inv(INV_ITEM_ID, cw2))
								}
							}
							if ( cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) == 1 ) {
								txtef COLOR_PINK
								txt lang(name(cc) + "は" + s(1) + "で追撃した！", "Furthermore, " + name(cc) + " attacked with " + s(1) + "!")
								if ( cdata(CDATA_PROT_PENALTY, tc) < 2 ) {
									cdata(CDATA_PROT_PENALTY, tc) = 2
									txtef COLOR_PURPLE
									txt lang(name(tc) + "はよろめいた。", name(tc) + " faltering!")
								}
								snd SOUNDLIST_PUNISH1
								if ( cfg_attackanime ) {
									animeload 39, tc
								}
								dmghp tc, (shootp / 40 * (orgdmg / 3) + rnd(sdata(SKILL_NORMAL_TACTICS, cc) * 10 + 1)) * 200 / limit(sdata(carmor(tc), tc) * 2 + 200, 200, 1200), cc
							}
							if ( cdata(CDATA_EXTRA_ATTACKS_TYPE, cc) == 2 ) {
								txtef COLOR_PINK
								txt lang(name(cc) + "は" + s(1) + "による射撃を加えた！", "Furthermore, " + name(cc) + " fired " + s(1) + "!")
								if ( cdata(CDATA_EVASION_PENALTY, tc) < 2 ) {
									cdata(CDATA_EVASION_PENALTY, tc) = 2
									txtef COLOR_PURPLE
									txt lang(name(tc) + "は体勢を崩した。", name(tc) + " posture was lost.")
								}
								snd SOUNDLIST_PUNISH1
								if ( cfg_attackanime ) {
									animeload 39, tc
								}
								dmghp tc, (shootp / 50 * (orgdmg / 3) + rnd(sdata(SKILL_NORMAL_MARKSMAN, cc) * 5 + 1)) * 200 / limit(sdata(carmor(tc), tc) * 2 + 200, 200, 1200), cc
							}
						}
					}
				}
			}
		}
		if ( attackskill == SKILL_WEAPON_MARTIAL_ARTS ) {
			if ( findbuff(cc, BUFF_ATTRIBUTE) != (-1) ) {
				if ( gdata(GDATA_TEMPORARY_FLAGS2) == 0 ) {
					ele = cdata(CDATA_ATTRIBUTE_ELE, cc) + 50
					gdata(GDATA_DMG_TYPE) = 1
					if ( ele == SKILL_RES_MAGIC ) {
						dmghp tc, orgdmg / 10 * (rnd(400) + limit(sdata(SKILL_WEAPON_MARTIAL_ARTS, cc) * 2, 200, 2000)) / 100 + 1, cc, ele, 1000
					}
					else {
						dmghp tc, orgdmg / 10 * (rnd(400) + limit(sdata(SKILL_WEAPON_MARTIAL_ARTS, cc) * 4, 200, 3000)) / 100 + 1, cc, ele, 1000
					}
					subdmg = 0
					ele = SKILL_NONE
				}
			}
			if ( bakuretu == 100 ) {
				if ( synccheck(cc, -1) ) {
					txt lang(name(cc) + "は爆裂拳を発動した。", name(cc) + " 's fist exploded air.")
				}
				tcbk = tc
				efid = SKILL_SPACT_GRENADE
				efp = limit(sdata(SKILL_ATTR_STR, cc) + sdata(SKILL_WEAPON_MARTIAL_ARTS, cc) * 10 + 500, 800, 30000)
				gosub *effect
				tc = tcbk
				bakucut = 100
				bakuretu = 0
			}
			if ( bakuretu == 200 ) {
				if ( cdata(CDATA_POWER_GAUGE, cc) >= 25 ) {
					cdata(CDATA_POWER_GAUGE, cc) -= 25
					if ( synccheck(cc, -1) ) {
						txt lang(name(cc) + "は迅雷脚を発動した。", name(cc) + " 's kick discharge lightning.")
					}
					tcbk = tc
					efid = SKILL_SPACT_GRENADE
					efp = limit(sdata(SKILL_ATTR_STR, cc) + sdata(SKILL_WEAPON_MARTIAL_ARTS, cc) * 10 + 500, 800, 30000)
					gosub *effect
					tc = tcbk
				}
				bakucut = 100
				bakuretu = 0
			}
			if ( bakuretu == 300 ) {
				if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
					tcbk = tc
					if ( synccheck(cc, -1) ) {
						txt lang(name(cc) + "は強烈なボディブローを叩き込んだ。", name(cc) + " 's fist exploded air.")
					}
					snd SOUNDLIST_BASH1
					dmghp tc, sdata(SKILL_ATTR_STR, cc) / 10 * (sdata(SKILL_WEAPON_MARTIAL_ARTS, cc) + 1) / 10 + 5, cc
					if ( cdata(CDATA_HP, tc) >= 0 ) {
						chara_vomit tc
						if ( cdata(CDATA_THIRST, tc) > 12000 ) {
							chara_morasi tc
						}
					}
					tc = tcbk
				}
				bakucut = 100
				bakuretu = 0
			}
			powsel = 0
			if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
				if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
					powsel = 100
				}
			}
			if ( gdata(GDATA_FLAG_MAIN) >= 350 ) {
				if ( cdata(CDATA_LEVEL, cc) >= 50 ) {
					powsel = 100
				}
			}
			if ( cc < MAX_CHARA_FOLLOWER | cdata(CDATA_ALLIED, cc) == 100 | cc == CHARA_PLAYER ) {
				powsel = 100
			}
			if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
				powsel = 100
			}
			if ( cc >= MAX_CHARA_FOLLOWER & cdata(CDATA_QUALITY, cc) > FIX_QUALITY_GREAT & cdata(CDATA_HP, cc) > cdata(CDATA_MAX_HP, cc) / 2 & cdata(CDATA_POWER_GAUGE, cc) < 200 ) {
				if ( exgauge != 100 ) {
					powsel = 0
				}
			}
			if ( gdata(GDATA_TEMPORARY_FLAGS2) == 888 ) {
				powsel = 0
			}
			if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_TEMPORARY ) {
				if ( cdata(CDATA_DIRECTIVE_MODE_ORG, cc) != 0 ) {
					powsel = 0
				}
			}
			if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_INTERCEPT ) {
				powsel = 0
			}
			if ( cc == CHARA_PLAYER ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
					powsel = 0
				}
			}
			if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
				if ( powsel == 100 ) {
					if ( cdata(CDATA_SHIELD_STYLE_TYPE, cc) == 0 | cdata(CDATA_SHIELD_STYLE_TYPE, cc) == 2 ) {
						if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
							weap = sdata(SKILL_WEAPON_MARTIAL_ARTS, cc)
							efid = SKILL_SPACT_EXPLOSION
							gosub *effect
							weap = 0
						}
					}
				}
			}
		}
		else {
			bakucut = 0
			bakuretu = 0
			gosub *act_attackSub
		}
		if ( cdata(CDATA_REFLECT_DAMAGE, tc) > 0 & bakucut == 0 ) {
			if ( attackrange == 0 ) {
				dmghp cc, limit(cdata(CDATA_REFLECT_DAMAGE, tc) / 100 * dmg + 1, 1, cdata(CDATA_MAX_HP, tc) / 5), tc, SKILL_RESDMG_CUT, 100
			}
		}
		if ( cbit(CHARA_BIT_AWAKE_DIM_ATTACKER, tc) ) {
			if ( bakucut == 0 ) {
				if ( attackrange == 0 ) {
					dmgcon cc, CONDITION_DIM, limit(sdata(SKILL_ATTR_CHA, tc), 200, 1000)
				}
			}
		}
		bakucut = 0
		if ( cdata(CDATA_BARRIER, tc) != 0 ) {
			p = cdata(CDATA_BARRIER, tc) \ 1000
			ccbk = cc
			repeat 1
				if ( attackrange == 0 ) {
					if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, tc), cdata(CDATA_Y, tc)) <= 1 ) {
						if ( p == 61 ) {
							if ( synccheck(cc, -1) ) {
								txtef COLOR_PURPLE
								txt lang("棘が" + name(cc) + "に刺さった。", name(cc) + " " + is(cc) + " stuck by several thorns.")
							}
							dmghp cc, limit(dmg / 10, 1, cdata(CDATA_MAX_HP, tc) / 10), tc, p, cdata(CDATA_BARRIER, tc) / 1000
							break
						}
						if ( p == 62 ) {
							if ( synccheck(cc, -1) ) {
								txtef COLOR_PURPLE
								txt lang("エーテルの棘が" + name(cc) + "に刺さった。", name(cc) + " " + is(cc) + " stuck by several ether thorns.")
							}
							dmghp cc, limit(dmg / 10, 1, cdata(CDATA_MAX_HP, tc) / 10), tc, p, cdata(CDATA_BARRIER, tc) / 1000
							break
						}
						if ( p == 63 ) {
							if ( attackskill != SKILL_WEAPON_MARTIAL_ARTS ) {
								if ( rnd(5) == 0 ) {
									item_acid cc, cw
								}
							}
						}
					}
				}
				if ( dmg > cdata(CDATA_MAX_HP, tc) / 10 ) {
					cc = tc
					tlocx = cdata(CDATA_X, cc)
					tlocy = cdata(CDATA_Y, cc)
					if ( p == 63 ) {
						if ( synccheck(tc, -1) ) {
							txtef COLOR_PURPLE
							txt lang("酸が飛び散った。", "Acids spread over the ground.")
						}
						if ( zero2 != 200 ) {
							efid = SKILL_SPELL_ACID_GROUND
							efp = cdata(CDATA_BARRIER, tc) / 1000
							gosub *effect
						}
						break
					}
				}
			loop
			cc = ccbk
		}
	}
	else {
		if ( cc == CHARA_PLAYER & cfg_attackanime == 1 | (cc < MAX_CHARA_FOLLOWER & cfg_attackanime == 2) | cfg_attackanime == 3 ) {
			snd SOUNDLIST_MISS
		}
		if ( sdata(attackskill, cc) > sdata(SKILL_NORMAL_EVASION, tc) | rnd(5) == 0 ) {
			p = limit(sdata(attackskill, cc) - sdata(SKILL_NORMAL_EVASION, tc) / 2 + 1, 1, 20) / expmodifer
			skillexp SKILL_NORMAL_EVASION, tc, p, 0, 4
			skillexp SKILL_NORMAL_GREATER_EVASION, tc, p, 0, 4
			if ( tc == CHARA_PLAYER ) {
				if ( gdata(GDATA_RIDER) != 0 ) {
					skillexp SKILL_ACTIVE_RIDING, CHARA_PLAYER, p, 0, 4
				}
			}
			if ( tc == gdata(GDATA_RIDER) ) {
				if ( gdata(GDATA_RIDER) != 0 ) {
					skillexp SKILL_ACTIVE_RIDING, gdata(GDATA_RIDER), p, 0, 4
				}
			}
		}
		bakuretu = 0
	}
	if ( findbuff(tc, BUFF_SHIELD_PARRY) != (-1) & attackrange == 0 & cdata(CDATA_SHIELD_STYLE_TYPE, tc) == 1 & (cdata(CDATA_ATTACK_STYLE, tc) & 1) ) {
		if ( hit == (-1) | hit == (-2) ) {
			snd SOUNDLIST_AMMO
			if ( gdata(GDATA_TEMPORARY_FLAGS3) >= 100 ) {
				if ( extraattack ) {
					txt lang("さらに", "Furthermore,")
					txtcontinue
				}
			}
			if ( tc < MAX_CHARA_FOLLOWER ) {
				txt lang(aln(tc) + name(cc) + "の攻撃を盾で弾いた。", name(tc) + " parry" + _s(tc) + " " + name(cc) + ".")
			}
			else {
				txt lang(aln(cc) + "攻撃を盾で弾かれた。", name(cc) + " was parry" + _s(cc, 1) + " by shield.")
			}
			dmgcon cc, CONDITION_INVERT, 2
		}
	}
	else {
		if ( hit == (-1) ) {
			if ( synccheck(cc, -1) ) {
				if ( gdata(GDATA_TEMPORARY_FLAGS3) >= 100 ) {
					if ( extraattack ) {
						txt lang("さらに", "Furthermore,")
						txtcontinue
					}
				}
				if ( tc < MAX_CHARA_FOLLOWER ) {
					txt lang(aln(tc) + name(cc) + "の攻撃を避けた。", name(tc) + " evade" + _s(tc) + " " + name(cc) + ".")
				}
				else {
					txt lang(aln(cc) + "攻撃をかわされた。", name(cc) + " miss" + _s(cc, 1) + " " + name(tc) + ".")
				}
			}
		}
		if ( hit == (-2) ) {
			if ( synccheck(cc, -1) ) {
				if ( extraattack ) {
					txt lang("さらに", "Furthermore,")
					txtcontinue
				}
				if ( tc < MAX_CHARA_FOLLOWER ) {
					txt lang(aln(tc) + name(cc) + "の攻撃を華麗に避けた。", name(tc) + " skillfully evade" + _s(tc) + " " + name(cc) + ".")
				}
				else {
					txt lang(aln(cc) + "攻撃を華麗にかわされた。", name(tc) + " skillfully evade" + _s(tc) + " " + name(cc) + ".")
				}
			}
		}
	}
	if ( findbuff(tc, BUFF_KILLING_DANCE) != (-1) & cdata(CDATA_EXIST, cc) == CHAR_STATE_ALIVE ) {
		if ( hit == (-1) | hit == (-2) ) {
			snd SOUNDLIST_SWING
			if ( tc < MAX_CHARA_FOLLOWER ) {
				txt lang("さらに回避運動から流れるように反撃を繰り出した！", name(tc) + " parry" + _s(tc) + " " + name(cc) + ".")
			}
			else {
				txt lang("さらに反撃を叩き込まれた！", name(cc) + " was parry" + _s(cc, 1) + " by shield.")
			}
			dmghp cc, sdata(SKILL_NORMAL_EVASION, tc) * 5 + rnd(sdata(SKILL_NORMAL_EVASION, tc) + 10), tc
		}
	}
	if ( tc == CHARA_PLAYER ) {
		gdata(GDATA_RUN) = 0
	}
	rowact_check tc
	if ( attackskill != SKILL_WEAPON_MARTIAL_ARTS ) {
		if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
			cw = attackitem
			if ( ibit(ITEM_BIT_ALIVE, cw) ) {
				if ( inv(INV_ITEM_PARAM1, cw) < 15 ) {
					if ( inv(INV_ITEM_PARAM2, cw) < calcexpalive(inv(INV_ITEM_PARAM1, cw)) ) {
						if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) != TRUE & cbit(CHARA_BIT_SUMMONED, tc) != TRUE & cbit(CHARA_BIT_LIVESTOCK, tc) != TRUE & cbit(CHARA_BIT_NECRO, tc) != TRUE & cdata(CDATA_ROLE, tc) != ROLE_BOUNTY_HUNTER & cdata(CDATA_ROLE, tc) != ROLE_GUARD ) {
							ikihosei = 0
						}
						else {
							ikihosei = 50
						}
						inv(INV_ITEM_PARAM2, cw) += rnd(cdata(CDATA_LEVEL, tc) / (inv(INV_ITEM_PARAM1, cw) + ikihosei) + 1)
						if ( inv(INV_ITEM_PARAM2, cw) >= calcexpalive(inv(INV_ITEM_PARAM1, cw)) ) {
							txtef COLOR_GREEN
							snd SOUNDLIST_DING3
							txt lang(itemname(cw) + "は十分に血を味わった！", itemname(cw) + " has tasted enough blood!")
						}
					}
				}
			}
		}
	}
	if ( extraattack == 0 ) {
		if ( cbit(CHARA_BIT_AWAKE_MAGIC_ATTACK, cc) != TRUE ) {
			if ( gdata(GDATA_TEMPORARY_FLAGS3) == 0 ) {
				if ( gdata(GDATA_TEMPORARY_FLAGS2) == 0 ) {
					if ( gdata(GDATA_TEMPORARY_FLAGS) == 0 ) {
						if ( attackrange ) {
							if ( cdatan(CDATAN_CLASS, cc) == "gunner" ) {
								if ( rnd(100) < rnd(cdata(CDATA_EXTRA_SHOOT, cc) * 2 + 1) + 5 ) {
									ammoproc = ENCHANT_AMMO_NONE
									extraattack++
									ele = SKILL_NONE
									goto *act_attack
								}
							}
							if ( cdatan(CDATAN_CLASS, cc) != "gunner" ) {
								if ( rnd(100) < rnd(cdata(CDATA_EXTRA_SHOOT, cc) * 2 + 1) ) {
									ammoproc = ENCHANT_AMMO_NONE
									extraattack++
									ele = SKILL_NONE
									goto *act_attack
								}
							}
						}
						else {
							if ( cdatan(CDATAN_CLASS, cc) == "warrior" ) {
								if ( rnd(100) < rnd(cdata(CDATA_EXTRA_MELEE, cc) * 2 + 1) + 5 ) {
									extraattack++
									ele = SKILL_NONE
									goto *act_attack
								}
							}
							if ( cdatan(CDATAN_CLASS, cc) != "warrior" ) {
								if ( rnd(100) < rnd(cdata(CDATA_EXTRA_MELEE, cc) * 2 + 1) ) {
									extraattack++
									ele = SKILL_NONE
									goto *act_attack
								}
							}
						}
					}
				}
			}
		}
	}
	if ( extraattack >= 1 ) {
		if ( extraattack < 3 | (cdata(CDATA_SHIELD_STYLE_TYPE, cc) == 0 & extraattack < 7 & attackskill == SKILL_WEAPON_MARTIAL_ARTS) ) {
			if ( gdata(GDATA_TEMPORARY_FLAGS3) == 0 ) {
				if ( gdata(GDATA_TEMPORARY_FLAGS2) == 0 ) {
					if ( attackrange ) {
					}
					else {
						handkazu = 0
						repeat 30, 100
							if ( cdata(cnt, cc) / EXT_EQUIP_SLOTS == 5 ) {
								handkazu++
							}
						loop
						if ( attackskill == SKILL_WEAPON_MARTIAL_ARTS ) {
							if ( cdata(CDATA_SHIELD_STYLE_TYPE, cc) == 0 ) {
								handkazu = 0
							}
						}
						if ( handkazu <= 2 ) {
							handkazu = 0
						}
						if ( rnd(100) + (handkazu + 1) * (handkazu + 10) * extraattack < rnd(cdata(CDATA_EXTRA_MELEE, cc) * 2 + 1) ) {
							extraattack++
							ele = SKILL_NONE
							goto *act_attack
						}
						handkazu = 0
					}
				}
			}
		}
	}
	powsel = 0
	if ( gdata(GDATA_FLAG_MAIN) < 350 ) {
		if ( cdata(CDATA_LEVEL, cc) >= 130 ) {
			powsel = 100
		}
	}
	if ( gdata(GDATA_FLAG_MAIN) >= 350 ) {
		if ( cdata(CDATA_LEVEL, cc) >= 50 ) {
			powsel = 100
		}
	}
	if ( cc < MAX_CHARA_FOLLOWER | cdata(CDATA_ALLIED, cc) == 100 | cc == CHARA_PLAYER ) {
		powsel = 100
	}
	if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
		powsel = 100
	}
	if ( cc >= MAX_CHARA_FOLLOWER & cdata(CDATA_QUALITY, cc) > FIX_QUALITY_GREAT & cdata(CDATA_HP, cc) > cdata(CDATA_MAX_HP, cc) / 2 & cdata(CDATA_POWER_GAUGE, cc) < 200 ) {
		if ( exgauge != 100 ) {
			powsel = 0
		}
	}
	if ( gdata(GDATA_TEMPORARY_FLAGS2) == 888 ) {
		powsel = 0
	}
	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_TEMPORARY ) {
		if ( cdata(CDATA_DIRECTIVE_MODE_ORG, cc) != 0 ) {
			powsel = 0
		}
	}
	if ( cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_DEFENSIVE | cdata(CDATA_DIRECTIVE_MODE, cc) == DIRECTIVE_MODE_INTERCEPT ) {
		powsel = 0
	}
	if ( cc == CHARA_PLAYER ) {
		if ( cdata(CDATA_EVOLUTION_STAGE, CHARA_PLAYER) == 0 ) {
			powsel = 0
		}
	}
	if ( gdata(GDATA_TEMPORARY_FLAGS2) == 1200 ) {
		powsel = 0
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			if ( powsel == 100 ) {
				if ( attackskill == SKILL_WEAPON_FIREARM ) {
					if ( inv(INV_ITEM_ID, ammo) == ITEM_ID_MAGNUM ) {
						weap = sdata(SKILL_WEAPON_FIREARM, cc)
						efid = SKILL_SPACT_IMPACT_GUNFIRE
						gosub *effect
					}
				}
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			if ( powsel == 100 ) {
				if ( attackskill == SKILL_WEAPON_FIREARM ) {
					if ( inv(INV_ITEM_ID, ammo) == ITEM_ID_BULLET ) {
						weap = sdata(SKILL_WEAPON_FIREARM, cc)
						efid = SKILL_SPACT_ONE_POINT_SHOOT
						gosub *effect
					}
				}
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			if ( powsel == 100 ) {
				if ( attackskill == SKILL_WEAPON_FIREARM ) {
					if ( inv(INV_ITEM_ID, ammo) == ITEM_ID_ENERGY_CELL ) {
						weap = sdata(SKILL_WEAPON_FIREARM, cc)
						efid = SKILL_SPACT_CRITICAL_PARTICLE_CANNON
						gosub *effect
					}
				}
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			if ( powsel == 100 ) {
				if ( attackskill == SKILL_WEAPON_BOW ) {
					weap = sdata(SKILL_WEAPON_BOW, cc)
					efid = SKILL_SPACT_ARROW_RAIN
					gosub *effect
				}
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			if ( powsel == 100 ) {
				if ( attackskill == SKILL_WEAPON_CROSSBOW ) {
					weap = sdata(SKILL_WEAPON_CROSSBOW, cc)
					efid = SKILL_SPACT_HELM_SMASHER
					gosub *effect
				}
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			if ( powsel == 100 ) {
				if ( attackskill == SKILL_WEAPON_THROWING ) {
					weap = sdata(SKILL_WEAPON_THROWING, cc)
					efid = SKILL_SPACT_SPINNING_THROW
					gosub *effect
				}
			}
		}
	}
	if ( cdata(CDATA_POWER_GAUGE, cc) >= 100 ) {
		if ( powsel == 100 ) {
			if ( attackskill != SKILL_WEAPON_THROWING ) {
				if ( attackskill != SKILL_WEAPON_FIREARM ) {
					if ( attackskill != SKILL_WEAPON_BOW ) {
						if ( attackskill != SKILL_WEAPON_CROSSBOW ) {
							if ( attackskill != SKILL_WEAPON_MARTIAL_ARTS ) {
								if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_SCIMITAR | inv(INV_ITEM_ID, cw) == ITEM_ID_WAKIZASHI | inv(INV_ITEM_ID, cw) == ITEM_ID_DYNAMIC_SABER | inv(INV_ITEM_ID, cw) == ITEM_ID_BLACK_MONKSHOOD ) {
										weap = sdata(SKILL_WEAPON_SHORTSWORD, cc)
										efid = SKILL_SPACT_FLASH_OF_SWIFTNESS
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_LONG_SWORD | inv(INV_ITEM_ID, cw) == ITEM_ID_KATANA | inv(INV_ITEM_ID, cw) == ITEM_ID_LIGHTSABRE | inv(INV_ITEM_ID, cw) == ITEM_ID_DIABLOS | inv(INV_ITEM_ID, cw) == ITEM_ID_ZANTETSUKEN | inv(INV_ITEM_ID, cw) == ITEM_ID_MOURNBLADE | inv(INV_ITEM_ID, cw) == ITEM_ID_RAGNAROK | inv(INV_ITEM_ID, cw) == ITEM_ID_HIRYU_TO | inv(INV_ITEM_ID, cw) == ITEM_ID_STORM_BRINGER | inv(INV_ITEM_ID, cw) == ITEM_ID_MOONLIGHT | inv(INV_ITEM_ID, cw) == ITEM_ID_HOUSENKA | inv(INV_ITEM_ID, cw) == ITEM_ID_THE_WHITE_HAWK | inv(INV_ITEM_ID, cw) == ITEM_ID_FLEURE | inv(INV_ITEM_ID, cw) == ITEM_ID_EPECLAIR ) {
										weap = sdata(SKILL_WEAPON_LONGSWORD, cc)
										efid = SKILL_SPACT_FLASH_OF_SWIFTNESS
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_DAGGER | inv(INV_ITEM_ID, cw) == ITEM_ID_KITCHEN_KNIFE | inv(INV_ITEM_ID, cw) == ITEM_ID_ETHER_DAGGER | inv(INV_ITEM_ID, cw) == ITEM_ID_LUCKY_DAGGER | inv(INV_ITEM_ID, cw) == ITEM_ID_OTI_TUBAKI | inv(INV_ITEM_ID, cw) == ITEM_ID_MELODYUS | inv(INV_ITEM_ID, cw) == ITEM_ID_KUNAI | inv(INV_ITEM_ID, cw) == ITEM_ID_GO_RENGE ) {
										weap = sdata(SKILL_WEAPON_SHORTSWORD, cc)
										efid = SKILL_SPACT_UNDERHAND_DROP
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_SPEAR | inv(INV_ITEM_ID, cw) == ITEM_ID_TRIDENT | inv(INV_ITEM_ID, cw) == ITEM_ID_HALBERD | inv(INV_ITEM_ID, cw) == ITEM_ID_RANKIS | inv(INV_ITEM_ID, cw) == ITEM_ID_HOLY_LANCE | inv(INV_ITEM_ID, cw) == ITEM_ID_PILE_DRIVER | inv(INV_ITEM_ID, cw) == ITEM_ID_UNICORN_DRILL | inv(INV_ITEM_ID, cw) == ITEM_ID_TRISHULA | inv(INV_ITEM_ID, cw) == ITEM_ID_SPADILLE | inv(INV_ITEM_ID, cw) == ITEM_ID_DRILL | inv(INV_ITEM_ID, cw) == ITEM_ID_LANCE | inv(INV_ITEM_ID, cw) == ITEM_ID_GOUTEN ) {
										weap = sdata(SKILL_WEAPON_POLEARM, cc)
										efid = SKILL_SPACT_PENETRATION
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_SOLAR_CANE ) {
										weap = sdata(SKILL_WEAPON_STAVE, cc)
										efid = SKILL_SPACT_PENETRATION
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_ENGOKU ) {
										weap = sdata(SKILL_WEAPON_STAVE, cc)
										efid = SKILL_SPACT_FLASH_OF_SWIFTNESS
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_CLAYMORE | inv(INV_ITEM_ID, cw) == ITEM_ID_DRAGON_SLAYER | inv(INV_ITEM_ID, cw) == ITEM_ID_CLAYMORE2 | inv(INV_ITEM_ID, cw) == ITEM_ID_KINDNESS_BLADE | inv(INV_ITEM_ID, cw) == ITEM_ID_FLAME_EDGE | inv(INV_ITEM_ID, cw) == ITEM_ID_GRANDEL ) {
										weap = sdata(SKILL_WEAPON_LONGSWORD, cc)
										efid = SKILL_SPACT_BISECTION
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_HAND_AXE | inv(INV_ITEM_ID, cw) == ITEM_ID_BATTLE_AXE | inv(INV_ITEM_ID, cw) == ITEM_ID_BARDISH | inv(INV_ITEM_ID, cw) == ITEM_ID_AXE_OF_DESTRUCTION | inv(INV_ITEM_ID, cw) == ITEM_ID_NEGATIVE_EDGE | inv(INV_ITEM_ID, cw) == ITEM_ID_GOD_BREAKER | inv(INV_ITEM_ID, cw) == ITEM_ID_GRAVITY_AXE | inv(INV_ITEM_ID, cw) == ITEM_ID_GULIWELZEN | inv(INV_ITEM_ID, cw) == ITEM_ID_TOMAHAWK | inv(INV_ITEM_ID, cw) == ITEM_ID_CHAINSAW | inv(INV_ITEM_ID, cw) == ITEM_ID_DGT_101 ) {
										weap = sdata(SKILL_WEAPON_AXE, cc)
										efid = SKILL_SPACT_BISECTION
										gosub *effect
									}
									if ( iequiploc(cw) == 10 | inv(INV_ITEM_ID, cw) == ITEM_ID_CLUB | inv(INV_ITEM_ID, cw) == ITEM_ID_HAMMER | inv(INV_ITEM_ID, cw) == ITEM_ID_BLOOD_MOON | inv(INV_ITEM_ID, cw) == ITEM_ID_GAIA_HAMMER | inv(INV_ITEM_ID, cw) == ITEM_ID_BUSTER_BOOK | inv(INV_ITEM_ID, cw) == ITEM_ID_NAIL_STRADIVARIUS | inv(INV_ITEM_ID, cw) == ITEM_ID_SOCKS | inv(INV_ITEM_ID, cw) == ITEM_ID_LUCKY_ALMONDS | inv(INV_ITEM_ID, cw) == ITEM_ID_ZUGAIKURAI | inv(INV_ITEM_ID, cw) == ITEM_ID_GRAVITAIL | inv(INV_ITEM_ID, cw) == ITEM_ID_WAR_HAMMER | inv(INV_ITEM_ID, cw) == ITEM_ID_STAR_HAMMER | inv(INV_ITEM_ID, cw) == ITEM_ID_NAZUNAS_SOX ) {
										weap = sdata(SKILL_WEAPON_BLUNT, cc)
										efid = SKILL_SPACT_PULVERIZATION
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_STAFF | inv(INV_ITEM_ID, cw) == ITEM_ID_LONG_STAFF | inv(INV_ITEM_ID, cw) == ITEM_ID_STAFF_OF_INSANITY | inv(INV_ITEM_ID, cw) == ITEM_ID_ELEMENTAL_STAFF | inv(INV_ITEM_ID, cw) == ITEM_ID_VITAL_FLAYER | inv(INV_ITEM_ID, cw) == ITEM_ID_ZWIEBEL | inv(INV_ITEM_ID, cw) == ITEM_ID_DRAKE_ROD | inv(INV_ITEM_ID, cw) == ITEM_ID_VICE_STAFF | inv(INV_ITEM_ID, cw) == ITEM_ID_WHIP | inv(INV_ITEM_ID, cw) == ITEM_ID_IVY_SPINE | inv(INV_ITEM_ID, cw) == ITEM_ID_BLOODY_TEARS | inv(INV_ITEM_ID, cw) == ITEM_ID_BLOOD_ROD | inv(INV_ITEM_ID, cw) == ITEM_ID_SHAKUJO | inv(INV_ITEM_ID, cw) == ITEM_ID_NUNCHAKU | inv(INV_ITEM_ID, cw) == ITEM_ID_POWER_TRIANGLE ) {
										weap = sdata(SKILL_WEAPON_STAVE, cc)
										efid = SKILL_SPACT_DANCE_OF_BLOW
										gosub *effect
									}
									if ( inv(INV_ITEM_ID, cw) == ITEM_ID_ASTRAL_SICKLE | inv(INV_ITEM_ID, cw) == ITEM_ID_BEAST_SICKLE | inv(INV_ITEM_ID, cw) == ITEM_ID_FRISIAS_TAIL | inv(INV_ITEM_ID, cw) == ITEM_ID_SCYTHE | inv(INV_ITEM_ID, cw) == ITEM_ID_KUMIROMI_SCYTHE | inv(INV_ITEM_ID, cw) == ITEM_ID_SICKLE | inv(INV_ITEM_ID, cw) == ITEM_ID_SCYTHE_OF_THE_VOID | inv(INV_ITEM_ID, cw) == ITEM_ID_CHAINSICKLE | inv(INV_ITEM_ID, cw) == ITEM_ID_SASANQUA_SICKLE | inv(INV_ITEM_ID, cw) == ITEM_ID_NECROMANTIS | inv(INV_ITEM_ID, cw) == ITEM_ID_SCISSORS | inv(INV_ITEM_ID, cw) == ITEM_ID_BONE_SCYTHE | inv(INV_ITEM_ID, cw) == ITEM_ID_NUMENIUS ) {
										weap = sdata(SKILL_WEAPON_SCYTHE, cc)
										efid = SKILL_SPACT_MANA_SLASH
										gosub *effect
									}
									weap = 0
								}
							}
						}
					}
				}
			}
		}
	}
	if ( cdata(CDATA_ID, cc) == CREATURE_ID_RAGNAROCK ) {
		if ( rnd(66) == 0 ) {
			evadd EVENT_RAGNAROK, cc
		}
	}
	if ( cdata(CDATA_ID, cc) == CREATURE_ID_SINAHA ) {
		if ( rnd(66) == 0 ) {
			if ( findbuff(cc, BUFF_LUCK) == (-1) ) {
				addbuff tc, BUFF_UNLUCKY, 6666, 6666
				snd SOUNDLIST_CURSE2
			}
		}
	}
	if ( adata(ADATA_WAKEUP_NEFIA, gdata(GDATA_AREA)) == 103 ) {
		if ( gdata(GDATA_TIME_STOP_TIME) == 0 ) {
			if ( rnd(50) == 0 ) {
				txtef COLOR_SKY_BLUE
				txt lang(name(cc) + "以外の時が止まった。", name(cc) + " stop" + _s(cc) + " time.")
				gdata(GDATA_TIME_STOP_TIME) = 3
			}
		}
	}
	return

*act_attackSub
	if ( gdata(GDATA_TEMPORARY_FLAGS2) >= 100 ) {
		return
	}
	if ( gdata(GDATA_TEMPORARY_FLAGS3) >= 100 ) {
		return
	}
	repeat 15
		cw = attackitem
		if ( inv(40 + cnt * 2, cw) == 0 ) {
			break
		}
		enc = inv(40 + cnt * 2, cw)
		if ( enc == 36 ) {
			p = rnd(inv(40 + cnt * 2 + 1, cw) / 50 + 1) + 1
			if ( cdata(CDATA_SP, tc) > 0 ) {
				healsp cc, rnd(2) + 1
			}
			if ( tc == CHARA_PLAYER ) {
				dmgsp tc, p / 2
			}
			if ( tc != CHARA_PLAYER ) {
				dmgspt tc, p / 2
			}
			dmgsp tc, p / 2
			refreshspeed tc
			continue
		}
		if ( enc == 38 ) {
			p = (rnd(inv(40 + cnt * 2 + 1, cw) / 100 + 1) + 20) * limit(orgdmg / 500, 1, 50) - cdata(CDATA_PV, tc)
			if ( 0 ) {
				txtef COLOR_SKY_BLUE
				txt lang("マナダメ" + p + "オリダメ" + orgdmg + "。", name(cc) + " stop" + _s(cc) + " time.")
			}
			if ( p <= 0 ) {
				p = 1
			}
			healmp cc, p / 5 + 1
			if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
				continue
			}
			dmgmp tc, p
			continue
		}
		if ( enc == 37 ) {
			if ( rnd(66) == 0 ) {
				evadd EVENT_RAGNAROK, cc
			}
			continue
		}
		if ( enc == 40 ) {
			if ( gdata(GDATA_TIME_STOP_TIME) == 0 ) {
				if ( rnd(25) == 0 ) {
					snd SOUNDLIST_CHEST1
					animeload 42, cc
					txtef COLOR_SKY_BLUE
					txt lang(name(cc) + "は時を止めた。", name(cc) + " stop" + _s(cc) + " time.")
					gdata(GDATA_TIME_STOP_TIME) = limit(inv(40 + cnt * 2 + 1, cw) / 100 + 1 + 1, 2, 6)
					await
					snd SOUNDLIST_CHEST1
				}
				continue
			}
		}
		if ( enc == 57 ) {
			s = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
			if ( instr(s, 0, "/dragon/") != (-1) ) {
				gdata(GDATA_DMG_TYPE) = 1
				dmghp tc, orgdmg / 30 * (rnd(20) + inv(40 + cnt * 2 + 1, cw)) / 50 + 1, cc
				subdmg = 0
			}
			continue
		}
		if ( enc == 61 ) {
			s = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
			if ( instr(s, 0, "/god/") != (-1) ) {
				gdata(GDATA_DMG_TYPE) = 1
				dmghp tc, orgdmg / 30 * (rnd(20) + inv(40 + cnt * 2 + 1, cw)) / 50 + 1, cc
				subdmg = 0
			}
			continue
		}
		if ( enc == 58 ) {
			s = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
			if ( instr(s, 0, "/undead/") != (-1) ) {
				gdata(GDATA_DMG_TYPE) = 1
				dmghp tc, orgdmg / 30 * (rnd(20) + inv(40 + cnt * 2 + 1, cw)) / 50 + 1, cc
				subdmg = 0
			}
			continue
		}
		if ( enc == 76 ) {
			if ( cbit(CHARA_BIT_FLOAT, tc) == TRUE ) {
				gdata(GDATA_DMG_TYPE) = 1
				dmghp tc, orgdmg / 120 * (rnd(10) + inv(40 + cnt * 2 + 1, cw)) / 50 + 1, cc
				subdmg = 0
			}
			continue
		}
		i = enc / 10000
		if ( i != 0 ) {
			enc = enc \ 10000
			if ( i == 7 ) {
				if ( orgdmg <= 1 ) {
					continue
				}
				ele = enc
				if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
					continue
					ele = SKILL_NONE
				}
				gdata(GDATA_DMG_TYPE) = 1
				dmghp tc, orgdmg / 10 * (rnd(100) + inv(40 + cnt * 2 + 1, cw)) / 100 + 1, cc, ele, inv(40 + cnt * 2 + 1, cw) / 2 + 100
				subdmg = 0
				continue
			}
			if ( i == 8 ) {
				if ( cdata(CDATA_EXIST, tc) != CHAR_STATE_ALIVE ) {
					continue
				}
				if ( enc >= 28 ) {
					continue
				}
				tcbk = tc
				p = encprocref(ENCPROCREF_TARGET_TYPE, enc)
				if ( p == 3000 | p == 10000 ) {
					tc = cc
				}
				p = encprocref(ENCPROCREF_PROC_CHANCE, enc)
				enc = encprocref(ENCPROCREF_SKILL_ID, enc)
				if ( enc == 655 ) {
					if ( inv(INV_ITEM_ID, cw) == ITEM_ID_NOVA_GRENADE | inv(INV_ITEM_ID, cw) == ITEM_ID_GRENADE ) {
						if ( attackskill != SKILL_WEAPON_BLUNT ) {
							p = 90
						}
					}
				}
				tlocx = cdata(CDATA_X, tc)
				tlocy = cdata(CDATA_Y, tc)
				if ( rnd(100) < p ) {
					gdata(GDATA_ACTIVATE_PROC) = 100
					efid = enc
					efp = inv(40 + cnt * 2 + 1, cw) + sdata(attackskill, cc) * 10
					gosub *effect
				}
				gdata(GDATA_ACTIVATE_PROC) = 0
				tc = tcbk
				continue
			}
			continue
		}
	loop
	if ( ammoproc == ENCHANT_AMMO_TIME_STOP ) {
		snd SOUNDLIST_CHEST1
		animeload 42, cc
		txtef COLOR_SKY_BLUE
		txt lang(name(cc) + "は時を止めた。", name(cc) + " stop" + _s(cc) + " time.")
		gdata(GDATA_TIME_STOP_TIME) = 4
		await
		snd SOUNDLIST_CHEST1
	}
	if ( ammoproc == ENCHANT_AMMO_MAGIC ) {
		if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
			gdata(GDATA_DMG_TYPE) = 1
			dmghp tc, orgdmg, cc, rnd(61 - 50) + 50, sdata(attackskill, cc) * 10 + 100
			subdmg = 0
		}
	}
	if ( ammoproc == ENCHANT_AMMO_EXPLOSIVE ) {
		tlocx = ammox
		tlocy = ammoy
		tcbk = tc
		efid = SKILL_SPELL_MAGIC_STORM
		efp = sdata(attackskill, cc) * 8 + 10
		gosub *effect
		tc = tcbk
	}
	ele = SKILL_NONE
	return

*act_search
	msgdup++
	txt lang("周囲を注意深く調べた。", "You search the surroundings carefully.")
	if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
		inv_getheader -1
		p = 9999
		repeat invrange, invhead
			if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
				continue
			}
			if ( inv(INV_ITEM_PROPERTY, cnt) != PROPERTY_SPECIAL ) {
				continue
			}
			if ( inv(INV_ITEM_ID, cnt) != ITEM_ID_SUMMONING_CRYSTAL ) {
				continue
			}
			if ( p > dist(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)) ) {
				p = dist(inv(INV_ITEM_X, cnt), inv(INV_ITEM_Y, cnt), cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER))
			}
		loop
		if ( p != 9999 ) {
			repeat
				if ( p <= 3 ) {
					txt lang("辺りの空気は息苦しいほどの緊張に包まれている。", "The air around you is filled with strained silence.")
				}
				if ( p <= 9 ) {
					txt lang("微かだが、あなたの心臓はトクンと脈打った。", "Your heart starts beating in your chest.")
					break
				}
				if ( p <= 16 ) {
					txt lang("まだだ、まだ遠い…", "Stll, still lying far ahead.")
					break
				}
				txt lang("あなたは青い水晶の存在を感じた。", "You sense a blue crystal lying somewhere in this area.")
				break
			loop
		}
	}
	repeat 11
		y = cdata(CDATA_Y, cc) + cnt - 5
		if ( y < 0 | y >= mdata(MDATA_HEIGHT) ) {
			continue
		}
		repeat 11
			x = cdata(CDATA_X, cc) + cnt - 5
			if ( x < 0 | x >= mdata(MDATA_WIDTH) ) {
				continue
			}
			if ( map(x, y, MAP_FEATS_ON_TILE) != 0 ) {
				cell_featread x, y
				refx = x
				refy = y
				if ( abs(cdata(CDATA_Y, cc) - y) <= 1 & abs(cdata(CDATA_X, cc) - x) <= 1 ) {
					if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_TRAP ) {
						if ( feat(FEAT_CELL_PIC) == 0 ) {
							gosub *calcSearch
							if ( stat == 1 ) {
								gosub *revealTrap
								txt lang("罠を発見した。", "You discover a trap.")
							}
						}
					}
					if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_HIDDEN_PATH ) {
						gosub *calcSearch
						if ( stat == 1 | 0 ) {
							gosub *revealHiddenPath
							txt lang("隠れた通路を発見した。", "You discover a hidden path.")
						}
					}
				}
				if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SMALL_MEDAL ) {
					if ( gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
						if ( cdata(CDATA_X, cc) == x & cdata(CDATA_Y, cc) == y ) {
							snd SOUNDLIST_DING2
							txt lang("なんと小さなメダルを見つけた！", "You find a small coin!")
							map(x, y, MAP_FEATS_ON_TILE) = 0
							flt
							itemcreate -1, ITEM_ID_SMALL_MEDAL, x, y, 0
						}
						else {
							txtmore
							if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), x, y) > 2 ) {
								txt lang("この辺りには何かがありそうな予感がする…", "You sense something.")
							}
							else {
								txt lang("あなたは何かが輝くのを目にした。", "You see something shines.")
							}
						}
					}
				}
			}
		loop
	loop
	cell_featread cdata(CDATA_X, cc), cdata(CDATA_Y, cc)
	if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_TRAP ) {
		if ( feat(FEAT_CELL_PIC) == tile_trap ) {
			movx = cdata(CDATA_X, cc)
			movy = cdata(CDATA_Y, cc)
			gosub *disarmTrap
		}
	}
	if ( feat(FEAT_CELL_FEATURE_ID) >= CELL_FEATURE_SAMPLING_SPOT_DETECTION & feat(FEAT_CELL_FEATURE_ID) <= CELL_FEATURE_SAMPLING_SPOT_GARDENING ) {
		rowactre = 1, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_DETECTION ) {
			gosub *search
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_GENE_ENGINEER ) {
			gosub *search
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_FISHING ) {
			gosub *fishing
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_MINING ) {
			gosub *dig
		}
		if ( feat(FEAT_CELL_FEATURE_ID) == CELL_FEATURE_SAMPLING_SPOT_GARDENING ) {
			gosub *plant
		}
	}
	goto *turn_end

*revealTrap
	cell_featset refx, refy, tile_trap, -1, -1
	return

*revealHiddenPath
	map(refx, refy, MAP_TILE_ID) = tile_tunnel
	cell_featset refx, refy, 0, CELL_FEATURE_NONE
	return

*act_dig
	if ( cdata(CDATA_SP, cc) < 0 ) {
		txt lang("疲れ過ぎて無理だ。", "You are too exhausted to do that.")
		gosub *screen_draw
		goto *pc_turn
	}
	rowactre = 0
	digx = tlocx
	digy = tlocy
	gosub *dig
	goto *turn_end
	goto *act_dip

#deffunc dipcursed int dipcursed_item, int dipcursed_arg1
	if ( refitem(inv(INV_ITEM_ID, dipcursed_item), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
		if ( inv(INV_ITEM_MATERIAL, dipcursed_item) == ITEM_MATERIAL_RAW ) {
			txt lang(itemname(dipcursed_item) + "は腐ってしまった…", "" + itemname(dipcursed_item) + " rots.")
			inv(INV_ITEM_PARAM3, dipcursed_item) = -1
			inv(INV_ITEM_PIC, dipcursed_item) = xy2pic(6, 10)
			cell_refresh inv(INV_ITEM_X, dipcursed_item), inv(INV_ITEM_Y, dipcursed_item)
			return
		}
		else {
			txt lang(itemname(dipcursed_item) + "に変化はない。", "" + itemname(dipcursed_item) + " remains unchanged.")
			return
		}
	}
	if ( refitem(inv(INV_ITEM_ID, dipcursed_item), DBSPEC_TYPE) < FILTER_ITEM_MIN ) {
		inv(INV_ITEM_LEVEL, dipcursed_item)--
		snd SOUNDLIST_CRACK
		if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
			if ( inv(INV_ITEM_LEVEL, dipcursed_item) == (-10) ) {
				snd SOUNDLIST_CRACK2
				animeload 64, 0
			}
		}
		txt lang(itemname(dipcursed_item) + "は錆びてしまった…", "" + itemname(dipcursed_item) + " rusts.")
		if ( inv_getowner(dipcursed_item) != (-1) ) {
			r1 = inv_getowner(dipcursed_item)
			gosub *charaRefresh
		}
		if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
			if ( inv(INV_ITEM_LEVEL, dipcursed_item) < (-10) ) {
				snd SOUNDLIST_ATK_POISON
				txtef COLOR_RED
				txt lang(name(locvar_dipcursed_tc) + "の" + itemname(dipcursed_item) + "はドロドロに溶けてしまった。", name(locvar_dipcursed_tc) + your(locvar_dipcursed_tc) + " " + itemname(dipcursed_item, , 1) + " is melted.")
				inv(INV_ITEM_NUM, dipcursed_item)--
				cdata(inv(INV_ITEM_EQUIP, dipcursed_item), locvar_dipcursed_tc) = cdata(inv(INV_ITEM_EQUIP, dipcursed_item), locvar_dipcursed_tc) / EXT_EQUIP_SLOTS * 10000
				inv(INV_ITEM_EQUIP, dipcursed_item) = 0
				r1 = inv_getowner(dipcursed_item)
				gosub *charaRefresh
			}
		}
		return
	}
	txt lang("何もおきない… ", "Nothing happens...")
	return

*act_dip
	procid = (procid + 1) \ 4
	proclist(procid) = "proc_dip" + " ct:" + ct
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BAIT ) {
		item_separate ci
		item_num cidip, -1
		snd SOUNDLIST_EQUIP1
		txt lang(itemname(cidip, 1) + "を" + itemname(ci) + "に装着した。", "You bait " + itemname(ci) + " with " + itemname(cidip, 1) + ".")
		if ( inv(INV_ITEM_PARAM4, ci) == inv(INV_ITEM_PARAM1, cidip) ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) += rnd(10) + 15
		}
		else {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = rnd(10) + 15
			inv(INV_ITEM_PARAM4, ci) = inv(INV_ITEM_PARAM1, cidip)
		}
		goto *turn_end
	}
	snd SOUNDLIST_DRINK1
	if ( refitem(inv(INV_ITEM_ID, cidip), DBSPEC_TYPE) == FILTER_ITEM_POTION ) {
		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE_MINOR) == FILTER_FURNITURE_WELL ) {
			item_separate ci
			item_num cidip, -1
			if ( inv(INV_ITEM_ID, cidip) != ITEM_ID_EMPTY_BOTTLE ) {
				txt lang(itemname(cidip, 1) + "を" + itemname(ci) + "に浸した。", "You dip " + itemname(ci) + " into " + itemname(cidip, 1) + ".")
				txtmore
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HOLY_WELL ) {
					txt lang("井戸は汚れた。", "The holy well is polluted.")
					goto *turn_end
				}
				if ( inv(INV_ITEM_PARAM3, ci) >= 20 ) {
					txt lang(itemname(ci) + "は完全に枯れている。", itemname(ci) + " is completely dry.")
					goto *turn_end
				}
				txt lang(itemname(ci) + "は一瞬輝いた。", itemname(ci) + " shines for a moment.")
				if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_HANDFUL_SNOW ) {
					txt lang("こんな量では… ", "Snow just melts.")
				}
				else {
					inv(INV_ITEM_PARAM1, ci) += rnd(3)
				}
				goto *turn_end
			}
			else {
				if ( inv(INV_ITEM_PARAM1, ci) < (-5) | inv(INV_ITEM_PARAM3, ci) >= 20 | (inv(INV_ITEM_ID, ci) == ITEM_ID_HOLY_WELL & gdata(GDATA_FLAG_HOLY_WELL) <= 0) ) {
					valn = itemname(ci)
					txt lang(valn + "は涸れている。", valn + " is dry.")
					txtmore
					txt lang("あっ！空き瓶を井戸に落としてしまった…", "Ops! You drop the empty bottle into the well...")
					goto *turn_end
				}
				if ( gdata(GDATA_FLAG_GAME_MODE) == 1 ) {
					if ( inv_sum(CHARA_PLAYER) > 20 ) {
						txt lang("バックパックが一杯だ。", "Your inventory is full.")
						goto *turn_end
					}
				}
				if ( inv_getspace(CHARA_PLAYER) == 0 ) {
					txt lang("あっ！空き瓶を井戸に落としてしまった…", "Ops! You drop the empty bottle into the well...")
					goto *turn_end
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HOLY_WELL ) {
					gdata(GDATA_FLAG_HOLY_WELL)--
					flt
					itemcreate CHARA_PLAYER, ITEM_ID_BOTTLE_WATER, -1, -1, 0
					if ( stat != 0 ) {
						inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
					}
					if ( inv_getfreeid(CHARA_PLAYER) == (-1) ) {
						item_num cidip, 1
						txt lang("バックパックには、もうアイテムを入れる余裕がない。", "Your inventory is full.")
						goto *turn_end
					}
				}
				else {
					inv(INV_ITEM_PARAM1, ci) -= 3
					flt 20
					flttypemajor = FILTER_ITEM_POTION
					itemcreate CHARA_PLAYER, ITEM_ID_DUMMY, -1, -1, 0
				}
				txt lang("空き瓶に水をすくった。", "You draw water from the well into the empty bottle.")
				txtvalid = 0
				txt lang(itemname(ci, 1) + "を手に入れた。", "You get " + itemname(ci, 1) + ".")
				item_stack CHARA_PLAYER, ci, 1
				goto *turn_end
			}
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_POISON ) {
		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
			item_num cidip, -1
			item_separate ci
			txt lang(itemname(ci) + "に" + itemname(cidip, 1) + "を混入した！あなたはにやりと笑った。", "You made aphrodisiac food! You grin.")
			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
				dipcursed ci
			}
			ibitmod ITEM_BIT_POISON_BLEND, ci, TRUE
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_JUICE ) {
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_JUICE ) {
			item_num cidip, -1
			item_separate ci
			txt lang(itemname(ci) + "はミックスジュースになった！", "You made a mix juice!")
			ibitmod ITEM_BIT_HERBED_IN, ci, TRUE
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_MILK ) {
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_JUICE | inv(INV_ITEM_ID, ci) == ITEM_ID_COFFEE ) {
			item_num cidip, -1
			item_separate ci
			txt lang(itemname(ci) + "に乳を混ぜた！", "You mixed milk.")
			ibitmod ITEM_BIT_ACIDPROOF, ci, TRUE
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_LOVE_POTION ) {
		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
			item_num cidip, -1
			item_separate ci
			txt lang(itemname(ci) + "に媚薬を混入した！あなたはうしろめたさを感じた…", "You made aphrodisiac food! You kind of feel guilty...")
			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
				dipcursed ci
			}
			ibitmod ITEM_BIT_LOVE_BLEND, ci, TRUE
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_DIRTY_WATER | inv(INV_ITEM_ID, cidip) == ITEM_ID_VOMIT | inv(INV_ITEM_ID, cidip) == ITEM_ID_URINE ) {
		if ( inv(INV_ITEM_STATUS, ci) == ITEM_STATUS_BLESSED ) {
			if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
				in = inv(INV_ITEM_NUM, cidip)
			}
			else {
				in = 1
				item_separate ci
			}
			item_num cidip, -1
			txt lang(itemname(ci) + "は輝きを失った…", "You removed shine from " + itemname(ci) + ".")
			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
			r1 = cc
			gosub *charaRefresh
			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
				dipcursed ci
			}
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_ANTISEPTIC ) {
		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_FOOD ) {
			item_num cidip, -1
			item_separate ci
			txt lang(itemname(ci) + "に永久防腐剤を混ぜた。", "You made Incorruptible food!")
			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
				dipcursed ci
			}
			ibitmod ITEM_BIT_ANTISEPTIC, ci, TRUE
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_DYE ) {
		if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
			in = inv(INV_ITEM_NUM, cidip)
		}
		else {
			in = 1
			item_separate ci
		}
		item_num cidip, -1
		inv(INV_ITEM_COL, ci) = inv(INV_ITEM_COL, cidip)
		txt lang("あなたは" + itemname(ci) + "を染めた。", "You dye " + itemname(ci) + ".")
		if ( inv_getowner(ci) == (-1) ) {
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		}
		if ( inv(INV_ITEM_EQUIP, ci) != 0 ) {
			create_pcpic cc, 1
		}
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_ACIDPROOF_LIQUID ) {
		if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) != FILTER_ITEM_POTION ) {
			if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
				in = inv(INV_ITEM_NUM, cidip)
			}
			else {
				in = 1
				item_separate ci
			}
			txt lang(itemname(ci) + "に" + itemname(cidip, 1) + "を塗りたくった。", "You put " + itemname(cidip, 1) + " on " + itemname(ci) + ".")
			if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
				dipcursed ci
			}
			else {
				ibitmod ITEM_BIT_ACIDPROOF, ci, TRUE
				txt lang(itemname(ci) + "は酸から守られた。", itemname(ci) + " gain" + _s2(in) + " acidproof.")
			}
			item_num cidip, -1
			goto *turn_end
		}
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_FIREPROOF_LIQUID ) {
		if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
			in = inv(INV_ITEM_NUM, cidip)
		}
		else {
			in = 1
			item_separate ci
		}
		txt lang(itemname(ci, in) + "に" + itemname(cidip, 1) + "を塗りたくった。", "You put " + itemname(cidip, 1) + " on " + itemname(ci, in) + ".")
		if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
			dipcursed ci
		}
		else {
			if ( inv(INV_ITEM_ID, ci) == ITEM_ID_FIREPROOF_BLANKET ) {
				txt lang("いいアイデアだ！しかし…", "A good idea! But...")
			}
			else {
				ibitmod ITEM_BIT_FIREPROOF, ci, TRUE
				txt lang(itemname(ci) + "は熱から守られた。", itemname(ci) + " gain" + _s2(in) + " fireproof.")
			}
		}
		item_num cidip, -1
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, cidip) == ITEM_ID_BOTTLE_WATER ) {
		item_num cidip, -1
		if ( inv(INV_ITEM_STATUS, cidip) == ITEM_STATUS_BLESSED ) {
			txtef COLOR_GREEN
			txt lang(itemname(ci) + "は銀色に輝いた。", itemname(ci) + " shine" + _s2(inv(INV_ITEM_NUM, ci)) + " silvery.")
			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_BLESSED
			r1 = cc
			gosub *charaRefresh
			goto *turn_end
		}
		if ( inv(INV_ITEM_STATUS, cidip) <= ITEM_STATUS_CURSED ) {
			txtef COLOR_PURPLE
			txt lang(itemname(ci) + "は黒いオーラに包まれた。", itemname(ci) + " " + is2(inv(INV_ITEM_NUM, ci)) + " wrapped by a dark aura.")
			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_CURSED
			r1 = cc
			gosub *charaRefresh
			goto *turn_end
		}
	}
	txt lang("何もおきない… ", "Nothing happens...")
	goto *turn_end

*act_use
	procid = (procid + 1) \ 4
	proclist(procid) = "act_use" + " ct:" + ct
	screenupdate = -1
	gosub *screen_draw
	tc = cc
	tlocx = cdata(CDATA_X, cc)
	tlocy = cdata(CDATA_Y, cc)
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE) == FILTER_ITEM_POTION & inv(INV_ITEM_ID, ci) != ITEM_ID_ENCOUNTER_CANCELLER & inv(INV_ITEM_ID, ci) != ITEM_ID_HANDFUL_SNOW ) {
		kakeru = 100
		goto *act_throw
	}
	if ( ibit(ITEM_BIT_PERIOD, ci) == TRUE ) {
		if ( gdata(GDATA_FLAG_INSIDE_DEEP_SEA_CASTLE) == 100 ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + inv(INV_ITEM_PARAM3, ci)
			if ( inv(INV_ITEM_PARAM3, ci) >= 24 ) {
				inv(INV_ITEM_NEED_SLEEP, ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
			}
		}
		if ( gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 < inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) ) {
			txt lang("そのアイテムが次に使用できるのは" + cnvdate(inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci), 1) + "だ。", "This item will be useable again at " + cnvdate(inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci), 1) + ".")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( inv(INV_ITEM_NEED_SLEEP, ci) > 1 ) {
			if ( inv(INV_ITEM_NEED_SLEEP, ci) >= gdata(GDATA_FLAG_DATE_OF_LAST_BREAKFAST) ) {
				txt lang("そのアイテムが次に使用できるのは睡眠後だ。", "This item will be useable again after sleep.")
				gosub *screen_draw
				goto *pc_turn
			}
		}
		item_separate ci
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + inv(INV_ITEM_PARAM3, ci)
		if ( inv(INV_ITEM_PARAM3, ci) >= 24 ) {
			inv(INV_ITEM_NEED_SLEEP, ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
		}
	}
	if ( ibit(ITEM_BIT_CHARGE_ITEM, ci) == TRUE ) {
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) <= 0 ) {
			txt lang("それはもう使えない。", "It's out of charge.")
			gosub *screen_draw
			goto *pc_turn
		}
		item_separate ci
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)--
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE_MINOR) == FILTER_ITEM_SEED ) {
		goto *item_seed
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE_MINOR) == FILTER_ITEM_TOOL_BLEND ) {
		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE | (gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179) ) {
			txt lang("ここでは使えない。", "You can't place it here.")
			gosub *screen_draw
			goto *pc_turn
		}
		blendtool = ci
		goto *com_blend
	}
	if ( refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE_MINOR) == FILTER_FURNITURE_BED ) {
		if ( gdata(GDATA_SLEEP) < 15 ) {
			if ( 0 == 0 ) {
				txt lang("まだ眠たくない。", "You don't feel sleepy yet.")
				gosub *screen_draw
				goto *pc_turn
			}
		}
		gdata(GDATA_ROW_ACT) = ACTION_SLEEP
		gosub *generalAct
		goto *turn_end
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_RED_TREASURE_MACHINE | inv(INV_ITEM_ID, ci) == ITEM_ID_BLUE_TREASURE_MACHINE ) {
		goto *com_gasha
	}
	if ( inv(INV_ITEM_ID, ci) == ITEM_ID_PACHISURO_MACHINE | inv(INV_ITEM_ID, ci) == ITEM_ID_CASINO_TABLE | inv(INV_ITEM_ID, ci) == ITEM_ID_SLOT_MACHINE | inv(INV_ITEM_ID, ci) == ITEM_ID_DARTS_BOARD ) {
		atxid = 1
		gosub *com_txtadv
		goto *turn_end
	}
	if ( inv(INV_ITEM_EFFECT, ci) == EFFECT_CARPENTRY | inv(INV_ITEM_EFFECT, ci) == EFFECT_ALCHEMY | inv(INV_ITEM_EFFECT, ci) == EFFECT_JEWELER | inv(INV_ITEM_EFFECT, ci) == EFFECT_TAILOR ) {
		prodtype = inv(INV_ITEM_EFFECT, ci)
		snd SOUNDLIST_POP2
		invctrl = 0
		gosub *label_4854
		goto *turn_end
	}
	if ( ibit(ITEM_BIT_ULTIMATE, ci) == TRUE ) {
		if ( synccheck(tc, -1) ) {
			txtef COLOR_RED
			txt lang("エターナルフォース一本につき一度しか使えない。無差別全域攻撃魔法を発動する？", "You can only use once per one Eternal Force. Do you want to invoke the maximum indifference magic?")
		}
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval == 0 ) {
			if ( gdata(GDATA_AREA) == AREA_PET_ARENA | mdata(MDATA_TYPE) == MAP_TYPE_WORLD | gdata(GDATA_AREA) == AREA_PYRAMID | gdata(GDATA_AREA) == AREA_JAIL ) {
				txt lang("何もおきない… ", "Nothing happens...")
				goto *turn_end
			}
			snd SOUNDLIST_ATK_ICE
			txtef COLOR_BLUE
			txt lang("周囲の大気が一瞬にして氷結した！", "The surrounding air was frozen in a moment!")
			snd SOUNDLIST_ATK_ICE
			ibitmod ITEM_BIT_ULTIMATE, ci, FALSE
			snd SOUNDLIST_ATK_ICE
			snd SOUNDLIST_ATK_ICE
			snd SOUNDLIST_ATK_ICE
			repeat mdata(MDATA_HEIGHT)
				dy = cnt
				repeat mdata(MDATA_WIDTH)
					dx = cnt
					f = 0
					if ( map(dx, dy, MAP_TILE_ID) == xy2pic(0, 18) | map(dx, dy, MAP_TILE_ID) == xy2pic(3, 5) | map(dx, dy, MAP_TILE_ID) == xy2pic(0, 5) | map(dx, dy, MAP_TILE_ID) == xy2pic(6, 5) | map(dx, dy, MAP_TILE_ID) == xy2pic(9, 5) ) {
						map(dx, dy, MAP_TILE_ID) = xy2pic(22, 5)
						f = 1
					}
					if ( map(dx, dy, MAP_TILE_ID) == xy2pic(10, 19) | map(dx, dy, MAP_TILE_ID) == xy2pic(1, 19) | map(dx, dy, MAP_TILE_ID) == xy2pic(15, 19) ) {
						map(dx, dy, MAP_TILE_ID) = xy2pic(20, 5)
						f = 1
					}
					if ( map(dx, dy, MAP_TILE_ID) == xy2pic(19, 5) | map(dx, dy, MAP_TILE_ID) == xy2pic(11, 6) | map(dx, dy, MAP_TILE_ID) == xy2pic(16, 6) | map(dx, dy, MAP_TILE_ID) == xy2pic(18, 6) | map(dx, dy, MAP_TILE_ID) == xy2pic(21, 5) | map(dx, dy, MAP_TILE_ID) == xy2pic(24, 5) | map(dx, dy, MAP_TILE_ID) == xy2pic(25, 5) ) {
						map(dx, dy, MAP_TILE_ID) = xy2pic(21, 5)
						f = 1
					}
					if ( map(dx, dy, MAP_TILE_ID) >= xy2pic(0, 12) & map(dx, dy, MAP_TILE_ID) <= xy2pic(32, 16) ) {
						map(dx, dy, MAP_TILE_ID) = xy2pic(12, 12)
						f = 1
					}
					if ( map(dx, dy, MAP_TILE_ID) >= xy2pic(32, 16) & map(dx, dy, MAP_TILE_ID) <= xy2pic(10, 20) ) {
						map(dx, dy, MAP_TILE_ID) = xy2pic(10, 20)
						f = 1
					}
					if ( map(dx, dy, MAP_TILE_ID) == xy2pic(8, 21) | map(dx, dy, MAP_TILE_ID) == xy2pic(11, 20) ) {
						f = 1
					}
					if ( f == 0 ) {
						map(dx, dy, MAP_TILE_ID) = xy2pic(12, 1)
						if ( rnd(10) == 0 ) {
							map(dx, dy, MAP_TILE_ID) = xy2pic(24, 1)
						}
						if ( rnd(8) == 0 ) {
							map(dx, dy, MAP_TILE_ID) = xy2pic(23, 1)
						}
					}
					if ( map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
						tc = map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) - 1
						snd SOUNDLIST_ATK_ICE
						if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
							if ( tc != CHARA_PLAYER ) {
								if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
									tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
								}
								txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
							}
						}
						dmg = 1000 + limit(sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) * sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) / 3, 1, 99999)
						addbuff tc, BUFF_DEATH_WORD, sdata(SKILL_NORMAL_MAGIC_DEVICE, cc) * 20, 2
						dmghp tc, dmg, cc, SKILL_RES_COLD, 1000
						snd SOUNDLIST_ATK_ICE
						snd SOUNDLIST_ATK_ICE
						if ( cdata(CDATA_REFLECT_MAGIC, tc) > 0 ) {
							if ( cc >= MAX_CHARA_FOLLOWER | tc >= MAX_CHARA_FOLLOWER ) {
								dmghp cc, limit(dmg * cdata(CDATA_REFLECT_MAGIC, tc) / 200 + 1, 1, cdata(CDATA_MAX_HP, cc) / 10), tc, SKILL_RES_FIRE, 1000
								if ( synccheck(tc, -1) ) {
									txtef COLOR_PURPLE
									txt lang(name(tc) + "は魔法の一部を反射した。", name(tc) + " reflected magic.")
								}
							}
						}
					}
				loop
			loop
			p = 1
			repeat p
				repeat mdata(MDATA_HEIGHT)
					y = cnt
					repeat mdata(MDATA_WIDTH)
						x = cnt
						p = dist(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), x, y)
						map(x, y, MAP_TILE_ID_MEMORY) = map(x, y, MAP_TILE_ID)
					loop
				loop
			loop
			goto *turn_end
		}
		else {
			goto *pc_turn
		}
	}
	if ( ibit(ITEM_BIT_ALIVE, ci) ) {
		if ( inv(INV_ITEM_PARAM1, ci) >= 15 ) {
			txt lang("この武器は成長しきっている。", "The weapon can not grow any more.")
			goto *pc_turn
		}
		if ( inv(INV_ITEM_PARAM2, ci) < calcexpalive(inv(INV_ITEM_PARAM1, ci)) & 0 == 0 ) {
			txt lang("この武器はまだ血を吸い足りない。", "The weapon needs more blood.")
		}
		else {
			txtnew
			txt lang(itemname(ci) + "は十分に血を吸い成長できる！", itemname(ci) + " sucked enough blood and ready to grow!")
			if ( inv(INV_ITEM_PARAM1, ci) >= 10 ) {
				txt lang("しかし、なんだか様子がおかしい…", "But you sense something weird.")
			}
			txt lang("それは…", "It...")
			reftype = refitem(inv(INV_ITEM_ID, ci), DBSPEC_TYPE)
			listmax = 0
			taisei = inv(INV_ITEM_DICE2, ci) + inv(INV_ITEM_LEVEL, ci) + gdata(GDATA_MONTH)
			list(0, listmax) = rtval, rtval(1)
			list(0, listmax) = -1
			listmax++
			s = lang("ボーナス+4を獲得する", "Bonus+4")
			promptl(0, promptmax) = s, "null", "" + promptmax
			promptmax++
			if ( taisei \ 11 == 0 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("火炎耐性***を獲得する", "ResFire element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 1 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("冷気耐性***を獲得する", "ResCold element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 2 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("電撃耐性***を獲得する", "ResLightning element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 3 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("暗黒耐性***を獲得する", "ResDarkness element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 4 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("幻惑耐性***を獲得する", "ResMind element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 5 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("毒耐性***を獲得する", "ResPoison element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 6 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("地獄耐性***を獲得する", "ResNether element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 7 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("音耐性***を獲得する", "ResSound element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 8 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("神経耐性***を獲得する", "ResNerve element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 9 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("混沌耐性***を獲得する", "ResChaos element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 10 ) {
				list(0, listmax) = -2
				listmax++
				s = lang("魔法耐性**を獲得する", "ResMagic element add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 0 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("火炎属性追加ダメージ***を獲得する", "Fire element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 1 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("冷気属性追加ダメージ***を獲得する", "Cold element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 2 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("電撃属性追加ダメージ***を獲得する", "Lightning element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 3 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("暗黒属性追加ダメージ***を獲得する", "Darkness element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 4 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("幻惑属性追加ダメージ***を獲得する", "Mind element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 5 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("毒属性追加ダメージ***を獲得する", "Poison element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 6 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("地獄属性追加ダメージ***を獲得する", "Nether element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 7 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("音属性追加ダメージ***を獲得する", "Sound element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 8 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("神経属性追加ダメージ***を獲得する", "Nerve element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 9 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("混沌属性追加ダメージ***を獲得する", "Chaos element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 11 == 10 ) {
				list(0, listmax) = -3
				listmax++
				s = lang("魔法属性追加ダメージ***を獲得する", "Magic element damage add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 0 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("筋力11上昇を獲得する", "STR add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 1 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("耐久11上昇を獲得する", "END add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 2 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("器用11上昇を獲得する", "DEX add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 3 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("感覚11上昇を獲得する", "PER add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 4 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("習得11上昇を獲得する", "LER add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 5 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("意志11上昇を獲得する", "WIL add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 6 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("魔力11上昇を獲得する", "MAG add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 7 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("魅力11上昇を獲得する", "CHR add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 8 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("速度11上昇を獲得する", "SPD add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 9 ) {
				list(0, listmax) = -4
				listmax++
				s = lang("運勢11上昇を獲得する", "LUC add 11")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 0 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("心眼スキル上昇***を獲得する", "Critical skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 1 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("詠唱スキル上昇***を獲得する", "Casting skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 2 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("二刀流スキル上昇***を獲得する", "TwoWield skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 3 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("両手持ちスキル上昇***を獲得する", "TwoHand skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 4 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("戦術スキル上昇***を獲得する", "Tactics skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 5 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("射撃スキル上昇***を獲得する", "Marksman skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 6 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("治癒スキル上昇***を獲得する", "Healing skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 7 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("瞑想スキル上昇***を獲得する", "Meditation skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 8 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("魔道具スキル上昇***を獲得する", "MagicDevice skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 10 == 9 ) {
				list(0, listmax) = -5
				listmax++
				s = lang("魔力制御スキル上昇***を獲得する", "MagicControl skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 0 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("盾スキル上昇***を獲得する", "Shield skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 1 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("回避スキル上昇***を獲得する", "Evade skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 2 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("罠の知識スキル上昇***を獲得する", "DisarmTrap skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 3 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("重装備スキル上昇***を獲得する", "HeavyArmor skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 4 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("中装備スキル上昇***を獲得する", "MediumArmor skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 5 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("軽装備スキル上昇***を獲得する", "LightArmor skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 6 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("隠密スキル上昇***を獲得する", "Stealth skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 7 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("見切りスキル上昇***を獲得する", "EvadePlus skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 9 == 8 ) {
				list(0, listmax) = -9
				listmax++
				s = lang("魔力の限界スキル上昇***を獲得する", "MagicCapacity skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 0 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("採掘スキル上昇***を獲得する", "Mining skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 1 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("工作スキル上昇***を獲得する", "Carpentry skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 2 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("裁縫スキル上昇***を獲得する", "Tailor skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 3 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("宝石細工スキル上昇***を獲得する", "Jeweller skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 4 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("栽培スキル上昇***を獲得する", "Gardening skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 5 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("料理スキル上昇***を獲得する", "Cooking skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 6 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("解剖学スキル上昇***を獲得する", "Anatomy skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 7 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("釣りスキル上昇***を獲得する", "Fishing skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 8 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("錬金術スキル上昇***を獲得する", "Alchemy skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 9 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("鍵開けスキル上昇***を獲得する", "OpenLock skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 10 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("探知スキル上昇***を獲得する", "Detection skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 11 ) {
				list(0, listmax) = -8
				listmax++
				s = lang("自然鑑定スキル上昇***を獲得する", "SenseQuality skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 0 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("重量挙げスキル上昇***を獲得する", "WeightLifting skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 1 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("窃盗スキル上昇***を獲得する", "Pickpocket skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 2 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("着衣水泳スキル上昇***を獲得する", "Swimming skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 3 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("読書スキル上昇***を獲得する", "Literacy skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 4 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("生化学スキル上昇***を獲得する", "Gene skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 5 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("暗記スキル上昇***を獲得する", "Memorize skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 6 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("信仰スキル上昇***を獲得する", "Prayer skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 7 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("交渉スキル上昇***を獲得する", "Trade skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 8 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("投資スキル上昇***を獲得する", "Invest skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 9 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("演奏スキル上昇***を獲得する", "Perform skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 10 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("乗馬スキル上昇***を獲得する", "Riding skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 12 == 11 ) {
				list(0, listmax) = -6
				listmax++
				s = lang("旅歩きスキル上昇***を獲得する", "Travel skill add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 0 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("対神**を獲得する", "encGodBane add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 1 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("対不死者***を獲得する", "encUndeadBane add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 2 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("対竜***を獲得する", "encDragonBane add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 3 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("クリティカル上昇***を獲得する", "encCrit add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 4 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("魔法威力上昇**を獲得する", "encPowerMagic add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 5 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("放射威力上昇***を獲得する", "encPowerBreath add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			if ( taisei \ 7 == 6 ) {
				list(0, listmax) = -7
				listmax++
				s = lang("完全貫通発生**を獲得する", "encVopal add")
				promptl(0, promptmax) = s, "null", "" + promptmax
				promptmax++
			}
			val = promptx, prompty, 400, 1
			gosub *prompt_key
			txtnew
			if ( rtval == (-1) ) {
				txt lang(itemname(ci) + "は不満そうに震えた。", itemname(ci) + " vibrates as if she is displeased.")
				taiseip = 0
				taisei = 0
			}
			else {
				if ( list(0, rtval) == (-1) ) {
					inv(INV_ITEM_LEVEL, ci) += 4
				}
				if ( list(0, rtval) == (-2) ) {
					taiseip = taisei \ 11
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_FIRE, 200, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_COLD, 200, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_LIGHTNING, 200, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_DARKNESS, 200, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_MIND, 200, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_POISON, 200, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_NETHER, 200, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_SOUND, 200, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_NERVE, 200, 0, 1
					}
					if ( taiseip == 9 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_CHAOS, 200, 0, 1
					}
					if ( taiseip == 10 ) {
						encadd ci, ENCHANT_RESISTANCE * EXT_ENCHANTMENT + SKILL_RES_MAGIC, 100, 0, 1
					}
				}
				if ( list(0, rtval) == (-3) ) {
					taiseip = taisei \ 11
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_FIRE, 200, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_COLD, 200, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_LIGHTNING, 200, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_DARKNESS, 200, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_MIND, 200, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_POISON, 200, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_NETHER, 200, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_SOUND, 200, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_NERVE, 200, 0, 1
					}
					if ( taiseip == 9 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_CHAOS, 200, 0, 1
					}
					if ( taiseip == 10 ) {
						encadd ci, ENCHANT_ELEMENTAL_DMG * EXT_ENCHANTMENT + SKILL_RES_MAGIC, 200, 0, 1
					}
				}
				if ( list(0, rtval) == (-4) ) {
					taiseip = taisei \ 10
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_STR, 500, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_CON, 500, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_DEX, 500, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_PER, 500, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_LER, 500, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_WIL, 500, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_MAG, 500, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_CHA, 500, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_SPD, 500, 0, 1
					}
					if ( taiseip == 9 ) {
						encadd ci, ENCHANT_ATTRIBUTE * EXT_ENCHANTMENT + SKILL_ATTR_LUC, 500, 0, 1
					}
				}
				if ( list(0, rtval) == (-5) ) {
					taiseip = taisei \ 10
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_EYE_OF_MIND, 450, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_CASTING, 450, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_DUAL_WIELD, 450, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_TWO_HAND, 450, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_TACTICS, 450, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MARKSMAN, 450, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_HEALING, 450, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MEDITATION, 450, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MAGIC_DEVICE, 450, 0, 1
					}
					if ( taiseip == 9 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_CONTROL_MAGIC, 450, 0, 1
					}
				}
				if ( list(0, rtval) == (-6) ) {
					taiseip = taisei \ 12
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_WEIGHT_LIFTING, 450, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_ACTIVE_PICKPOCKET, 450, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_SWIMMING, 450, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_LITERACY, 450, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_GENE_ENGINEER, 450, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MEMORIZATION, 450, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_FAITH, 450, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_NEGOTIATION, 450, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_INVESTING, 450, 0, 1
					}
					if ( taiseip == 9 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_PERFORMER, 450, 0, 1
					}
					if ( taiseip == 10 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_ACTIVE_RIDING, 450, 0, 1
					}
					if ( taiseip == 11 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_TRAVELING, 450, 0, 1
					}
				}
				if ( list(0, rtval) == (-9) ) {
					taiseip = taisei \ 9
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_SHIELD, 450, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_EVASION, 450, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_DISARM_TRAP, 450, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_HEAVY_ARMOR, 450, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MEDIUM_ARMOR, 450, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_LIGHT_ARMOR, 450, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_STEALTH, 450, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_GREATER_EVASION, 450, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MAGIC_CAPACITY, 450, 0, 1
					}
				}
				if ( list(0, rtval) == (-8) ) {
					taiseip = taisei \ 12
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_MINING, 450, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_CARPENTRY, 450, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_TAILORING, 450, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_JEWELER, 450, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_GARDENING, 450, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_COOKING, 450, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_ANATOMY, 450, 0, 1
					}
					if ( taiseip == 7 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_FISHING, 450, 0, 1
					}
					if ( taiseip == 8 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_ALCHEMY, 450, 0, 1
					}
					if ( taiseip == 9 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_LOCK_PICKING, 450, 0, 1
					}
					if ( taiseip == 10 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_DETECTION, 450, 0, 1
					}
					if ( taiseip == 11 ) {
						encadd ci, ENCHANT_SKILL * EXT_ENCHANTMENT + SKILL_NORMAL_SENSE_QUALITY, 450, 0, 1
					}
				}
				if ( list(0, rtval) == (-7) ) {
					taiseip = taisei \ 7
					if ( taiseip == 0 ) {
						encadd ci, ENCHANT_BANE_GOD, 80, 0, 1
					}
					if ( taiseip == 1 ) {
						encadd ci, ENCHANT_BANE_UNDEAD, 130, 0, 1
					}
					if ( taiseip == 2 ) {
						encadd ci, ENCHANT_BANE_DRAGON, 130, 0, 1
					}
					if ( taiseip == 3 ) {
						encadd ci, ENCHANT_CRIT_CHANCE, 130, 0, 1, 0, 1
					}
					if ( taiseip == 4 ) {
						encadd ci, ENCHANT_ENHANCE_SPELL, 80, 0, 1, 0, 1
					}
					if ( taiseip == 5 ) {
						encadd ci, ENCHANT_ENHANCE_BREATH, 130, 0, 1, 0, 1
					}
					if ( taiseip == 6 ) {
						encadd ci, ENCHANT_PIERCING_CHANCE, 80, 0, 1, 0, 1
					}
				}
				txtef COLOR_GREEN
				txt lang(itemname(ci) + "は嬉しげに震えた。", itemname(ci) + " vibrates as if she is pleased.")
				randomize inv(INV_ITEM_SUB_NAME, ci)
				exrand_randomize inv(INV_ITEM_SUB_NAME, ci)
				if ( inv(INV_ITEM_PARAM1, ci) >= 10 ) {
					txt lang("その力は次第に脅威になっている。", "Its power is becoming a threat.")
					encadd ci, ENCHANT_SUCK_BLOOD, 50
					if ( stat == 0 ) {
						inv(40 + (15 - 1) * 2, ci) = 0
						txt lang(itemname(ci) + "はエンチャントを消した。", itemname(ci) + " removes an enchantment.")
						encadd ci, ENCHANT_SUCK_BLOOD, 50
						if ( stat == 0 ) {
							inv(40 + (15 - 2) * 2, ci) = 0
							txt lang(itemname(ci) + "はさらにエンチャントを消した。", itemname(ci) + " removes an enchantment.")
						}
					}
				}
				inv(INV_ITEM_PARAM2, ci) = 0
				inv(INV_ITEM_PARAM1, ci)++
			}
		}
		taiseip = 0
		taisei = 0
		r1 = cc
		gosub *charaRefresh
		gosub *screen_draw
		goto *pc_turn
	}
	_switch_val = inv(INV_ITEM_EFFECT, ci)
	if ( 0 ) {
		_switch_sw++
	}
	if ( _switch_val == 24 | _switch_sw ) {
		_switch_sw = 0
		x = cdata(CDATA_X, cc)
		y = cdata(CDATA_Y, cc)
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			txt lang("ここでは使えない。", "You can't place it here.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( map(x, y, MAP_FEATS_ON_TILE) != 0 ) {
			txt lang("ここには置けない。", "You can't place it here.")
			goto *pc_turn
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		cell_featset x, y, 0, CELL_FEATURE_TRAP, CELL_SUB_FEATURE_TRAP_MINE, cc
		txt lang("地雷を設置した。", "You set up the mine.")
		snd SOUNDLIST_BUILD1
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 44 | _switch_sw ) {
		_switch_sw = 0
		if ( inv_getowner(ci) != (-1) ) {
			txt lang("床に置かないと使えない。", "You need to put it on the ground.")
			gosub *screen_draw
			goto *pc_turn
		}
		txt lang("あなたは" + itemname(ci, 1) + "に座った。", "You sit on " + itemname(ci, 1) + ".")
		promptl(0, promptmax) = lang("くつろぐ", "Relax."), "null", "" + 0
		promptmax++
		if ( inv(INV_ITEM_PARAM1, ci) != 1 ) {
			promptl(0, promptmax) = lang("マイチェアにする", "It's my chair."), "null", "" + 1
			promptmax++
		}
		if ( inv(INV_ITEM_PARAM1, ci) != 2 ) {
			promptl(0, promptmax) = lang("お客用のチェアにする", "It's for my guest."), "null", "" + 2
			promptmax++
		}
		if ( inv(INV_ITEM_PARAM1, ci) != 0 ) {
			promptl(0, promptmax) = lang("誰でも座っていい", "It's free to use."), "null", "" + 3
			promptmax++
		}
		val = promptx, prompty, 260, 1
		gosub *prompt_key
		if ( stat == 0 ) {
			goto *act_use_SWEND1
		}
		if ( rtval == 0 ) {
			txt lang("あなたは存分にくつろいだ。", "You relax as much as you like.")
			goto *act_use_SWEND1
		}
		if ( rtval == 1 ) {
			txt lang(itemname(ci, 1) + "はあなた専用の席になった！", itemname(ci, 1) + " is your seat now.")
			inv(INV_ITEM_PARAM1, ci) = 1
			goto *act_use_SWEND1
		}
		if ( rtval == 2 ) {
			txt lang(itemname(ci, 1) + "は訪問者の席になった！", itemname(ci, 1) + " is used by your guests now.")
			inv(INV_ITEM_PARAM1, ci) = 2
			goto *act_use_SWEND1
		}
		if ( rtval == 3 ) {
			txt lang(itemname(ci, 1) + "は誰でも座っていい席になった！", itemname(ci, 1) + " can be used by anyone.")
			inv(INV_ITEM_PARAM1, ci) = 0
			goto *act_use_SWEND1
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 8 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) != MAP_TYPE_HOME ) {
			txt lang("それはここでは使えない。", "You can't use it here.")
			gosub *screen_draw
			goto *pc_turn
		}
		screenupdate = -1
		gosub *screen_draw
		goto *com_home
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 19 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰を対象にする？", "Make up who?")
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc < MAX_CHARA_FOLLOWER ) {
					screenupdate = -1
					gosub *screen_draw
					ccbk = cc
					cc = tc
					gosub *com_mirror
					cc = ccbk
					f = 1
				}
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		gosub *screen_draw
		goto *pc_turn
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 104 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		txt lang("誰に使用させる？", "Who is user?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		if ( stat == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
			tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
		}
		else {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
			txtselecttc 2
			repeat 2
				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
				promptmax++
			loop
			val = promptx, prompty, 200, 0
			gosub *prompt_key
			if ( rtval == 1 ) {
				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
			}
		}
		if ( tc >= MAX_CHARA_FOLLOWER ) {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		snd SOUNDLIST_AMMO
		await 200
		snd SOUNDLIST_AMMO
		await 200
		snd SOUNDLIST_AMMO
		await 200
		snd SOUNDLIST_AMMO
		await 200
		addbuff tc, BUFF_SHOOTING_MODE, 25, 25
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 85 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		txt lang("誰に使用させる？", "Who is user?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		if ( stat == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
			tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
		}
		else {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
			txtselecttc 2
			repeat 2
				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
				promptmax++
			loop
			val = promptx, prompty, 200, 0
			gosub *prompt_key
			if ( rtval == 1 ) {
				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
			}
		}
		snd SOUNDLIST_ENC
		txtef COLOR_PURPLE
		txt lang("《汝等ノ求メルエレメントヲ叫ベ》", "< Shout the attribute you want >")
		txtseteyes 12
		repeat 12
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 160, 0
		gosub *prompt_key
		if ( rtval == 0 ) {
			txtef COLOR_PURPLE
			txt lang("《ソウカ…》", "< Oh... >")
			cdata(CDATA_ELEMENTS_EYES_ELE, tc) = 0
			goto *act_use_SWEND1
		}
		cdata(CDATA_ELEMENTS_EYES_ELE, tc) = rtval
		cdata(CDATA_ATTRIBUTE_ELE, tc) = cdata(CDATA_ELEMENTS_EYES_ELE, tc) - 1
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 11 ) {
			txtef COLOR_PURPLE
			txt lang("《 Magic 》", "< Magic >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 1 ) {
			txtef COLOR_PURPLE
			txt lang("《 Fire 》", "< Fire >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 2 ) {
			txtef COLOR_PURPLE
			txt lang("《 Cold 》", "< Cold >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 3 ) {
			txtef COLOR_PURPLE
			txt lang("《 Lightning 》", "< Lightning >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 4 ) {
			txtef COLOR_PURPLE
			txt lang("《 Darkness 》", "< Darkness >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 5 ) {
			txtef COLOR_PURPLE
			txt lang("《 Mind 》", "< Mind >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 6 ) {
			txtef COLOR_PURPLE
			txt lang("《 Poison 》", "< Poison >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 7 ) {
			txtef COLOR_PURPLE
			txt lang("《 Nether 》", "< Nether >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 8 ) {
			txtef COLOR_PURPLE
			txt lang("《 Sound 》", "< Sound >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 9 ) {
			txtef COLOR_PURPLE
			txt lang("《 Nerve 》", "< Nerve >")
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 10 ) {
			txtef COLOR_PURPLE
			txt lang("《 Chaos 》", "< Chaos >")
		}
		snd SOUNDLIST_SONIC
		txt lang(name(tc) + "の属性が変わった。", name(tc) + " changed own elemet.")
		snd SOUNDLIST_SONIC
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 11 ) {
			animeload 11, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 1 ) {
			animeload 20, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 2 ) {
			animeload 19, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 3 ) {
			animeload 18, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 4 ) {
			animeload 21, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 5 ) {
			animeload 23, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 6 ) {
			animeload 27, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 7 ) {
			animeload 22, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 8 ) {
			animeload 24, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 9 ) {
			animeload 26, tc
		}
		if ( cdata(CDATA_ELEMENTS_EYES_ELE, tc) == 10 ) {
			animeload 25, tc
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == effpipe | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		txt lang("誰に使わせる？", "Who is user?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		if ( stat == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
			tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
		}
		else {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
			txtselecttc 2
			repeat 2
				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
				promptmax++
			loop
			val = promptx, prompty, 200, 0
			gosub *prompt_key
			if ( rtval == 1 ) {
				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
			}
		}
		if ( tc != CHARA_PLAYER & cdata(CDATA_DRUG_DEPENDENCE, tc) < 100 & cdata(CDATA_MASTER_SERVANT, tc) < 200 ) {
			txt lang("「駄目。絶対」", cnvtalk("Stop the drug!"))
			snd SOUNDLIST_FAIL1
			goto *act_use_SWEND1
		}
		item_separate ci
		txt lang(name(tc) + "は" + itemname(ci) + "を咥えた。", name(cc) + " smoke" + _s(tc) + " " + itemname(ci) + ".")
		repeat 8 + 8
			if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_NONE ) {
				break
			}
			if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_MELANCHOLY ) {
				delbuff tc, cnt
				continue cnt
			}
		loop
		snd SOUNDLIST_FIRE1
		if ( cdata(CDATA_DRUG_DEPENDENCE, tc) <= 0 ) {
			txt lang(" *げほげほ* ", "*cough*")
		}
		else {
			txt lang(" *スパー* ", "*puff*")
		}
		cdata(CDATA_POWER_GAUGE, tc) += 100
		if ( cdata(CDATA_POWER_GAUGE, tc) > 100 ) {
			if ( cdata(CDATA_SHIFT_FORM, tc) <= SHIFT_FORM_NONE & (cdata(CDATA_EVOLUTION_STAGE, tc) <= 0 | tc == CHARA_PLAYER) & (cdata(CDATA_QUALITY, tc) < FIX_QUALITY_MIRACLE | tc <= MAX_CHARA_FOLLOWER) ) {
				cdata(CDATA_POWER_GAUGE, tc) = 100
			}
		}
		if ( cdata(CDATA_POWER_GAUGE, tc) > 200 ) {
			cdata(CDATA_POWER_GAUGE, tc) = 200
		}
		cdata(CDATA_DRUG_DEPENDENCE, tc) += 30
		toba = limit(cdata(CDATA_DRUG_DEPENDENCE, tc) / 3, 1, 100)
		txt lang(name(tc) + "は麻薬に" + toba + "％依存している。", name(tc) + " is dependent on " + toba + "% to drug.")
		modkarma 0, -10
		if ( cdata(CDATA_DRUG_DEPENDENCE, tc) > 300 ) {
			cdata(CDATA_DRUG_DEPENDENCE, tc) = 300
		}
		if ( cdata(CDATA_DRUG_DEPENDENCE, tc) < 0 ) {
			cdata(CDATA_DRUG_DEPENDENCE, tc) = 0
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		gosub *calcBurdenPc
		toba = 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 89 | _switch_sw ) {
		_switch_sw = 0
		_switch_sw++
	}
	if ( _switch_val == 86 | _switch_sw ) {
		_switch_sw = 0
		_switch_sw++
	}
	if ( _switch_val == 87 | _switch_sw ) {
		_switch_sw = 0
		_switch_sw++
	}
	if ( _switch_val == 88 | _switch_sw ) {
		_switch_sw = 0
		_switch_sw++
	}
	if ( _switch_val == 90 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		txt lang("誰に使わせる？", "Who is user?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		if ( stat == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
			tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
		}
		else {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
			txtselecttc 2
			repeat 2
				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
				promptmax++
			loop
			val = promptx, prompty, 200, 0
			gosub *prompt_key
			if ( rtval == 1 ) {
				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
			}
		}
		if ( tc >= MAX_CHARA_FOLLOWER ) {
			txt lang("「いらん」", cnvtalk("No way."))
			snd SOUNDLIST_FAIL1
			goto *act_use_SWEND1
		}
		item_separate ci
		txt lang(name(tc) + "は" + itemname(ci) + "を咥えた。", name(cc) + " smoke" + _s(tc) + " " + itemname(ci) + ".")
		repeat 8 + 8
			if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_NONE ) {
				break
			}
			if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_DISTRACTED ) {
				delbuff tc, cnt
				continue cnt
			}
		loop
		if ( inv(INV_ITEM_ID, ci) != ITEM_ID_TOBACCO ) {
			snd SOUNDLIST_FIRE1
			if ( cdata(CDATA_TOBACCO_DEPENDENCE, tc) <= 0 ) {
				txt lang(" *げほげほ* ", "*cough*")
			}
			else {
				txt lang(" *スパー* ", "*puff*")
			}
			addbuff tc, BUFF_CONCENTRATION, (10 + inv(INV_ITEM_LEVEL, ci)) * sorg(SKILL_ATTR_PER, tc) / 2, (10 + inv(INV_ITEM_LEVEL, ci)) * 20
			cdata(CDATA_TOBACCO_DEPENDENCE, tc) += 20
			toba = limit(cdata(CDATA_TOBACCO_DEPENDENCE, tc) / 2, 1, 100)
			txt lang(name(tc) + "はタバコに" + toba + "％依存している。", name(tc) + " is dependent on " + toba + "% to tobacco.")
			if ( cdata(CDATA_HUNGER, tc) < 10000 ) {
				cdata(CDATA_HUNGER, tc) += 1000
			}
			if ( tc == CHARA_PLAYER ) {
				gdata(GDATA_FLAG_SLEEP_PREVENTION) += 3 + rnd(3)
				gdata(GDATA_FLAG_SMOKING_FREQUENCY)++
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CIGARETTE ) {
					skillexp SKILL_ATTR_PER, tc, 3000 + inv(INV_ITEM_LEVEL, ci) * 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HAMAKI ) {
					skillexp SKILL_ATTR_DEX, tc, 3000 + inv(INV_ITEM_LEVEL, ci) * 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOBACCO_PIPE ) {
					skillexp SKILL_ATTR_LER, tc, 3000 + inv(INV_ITEM_LEVEL, ci) * 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_KISERU ) {
					skillexp SKILL_ATTR_CHA, tc, 3000 + inv(INV_ITEM_LEVEL, ci) * 200
				}
			}
			else {
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CIGARETTE ) {
					skillexp SKILL_ATTR_PER, tc, 15000 + inv(INV_ITEM_LEVEL, ci) * 1000
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_HAMAKI ) {
					skillexp SKILL_ATTR_DEX, tc, 15000 + inv(INV_ITEM_LEVEL, ci) * 1000
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_TOBACCO_PIPE ) {
					skillexp SKILL_ATTR_LER, tc, 15000 + inv(INV_ITEM_LEVEL, ci) * 1000
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_KISERU ) {
					skillexp SKILL_ATTR_CHA, tc, 15000 + inv(INV_ITEM_LEVEL, ci) * 1000
				}
			}
		}
		else {
			txt lang(" *むしゃむしゃ* ", "*chomp*")
			snd SOUNDLIST_EAT1
			if ( inv(INV_ITEM_LEVEL, ci) > 10 ) {
				cdata(CDATA_TOBACCO_DEPENDENCE, tc) -= inv(INV_ITEM_LEVEL, ci) - 10
			}
		}
		if ( cdata(CDATA_TOBACCO_DEPENDENCE, tc) > 200 ) {
			cdata(CDATA_TOBACCO_DEPENDENCE, tc) = 200
		}
		if ( cdata(CDATA_TOBACCO_DEPENDENCE, tc) < 0 ) {
			cdata(CDATA_TOBACCO_DEPENDENCE, tc) = 0
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		gosub *calcBurdenPc
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CIGARETTE ) {
			flt
			itemcreate -1, ITEM_ID_SUIGARA, cdata(CDATA_X, tc), cdata(CDATA_Y, tc), 0
		}
		toba = 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 92 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_BOLT1
		snd SOUNDLIST_SHOTS
		await 1000
		animeid = ANIMATION_FIREWORK
		gosub *anime
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 84 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		gosub *findLocation
		if ( stat != 1 ) {
			if ( stat == 0 ) {
				txt lang("その場所は見えない。", "You can't see the location.")
				gosub *screen_draw
			}
			goto *pc_turn
		}
		if ( chipm(CHIPM_ATTRIB, map(tlocx, tlocy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS ) {
			txt lang("そこには撃てない。", "The location is blocked.")
			gosub *screen_draw
			goto *pc_turn
		}
		animeid = ANIMATION_NUCLEAR
		gosub *anime
		inv(INV_ITEM_NUM, ci)--
		gosub *calcBurdenPc
		repeat 40
			if ( cnt == 14 ) {
				snd SOUNDLIST_ATK_FIRE
			}
			await cfg_animewait + 20
		loop
		gdata(GDATA_FLAG_NUCLEAR_EXPLOSIONS)++
		range = 6
		ele = SKILL_RES_CHAOS
		aniref = range
		animeid = ANIMATION_BALL_NUKE
		anix = tlocx
		aniy = tlocy
		gosub *anime
		gosub *screen_draw
		repeat range * 2 + 1
			dy = tlocy - range + cnt
			if ( dy < 0 | dy >= mdata(MDATA_HEIGHT) ) {
				continue
			}
			repeat range * 2 + 1
				dx = tlocx - range + cnt
				if ( dx < 0 | dx >= mdata(MDATA_WIDTH) ) {
					continue
				}
				if ( dist(tlocx, tlocy, dx, dy) > range ) {
					continue
				}
				f = 0
				if ( map(dx, dy, MAP_TILE_ID) != xy2pic(8, 21) & map(dx, dy, MAP_TILE_ID) != xy2pic(11, 20) ) {
					map(dx, dy, MAP_TILE_ID) = xy2pic(4, 1)
				}
				if ( map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
					tc = map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) - 1
					if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
						if ( tc != CHARA_PLAYER ) {
							if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
								tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
							}
							txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
						}
					}
					dmg = 1000 + (sdata(SKILL_NORMAL_CARPENTRY, CHARA_PLAYER) + 50) / 5 * limit(sdata(SKILL_NORMAL_DISARM_TRAP, CHARA_PLAYER) + 50, 50, 1000) + sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER) / 40 * sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER)
					dmghp tc, dmg, cc
				}
				mapitem_fire dx, dy
			loop
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 82 | _switch_sw ) {
		_switch_sw = 0
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)++
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		if ( cdata(CDATA_TARGET, cc) == 0 ) {
			gosub *findTarget
			if ( stat == 0 ) {
				goto *act_use_SWEND1
			}
		}
		tc = cdata(CDATA_TARGET, cc)
		if ( dist(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), cdata(CDATA_X, cc), cdata(CDATA_Y, cc)) > 6 | fov_los(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), cdata(CDATA_X, cc), cdata(CDATA_Y, cc)) == 0 ) {
			if ( cc == CHARA_PLAYER ) {
				msgdup++
				txt lang("範囲外だ。", "It's out of range.")
			}
			goto *act_use_SWEND1
		}
		if ( cdata(CDATA_RELATION, tc) >= RELATION_NEUTRAL ) {
			gosub *com_confirmAttack
			if ( stat == 0 ) {
				goto *act_use_SWEND1
			}
		}
		tlocx = cdata(CDATA_X, tc)
		tlocy = cdata(CDATA_Y, tc)
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)--
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) < 0 ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 0
		}
		item_stack CHARA_PLAYER, ci, 1
		animeid = ANIMATION_NUCLEAR
		gosub *anime
		aniref = 0
		animeid = ANIMATION_BALL
		anix = cdata(CDATA_X, tc)
		aniy = cdata(CDATA_Y, tc)
		gosub *anime
		cdata(CDATA_PROT_PENALTY, tc) = 3
		dmg = rnd(50) + sdata(SKILL_ATTR_PER, CHARA_PLAYER) * 2 + sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER) / 40 * sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER)
		if ( dmg < 0 ) {
			dmg = 5
		}
		dmghp tc, dmg, cc
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 83 | _switch_sw ) {
		_switch_sw = 0
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)++
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			goto *act_use_SWEND1
		}
		gosub *findLocation
		if ( stat != 1 ) {
			if ( stat == 0 ) {
				txt lang("その場所は見えない。", "You can't see the location.")
				gosub *screen_draw
			}
			goto *pc_turn
		}
		if ( chipm(CHIPM_ATTRIB, map(tlocx, tlocy, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS ) {
			txt lang("そこには撃てない。", "The location is blocked.")
			gosub *screen_draw
			goto *pc_turn
		}
		animeid = ANIMATION_NUCLEAR
		gosub *anime
		aniref = 1
		animeid = ANIMATION_BALL_NUKE
		anix = tlocx
		aniy = tlocy
		gosub *anime
		gosub *screen_draw
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci)--
		if ( inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) < 0 ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 0
		}
		item_stack CHARA_PLAYER, ci, 1
		efp = limit(sdata(SKILL_RES_FIRE, CHARA_PLAYER) * 2, 1, 5000) + sqrt(sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER) + 1) * sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER) * 2 + sdata(SKILL_ATTR_CON, CHARA_PLAYER) * 10
		p = 4, 2 + efp / 50
		snd SOUNDLIST_ATK_FIRE
		repeat 800
			x = rnd(p) + tlocx - rnd(p)
			y = rnd(p) + tlocy - rnd(p)
			f = 1
			if ( x < 0 | y < 0 | x >= mdata(MDATA_WIDTH) | y >= mdata(MDATA_HEIGHT) ) {
				f = 0
			}
			else {
				if ( chipm(CHIPM_ATTRIB, map(x, y, MAP_TILE_ID)) & CHIPM_ATTRIB_CANT_PASS ) {
					f = 0
				}
			}
			if ( dist(tlocx, tlocy, x, y) >= p ) {
				f = 0
			}
			if ( f == 0 ) {
				continue cnt
			}
			tcbk = tc
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cc != tc ) {
					if ( gdata(GDATA_RIDER) != 0 ) {
						if ( gdata(GDATA_RIDER) == cc ) {
							if ( tc == CHARA_PLAYER ) {
								continue
							}
						}
					}
					if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
						if ( tc != CHARA_PLAYER ) {
							if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
								tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
							}
						}
					}
					cdata(CDATA_ENVIRONMENT_EFFECT, tc) = ENVIRONMENT_EFFECT_FIRE2
				}
			}
			tc = tcbk
			addmef x, y, MEF_TYPE_FIRE, xy2pic(24, 0), rnd(30) + 30, efp, cc
			mapitem_fire x, y
		loop
		repeat 245
			if ( cdata(CDATA_ENVIRONMENT_EFFECT, cnt) == ENVIRONMENT_EFFECT_NONE ) {
				continue
			}
			if ( cdata(CDATA_ENVIRONMENT_EFFECT, cnt) == ENVIRONMENT_EFFECT_FIRE2 ) {
				txt lang(name(cnt) + "は炎に包まれた。", name(cnt) + " was surrounded by flames.")
				cdata(CDATA_ENVIRONMENT_EFFECT, cnt) = ENVIRONMENT_EFFECT_NONE
				hostileaction cc, cnt
				dmghp cnt, rnd(efp / 10 + 1) + efp / 2 + 1, DAMAGE_FROM_FIRE, SKILL_RES_FIRE, efp
				addbuff cnt, BUFF_ELEMENT_SCAR, 500, 5
			}
			cdata(CDATA_ENVIRONMENT_EFFECT, cnt) = ENVIRONMENT_EFFECT_NONE
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 105 | _switch_sw ) {
		_switch_sw = 0
		txt lang("火を起こした。", "You made a fire.")
		snd SOUNDLIST_FIRE1
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		gosub *calcBurdenPc
		flt
		itemcreate -1, ITEM_ID_CAMPFIRE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 78 | _switch_sw ) {
		_switch_sw = 0
		invsubroutine = 1
		invctrl = 0
		snd SOUNDLIST_INV
		gosub *com_inventory
		if ( stat == 0 ) {
			goto *act_use_SWEND1
		}
		snd SOUNDLIST_BOLT1
		item_separate ci
		inv(INV_ITEM_SUB_NAME, ci) = inv(INV_ITEM_ID, ci)
		inv(INV_ITEM_PARAM2, ci) = 0
		inv(INV_ITEM_ID, ci) = ITEM_ID_JUICE
		inv(INV_ITEM_LEVEL, ci) = 0
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		inv(INV_ITEM_PIC, ci) = xy2pic(19, 30)
		inv(INV_ITEM_WEIGHT, ci) = 100
		inv(INV_ITEM_MATERIAL, ci) = ITEM_MATERIAL_SAND
		inv(INV_ITEM_PARAM3, ci) = 0
		txt lang(itemname(ci) + "を作った。", "You made " + itemname(ci) + ".")
		item_stack CHARA_PLAYER, ci, 1
		gosub *calcBurdenPc
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 15 | _switch_sw ) {
		_switch_sw = 0
		efid = SKILL_NORMAL_COOKING
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 16 | _switch_sw ) {
		_switch_sw = 0
		efid = SKILL_NORMAL_FISHING
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 17 | _switch_sw ) {
		_switch_sw = 0
		if ( cdata(CDATA_ROW_ACT, cc) == ACTION_NONE ) {
			if ( synccheck(cc, -1) ) {
				txt lang(name(cc) + "は" + itemname(ci) + "の演奏をはじめた。", name(cc) + " start" + _s(cc) + " to play " + itemname(ci) + ".")
			}
		}
		efid = SKILL_NORMAL_PERFORMER
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 14 | _switch_sw ) {
		_switch_sw = 0
		if ( cc == CHARA_PLAYER ) {
			if ( inv(INV_ITEM_NUM, ci) < 5 ) {
				txt lang("雪が足りない…", "You need more snow.")
				gosub *screen_draw
				goto *pc_turn
			}
			removeitem ci, 5
		}
		flt
		itemcreate -1, ITEM_ID_SNOW_MAN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		if ( synccheck(cc, -1) ) {
			snd SOUNDLIST_SNOW
			txt lang(name(cc) + "は雪だるまを作った！", name(cc) + " make" + _s(cc) + " a snow man!")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 13 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_FIRE1
		if ( gdata(GDATA_LIGHT_SOURCE) == 0 ) {
			gdata(GDATA_LIGHT_SOURCE) = 1
			txt lang("松明を灯した。", "You light up the torch.")
		}
		else {
			gdata(GDATA_LIGHT_SOURCE) = 0
			txt lang("松明を消した。", "You put out the fire.")
		}
		r1 = 0
		gosub *charaRefresh
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 9 | _switch_sw ) {
		_switch_sw = 0
		gosub *com_train
		if ( stat == 1 ) {
			goto *turn_end
		}
		else {
			gosub *screen_draw
			goto *pc_turn
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 5 | _switch_sw ) {
		_switch_sw = 0
		txt lang("何に聴診器を当てる？", "Auscultate who?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		if ( stat == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
			tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
		}
		else {
			txt lang("それは無理だ。", "It's impossible.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
			txtselecttc 2
			repeat 2
				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
				promptmax++
			loop
			val = promptx, prompty, 200, 0
			gosub *prompt_key
			if ( rtval == 1 ) {
				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
			}
		}
		if ( tc == CHARA_PLAYER ) {
			txt lang(" *ドクン ドクン* ", "You blush.")
			gdata(GDATA_SCOPE) = 0
			goto *turn_end
		}
		if ( tc > CHARA_PLAYER & tc < MAX_CHARA_FOLLOWER ) {
			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
				gdata(GDATA_SCOPE) = 0
				if ( cbit(CHARA_BIT_STETHOSCOPE, tc) == TRUE ) {
					cbitmod CHARA_BIT_STETHOSCOPE, tc, FALSE
					txt lang(name(tc) + "から聴診器を外した。", "You no longer watch on " + his(tc) + " health.")
					goto *turn_end
				}
				txt lang("あなたは" + name(tc) + "に聴診器を当てた。", "You start to keep an eye on " + his(tc) + " health.")
				if ( cdata(CDATA_SEX, tc) == 1 ) {
					txt lang("" + name(tc) + "は顔を赤らめた。", name(tc) + " blush" + _s(tc, 1) + ".")
					txtmore
					txtef COLOR_BLUE
					txt lang("「キャー」", cnvtalk("Pervert!"))
				}
				cbitmod CHARA_BIT_STETHOSCOPE, tc, TRUE
				goto *turn_end
			}
		}
		txt lang("それは無理だ。", "It's impossible.")
		gosub *screen_draw
		goto *pc_turn
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 23 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰を紐で結ぶ？", "Leash who?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc == CHARA_PLAYER ) {
					txt lang("あなたは自分を紐でくくってみた…", "You leash yourself...")
				}
				else {
					if ( cbit(CHARA_BIT_LEASHED, tc) == FALSE ) {
						if ( tc >= MAX_CHARA_FOLLOWER ) {
							if ( rnd(5) == 0 ) {
								txt lang(name(tc) + "が激しく抵抗したため紐は切れた。", "The leash is cut as " + name(tc) + " resists.")
								inv(INV_ITEM_NUM, ci)--
								cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
								gosub *calcBurdenPc
								goto *act_use_SWEND1
							}
						}
						cbitmod CHARA_BIT_LEASHED, tc, TRUE
						txt lang("あなたは" + name(tc) + "を紐でくくりつけた。", "You leash " + name(tc) + ".")
						txtef COLOR_SKY_BLUE
						txt lang(name(tc) + "は呻き声を洩らした。「アン…♪」", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Pervert!"))
					}
					else {
						cbitmod CHARA_BIT_LEASHED, tc, FALSE
						txt lang("あなたは" + name(tc) + "にくくりつけた紐をほどいた。", "You unleash " + name(tc) + ".")
						txtef COLOR_SKY_BLUE
						txt lang(name(tc) + "は呻き声を洩らした。「はぁはぁ…」", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("D-don't sto....N-nothing!"))
					}
				}
				animeload 8, tc
				f = 1
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 45 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
			txt lang("このエリアでは使えない。", "You cant use it in this area.")
			gosub *screen_draw
			goto *pc_turn
		}
		txt lang("誰を吊るす？", "Hang who?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txt lang("タッグは吊るせない。", "It is possible to hang tag team.")
					goto *pc_turn
				}
				if ( cdata(CDATA_HP, tc) >= cdata(CDATA_MAX_HP, tc) / 5 ) {
					if ( 0 == 0 ) {
						txt lang("もっと弱らせないと吊るせない。", "The target needs to be weakened.")
						goto *pc_turn
					}
				}
				if ( tc != CHARA_PLAYER ) {
					if ( tc < MAX_CHARA_FOLLOWER ) {
						txt lang("仲間を吊るすなんてとんでもない！", "Hanging your ally is a brutal idea!")
						goto *pc_turn
					}
				}
				if ( cbit(CHARA_BIT_SANDBAG, tc) ) {
					txt lang("それは既に吊るされている。", "It's already hanged up.")
					goto *pc_turn
				}
				if ( tc == CHARA_PLAYER ) {
					txt lang("あなたは自分を吊るそうと思ったがやめた…", "You try to hang yourself but rethink...")
				}
				else {
					snd SOUNDLIST_BUILD1
					cbitmod CHARA_BIT_SANDBAG, tc, TRUE
					txt lang("あなたは" + name(tc) + "を吊るした。", "You hang up " + name(tc) + ".")
					txtvalid = 0
					txt lang(name(tc) + "は呻き声を洩らした。「アン…♪」", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Pervert!"))
					animeload 8, tc
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					gosub *calcBurdenPc
				}
				f = 1
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 66 | _switch_sw ) {
		_switch_sw = 0
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc == CHARA_PLAYER ) {
					txt lang("それは無理だ。", "It's impossible.")
					goto *pc_turn
				}
				if ( inv(INV_ITEM_PARAM1, ci) == 0 ) {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						txt lang("それは無理だ。", "It's impossible.")
						goto *act_use_SWEND1
					}
					if ( cdata(CDATA_IMPRESSION, tc) < 200 ) {
						txt lang(name(tc) + "はやんわりと断った。", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Pervert!"))
						goto *act_use_SWEND1
					}
					txt lang(name(tc) + "とあなたの間に、運命の糸が結ばれた。", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Pervert!"))
					snd SOUNDLIST_OFFER2
					inv(INV_ITEM_NUM, ci)--
					itemcreate -1, ITEM_ID_SOUL_SPINDLE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
					if ( stat ) {
						inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, tc)
						inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
					}
					inv(INV_ITEM_PARAM1, ci) = 100 + rnd(10000) + rnd(500) + rnd(2000)
					inv(INV_ITEM_PARAM2, ci) = 10000 + rnd(10000) + rnd(4000) + rnd(5000)
					cdata(CDATA_SPINDLE_COMBINATION_A, tc) = inv(INV_ITEM_PARAM1, ci)
					cdata(CDATA_SPINDLE_COMBINATION_B, tc) = inv(INV_ITEM_PARAM2, ci)
					if ( gdata(GDATA_SPINDLE_COMBINATION) == 0 ) {
						gdata(GDATA_SPINDLE_COMBINATION) = inv(INV_ITEM_PARAM2, ci) + inv(INV_ITEM_PARAM1, ci) + rnd(10)
					}
					inv(INV_ITEM_PARAM3, ci) = gdata(GDATA_SPINDLE_COMBINATION)
					if ( 0 ) {
						txt lang("糸１は" + cdata(CDATA_SPINDLE_COMBINATION_A, tc) + "２は" + cdata(CDATA_SPINDLE_COMBINATION_B, tc) + "、ＰＣは" + gdata(GDATA_SPINDLE_COMBINATION) + "だ。", "It's already hanged up.")
					}
					goto *act_use_SWEND1
				}
				if ( inv(INV_ITEM_PARAM1, ci) != 0 ) {
					if ( 0 ) {
						txt lang("糸１は" + cdata(CDATA_SPINDLE_COMBINATION_A, tc) + "２は" + cdata(CDATA_SPINDLE_COMBINATION_B, tc) + "、ＰＣは" + gdata(GDATA_SPINDLE_COMBINATION) + "だ。", "It's already hanged up.")
					}
					if ( 0 ) {
						txtef COLOR_RED
						txt lang("アイテムは" + inv(INV_ITEM_PARAM1, ci) + "２は" + inv(INV_ITEM_PARAM2, ci) + "、ＰＣは" + inv(INV_ITEM_PARAM3, ci) + "だ。", "It's already hanged up.")
					}
					if ( gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
						txt lang("それはもうショウルームでしか使えない。", "You can  use it only in the showroom anymore.")
						goto *act_use_SWEND1
					}
					if ( cdata(CDATA_SPINDLE_COMBINATION_A, tc) != inv(INV_ITEM_PARAM1, ci) | cdata(CDATA_SPINDLE_COMBINATION_B, tc) != inv(INV_ITEM_PARAM2, ci) ) {
						txt lang("組み合わせが違うようだ。", "Combination seems to be different.")
						goto *act_use_SWEND1
					}
					if ( inv(INV_ITEM_PARAM3, ci) == gdata(GDATA_SPINDLE_COMBINATION) ) {
						txt lang("まだ再会の時ではない。", "It is not the time of the reunion yet.")
						goto *act_use_SWEND1
					}
					f = get_freeally()
					if ( f == 0 ) {
						txt lang("仲間の最大数に達しているため、仲間にできない。", "Your party is already full. You can't invite someone anymore.")
						goto *act_use_SWEND1
					}
					inv(INV_ITEM_NUM, ci)--
					txt lang("全てを越えて、運命の糸が再び二人を結びつける…！", "Beyond all, red thread linking the two people again ....")
					msg_halt
					rincana = 100
					rc = tc
					gosub *add_ally
					rincana = 0
					music = MUSICLIST_MCWEDDING
					gosub *music_play
					txtef COLOR_GREEN
					txt lang("魂の再会はここに成された。", "Reunion of the soul has been made.")
				}
			}
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 93 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰に使う？", "Who is target?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_RELATION, tc) == RELATION_ALLY | tc == CHARA_PLAYER ) {
					txt lang("…さすがにやめておこう。", "...You changed your mind.")
					goto *act_use_SWEND1
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BOTTLE_SOY_SAUCE ) {
					snd SOUNDLIST_WATER2
					await 30
					snd SOUNDLIST_WATER2
					await 30
					snd SOUNDLIST_WATER2
					await 30
					snd SOUNDLIST_WATER2
					txtef COLOR_YELLOW
					txt lang("下ごしらえとして" + name(tc) + "に頭から醤油をかけた。「やめろ」", "You sprinkle the soy sauce to head of " + name(tc) + " as mise en place, " + cnvtalk("Stop..."))
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BOTTLE_PEPPER ) {
					snd SOUNDLIST_GET1
					await 400
					snd SOUNDLIST_GET1
					txtef COLOR_YELLOW
					txt lang("下ごしらえとして" + name(tc) + "にコショウをふりかけた。「は…はっくしょん！」", "You sprinkle the pepper to " + name(tc) + " as mise en place, " + cnvtalk("Achoo!"))
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SACK_SUGAR ) {
					snd SOUNDLIST_BUSH1
					txtef COLOR_YELLOW
					txt lang("下ごしらえとして" + name(tc) + "に砂糖をぶちまけた。「甘っ！！」", "You dusted the sugar to " + name(tc) + " as mise en place, " + cnvtalk("Sweet!"))
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BOTTLE_SALT ) {
					snd SOUNDLIST_GET2
					await 400
					snd SOUNDLIST_GET2
					txtef COLOR_YELLOW
					txt lang("下ごしらえとして" + name(tc) + "に塩をすり込んだ。…" + name(tc) + "はわけがわからないといった顔をしている。", "You rubbed into him the salt as mise en place..." + name(tc) + " is stumped.")
				}
				if ( cdata(CDATA_BRUSH_LEVEL, tc) <= 3 ) {
					cdata(CDATA_BRUSH_LEVEL, tc)++
				}
				inv(INV_ITEM_NUM, ci)--
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				f = 1
				if ( cdatan(CDATAN_RACE, tc) == "snail" ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_RED
						txtmore
						txt lang("こうかはてきめんだ！", "..." + name(tc) + " start" + _s(tc) + " to melt.")
					}
					if ( cdata(CDATA_HP, tc) > 10 ) {
						dmghp tc, cdata(CDATA_HP, tc) - rnd(10), DAMAGE_FROM_ACID
					}
					else {
						dmghp tc, rnd(20000), DAMAGE_FROM_ACID
					}
				}
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 81 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰を治療する？", "Who is target?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				txtef COLOR_BLUE
				txt lang("キットを使い" + name(cc) + "は応急手当を行った。", name(cc) + " have first aid use the kit.")
				animeid = ANIMATION_HEAL
				gosub *anime
				healhp tc, (sdata(SKILL_NORMAL_GENE_ENGINEER, cc) + sdata(SKILL_ATTR_DEX, cc)) / 4 * (sdata(SKILL_NORMAL_GENE_ENGINEER, cc) + sdata(SKILL_ATTR_DEX, cc)) / 10 + 10
				if ( cdata(CDATA_CONDITION_POISON, tc) != 0 ) {
					cdata(CDATA_CONDITION_POISON, tc) = cdata(CDATA_CONDITION_POISON, tc) / 8 + 1
				}
				if ( cdata(CDATA_CONDITION_BLIND, tc) != 0 ) {
					cdata(CDATA_CONDITION_BLIND, tc) = cdata(CDATA_CONDITION_BLIND, tc) / 8 + 1
				}
				if ( cdata(CDATA_CONDITION_PARALYZE, tc) != 0 ) {
					cdata(CDATA_CONDITION_PARALYZE, tc) = cdata(CDATA_CONDITION_PARALYZE, tc) / 8 + 1
				}
				if ( cdata(CDATA_CONDITION_DRUNK, tc) != 0 ) {
					cdata(CDATA_CONDITION_DRUNK, tc) = cdata(CDATA_CONDITION_DRUNK, tc) / 8 + 1
				}
				if ( cdata(CDATA_CONDITION_BLEED, tc) != 0 ) {
					cdata(CDATA_CONDITION_BLEED, tc) = cdata(CDATA_CONDITION_BLEED, tc) / 8 + 1
				}
				inv(INV_ITEM_NUM, ci)--
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				f = 1
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 80 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰に使用させる？", "Who is user?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					txt lang("それは無理だ。", "It's impossible.")
					goto *act_use_SWEND1
				}
				cibk = ci
				cost = 0
				inv_getheader tc
				repeat invrange, invhead
					if ( inv(INV_ITEM_NUM, cnt) == 0 ) {
						continue
					}
					if ( refitem(inv(INV_ITEM_ID, cnt), DBSPEC_TYPE) != FILTER_AMMO ) {
						continue
					}
					ci = cnt
					repeat 15
						if ( inv(40 + cnt * 2, ci) == 0 ) {
							break
						}
						enc = inv(40 + cnt * 2, ci)
						i = enc / 10000
						if ( i != 0 ) {
							enc = enc \ 10000
							if ( i == 9 ) {
								i = inv(40 + cnt * 2 + 1, ci) \ 1000, inv(40 + cnt * 2 + 1, ci) / 1000
								if ( inv(40 + cnt * 2, ci) \ 10000 == 4 ) {
									continue
								}
								cost += (i(1) - i) * (50 + enc * enc * 10)
								inv(40 + cnt * 2 + 1, ci) = i(1) * 1000 + i(1)
							}
						}
					loop
				loop
				f = 1
				if ( cost == 0 ) {
					txt lang("補充できる矢弾がない。", "There is no ammos necessary replenishment.")
					goto *act_use_SWEND1
				}
				animeload 11, tc
				snd SOUNDLIST_AMMO
				txtef COLOR_GREEN
				txt lang("矢弾を補充した！", "Ammos was supplemented!")
				inv(INV_ITEM_NUM, cibk)--
				cell_refresh inv(INV_ITEM_X, cibk), inv(INV_ITEM_Y, cibk)
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 77 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰に使用させる？", "Who is user?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc >= MAX_CHARA_FOLLOWER ) {
					txt lang("それは無理だ。", "It's impossible.")
					goto *act_use_SWEND1
				}
				if ( cdata(CDATA_POWER_GAUGE, tc) < 100 ) {
					txt lang("それは無理だ。", "It's impossible.")
					goto *act_use_SWEND1
				}
				if ( cdata(CDATA_SHIFT_FORM, tc) > SHIFT_FORM_NONE ) {
					repeat 8 + 8
						if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_NONE ) {
							break
						}
						if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_FORM_SHIFT_ALPHA ) {
							delbuff tc, cnt
							continue cnt
						}
						if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_FORM_SHIFT_BETA ) {
							delbuff tc, cnt
							continue cnt
						}
						if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_FORM_SHIFT_GAMMA ) {
							delbuff tc, cnt
							continue cnt
						}
						if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_FORM_SHIFT_DELTA ) {
							delbuff tc, cnt
							continue cnt
						}
						if ( cdata(STARTING_CDATA_BUFF + cnt * ARRAY_CDATA_BUFF, tc) == BUFF_FORM_SHIFT_OMEGA ) {
							delbuff tc, cnt
							continue cnt
						}
					loop
					r1 = tc
					gosub *charaRefresh
				}
				if ( cdata(CDATA_SHIFT_FORM, tc) == SHIFT_FORM_NONE ) {
					hikae = cdatan(CDATAN_NAME, tc)
					cdatan(CDATAN_NAME, tc) = cdatan(CDATAN_FORM_SHIFT_NAME, tc)
					cdatan(CDATAN_FORM_SHIFT_NAME, tc) = hikae
					if ( cdatan(CDATAN_NAME, tc) == "" ) {
						cdatan(CDATAN_NAME, tc) = cdatan(CDATAN_FORM_SHIFT_NAME, tc) + lang("／アルター", "-altered")
					}
					hikae = cdata(CDATA_PORTRAIT, tc)
					cdata(CDATA_PORTRAIT, tc) = cdata(CDATA_FORM_SHIFT_PORTRAIT, tc)
					cdata(CDATA_FORM_SHIFT_PORTRAIT, tc) = hikae
					hikae = cdata(CDATA_FACE, tc)
					cdata(CDATA_FACE, tc) = cdata(CDATA_FORM_SHIFT_FACE, tc)
					cdata(CDATA_FORM_SHIFT_FACE, tc) = hikae
					hikae = pcc(PCC_HAIR, tc)
					pcc(PCC_HAIR, tc) = cdata(CDATA_FORM_SHIFT_PCC_HAIR, tc)
					cdata(CDATA_FORM_SHIFT_PCC_HAIR, tc) = hikae
					hikae = pcc(PCC_SUB_HAIR, tc)
					pcc(PCC_SUB_HAIR, tc) = cdata(CDATA_FORM_SHIFT_PCC_SUB_HAIR, tc)
					cdata(CDATA_FORM_SHIFT_PCC_SUB_HAIR, tc) = hikae
					hikae = pcc(PCC_BODY, tc)
					pcc(PCC_BODY, tc) = cdata(CDATA_FORM_SHIFT_PCC_BODY, tc)
					cdata(CDATA_FORM_SHIFT_PCC_BODY, tc) = hikae
					hikae = pcc(PCC_CLOTH, tc)
					pcc(PCC_CLOTH, tc) = cdata(CDATA_FORM_SHIFT_PCC_CLOTH, tc)
					cdata(CDATA_FORM_SHIFT_PCC_CLOTH, tc) = hikae
					hikae = pcc(PCC_PANTS, tc)
					pcc(PCC_PANTS, tc) = cdata(CDATA_FORM_SHIFT_PCC_PANTS, tc)
					cdata(CDATA_FORM_SHIFT_PCC_PANTS, tc) = hikae
					hikae = pcc(PCC_ETC1, tc)
					pcc(PCC_ETC1, tc) = cdata(CDATA_FORM_SHIFT_PCC_ETC1, tc)
					cdata(CDATA_FORM_SHIFT_PCC_ETC1, tc) = hikae
					hikae = pcc(PCC_ETC2, tc)
					pcc(PCC_ETC2, tc) = cdata(CDATA_FORM_SHIFT_PCC_ETC2, tc)
					cdata(CDATA_FORM_SHIFT_PCC_ETC2, tc) = hikae
					hikae = pcc(PCC_ETC3, tc)
					pcc(PCC_ETC3, tc) = cdata(CDATA_FORM_SHIFT_PCC_ETC3, tc)
					cdata(CDATA_FORM_SHIFT_PCC_ETC3, tc) = hikae
					hikae = pcc(PCC_EYE, tc)
					pcc(PCC_EYE, tc) = cdata(CDATA_FORM_SHIFT_PCC_EYE, tc)
					cdata(CDATA_FORM_SHIFT_PCC_EYE, tc) = hikae
					hikae = pcc(PCC_RIDE, tc)
					pcc(PCC_RIDE, tc) = cdata(CDATA_FORM_SHIFT_PCC_RIDE, tc)
					cdata(CDATA_FORM_SHIFT_PCC_RIDE, tc) = hikae
					if ( pcc(PCC_BODY, tc) == 0 ) {
						pcc(PCC_BODY, tc) = 1
					}
					hikae = cdata(CDATA_PIC, tc)
					cdata(CDATA_PIC, tc) = cdata(CDATA_FORM_SHIFT_PIC, tc)
					cdata(CDATA_FORM_SHIFT_PIC, tc) = hikae
					if ( cdata(CDATA_PIC, tc) == xy2pic(0, 0) ) {
						cdata(CDATA_PIC, tc) = xy2pic(1, 0)
					}
				}
				if ( cbit(CHARA_BIT_PCC, tc) == TRUE ) {
					gsel BUFFER_BUF
					pos 0, 0
					picload exedir + "graphic\\face1" + devfile + ".bmp", 1
					gsel BUFFER_SCREEN
					ccbk = cc
					cc = tc
					gosub *com_portrait
					cc = ccbk
				}
				else {
					ccbk = cc
					cc = tc
					gosub *com_shape_change
					cc = ccbk
				}
				if ( tc == CHARA_PLAYER ) {
					gdata(GDATA_TEMPORARY_FLAGS) = 7777
				}
				customtalk tc, DBMODE_FLAVOR_SHIFT
				gosub *convert_word
				if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
					if ( jp ) {
						txt "「変身！」", "「フォームアップ！」", "「ドレスアップ！」", "「トランスフォーム！」"
					}
					if ( en ) {
						txt cnvtalk("Transform!")
					}
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_ALPHA_SHIFT_CORE ) {
					addbuff tc, BUFF_FORM_SHIFT_ALPHA, 200, 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BETA_SHIFT_CORE ) {
					addbuff tc, BUFF_FORM_SHIFT_BETA, 200, 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_GAMMA_SHIFT_CORE ) {
					addbuff tc, BUFF_FORM_SHIFT_GAMMA, 200, 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_DELTA_SHIFT_CORE ) {
					addbuff tc, BUFF_FORM_SHIFT_DELTA, 200, 200
				}
				if ( inv(INV_ITEM_ID, ci) == ITEM_ID_OMEGA_SHIFT_CORE ) {
					addbuff tc, BUFF_FORM_SHIFT_OMEGA, 150, 150
				}
				if ( tc == CHARA_PLAYER ) {
					gdata(GDATA_TEMPORARY_FLAGS) = 0
				}
				animeid = ANIMATION_GENE
				anic = tc
				gosub *anime
				cdata(CDATA_POWER_GAUGE, tc) -= 100
				f = 1
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 91 | _switch_sw ) {
		_switch_sw = 0
		if ( cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) < 25 ) {
			txt lang("何もおきない… ", "Nothing happens...")
			goto *act_use_SWEND1
		}
		txtsetnecrom 5
		repeat 5
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 300, 0
		gosub *prompt_key
		if ( rtval == 4 ) {
			goto *pc_turn
		}
		dead1 = -1
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cc == cnt ) {
				continue
			}
			tc = cnt
			if ( tc < MAX_CHARA_FOLLOWER ) {
				continue
			}
			if ( cbit(CHARA_BIT_NECRO, tc) != TRUE ) {
				continue
			}
			if ( rtval == 0 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_KING ) {
					dead1 = -2
				}
			}
			if ( rtval == 1 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_QUEEN ) {
					dead1 = -2
				}
			}
			if ( rtval == 2 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_JACK ) {
					dead1 = -2
				}
			}
			if ( rtval == 3 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_JOKER ) {
					dead1 = -2
				}
			}
		loop
		if ( dead1 == (-2) ) {
			txt lang("それは1体しか使役できない。", "You can not control more than one.")
			goto *act_use_SWEND1
		}
		dead1 = -1
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cc == cnt ) {
				continue
			}
			tc = cnt
			dx = cdata(CDATA_X, tc)
			dy = cdata(CDATA_Y, tc)
			if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
				continue
			}
			if ( tc < MAX_CHARA_FOLLOWER ) {
				continue
			}
			if ( cbit(CHARA_BIT_NECRO, tc) != TRUE ) {
				continue
			}
			if ( rtval == 0 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE ) {
					dead1 = tc
				}
			}
			if ( rtval == 1 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_CAT_ZOMBIE ) {
					dead1 = tc
				}
			}
			if ( rtval == 2 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_WARRIOR ) {
					dead1 = tc
				}
			}
			if ( rtval == 3 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_LICH ) {
					dead1 = tc
				}
			}
		loop
		if ( dead1 == (-1) ) {
			txt lang("視界内に素材が存在しない。", "You look around and find nothing.")
			goto *act_use_SWEND1
		}
		dead2 = -1
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cc == cnt ) {
				continue
			}
			tc = cnt
			dx = cdata(CDATA_X, tc)
			dy = cdata(CDATA_Y, tc)
			if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
				continue
			}
			if ( tc < MAX_CHARA_FOLLOWER ) {
				continue
			}
			if ( cbit(CHARA_BIT_NECRO, tc) != TRUE ) {
				continue
			}
			if ( rtval == 0 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_DRAGON_ZOMBIE ) {
					dead2 = tc
				}
			}
			if ( rtval == 1 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_MUMMY ) {
					dead2 = tc
				}
			}
			if ( rtval == 2 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_DEAD_EYES_BLOOD_DRAGON ) {
					dead2 = tc
				}
			}
			if ( rtval == 3 ) {
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_NECRO_DOLL ) {
					dead2 = tc
				}
			}
		loop
		if ( dead2 == (-1) ) {
			txt lang("視界内に素材が存在しない。", "You look around and find nothing.")
			goto *act_use_SWEND1
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_CAT_ZOMBIE ) {
			necrop = 2
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_ZOMBIE ) {
			necrop = 3
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_MUMMY ) {
			necrop = 4
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_SKELETON_WARRIOR ) {
			necrop = 5
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_LICH ) {
			necrop = 6
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_NECRO_DOLL ) {
			necrop = 7
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_DRAGON_ZOMBIE ) {
			necrop = 8
		}
		if ( cdata(CDATA_ID, dead1) == CREATURE_ID_DEAD_EYES_BLOOD_DRAGON ) {
			necrop = 9
		}
		necrop3 = cdata(CDATA_CHARA_PIC, dead1)
		flt
		itemcreate -1, ITEM_ID_COFFIN_OF_NECROMANCY, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		inv(INV_ITEM_PARAM1, ci) = necrop
		inv(INV_ITEM_PARAM2, ci) = cdata(CDATA_FORM_SHIFT_PIC, dead1)
		inv(INV_ITEM_WEIGHT, ci) += necrop * 1000
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + inv(INV_ITEM_PARAM3, ci) * 24
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		inv(INV_ITEM_KNOWN, ci) = ITEM_KNOWN_NECRO
		inv(INV_ITEM_CHARA_PIC, ci) = necrop3
		chara_vanquish dead1
		gosub *screen_draw
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_CAT_ZOMBIE ) {
			necrop = 2
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_ZOMBIE ) {
			necrop = 3
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_MUMMY ) {
			necrop = 4
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_SKELETON_WARRIOR ) {
			necrop = 5
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_LICH ) {
			necrop = 6
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_NECRO_DOLL ) {
			necrop = 7
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_DRAGON_ZOMBIE ) {
			necrop = 8
		}
		if ( cdata(CDATA_ID, dead2) == CREATURE_ID_DEAD_EYES_BLOOD_DRAGON ) {
			necrop = 9
		}
		necrop3 = cdata(CDATA_CHARA_PIC, dead2)
		flt
		itemcreate -1, ITEM_ID_COFFIN_OF_NECROMANCY, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		inv(INV_ITEM_PARAM1, ci) = necrop
		inv(INV_ITEM_PARAM2, ci) = cdata(CDATA_FORM_SHIFT_PIC, dead2)
		inv(INV_ITEM_WEIGHT, ci) += necrop * 1000
		inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12 + inv(INV_ITEM_PARAM3, ci) * 24
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		inv(INV_ITEM_KNOWN, ci) = ITEM_KNOWN_NECRO
		inv(INV_ITEM_CHARA_PIC, ci) = necrop3
		chara_vanquish dead2
		gosub *screen_draw
		txtef COLOR_RED
		txt lang("*死者融合*　", "*Necro Fusion* ")
		if ( rtval == 0 ) {
			p = 878
		}
		if ( rtval == 1 ) {
			p = 877
		}
		if ( rtval == 2 ) {
			p = 876
		}
		if ( rtval == 3 ) {
			p = 875
		}
		necrolv = sdata(SKILL_NORMAL_ANATOMY, CHARA_PLAYER) + sdata(SKILL_NORMAL_ALCHEMY, CHARA_PLAYER)
		if ( necrolv > gdata(GDATA_DEEPEST_LEVEL) * 3 / 2 ) {
			necrolv = gdata(GDATA_DEEPEST_LEVEL) * 3 / 2
		}
		flt
		initlv = necrolv
		novoidlv = 1
		fixlv = FIX_QUALITY_GOOD
		characreate -1, p, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		cdata(CDATA_RELATION, rc) = RELATION_ALLY
		cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
		cbitmod CHARA_BIT_NECRO, rc, TRUE
		cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
		snd SOUNDLIST_CURSE3
		animeid = ANIMATION_GENE
		anic = 0
		gosub *anime
		cdata(CDATA_POWER_GAUGE, CHARA_PLAYER) -= 25
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 52 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰を対象にする？", "Who is target?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc == CHARA_PLAYER ) {
					txt lang("それは無理だ。", "It's impossible.")
					goto *pc_turn
				}
				if ( cdata(CDATA_RELATION, tc) == RELATION_ENEMY ) {
					txt lang("敵対していて調教どころではない。", "You can not train the enemy.")
					goto *pc_turn
				}
				if ( cdata(CDATA_ID, tc) == CREATURE_ID_JURE | cdata(CDATA_ID, tc) == CREATURE_ID_JURE ) {
					repeat 245
						if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
							continue
						}
						if ( cdata(CDATA_ID, cnt) == CREATURE_ID_ROVID ) {
							snd SOUNDLIST_AMMO
							txt lang(cdatan(CDATAN_NAME, cnt) + "「叩きたいのなら私を叩きなさい！」", "Action was arrested by " + cdatan(CDATAN_NAME, cnt) + ".")
							goto *act_use_SWEND1
						}
					loop
				}
				txtsettamer 6
				repeat 6
					promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
					promptmax++
				loop
				val = promptx, prompty, 300, 0
				gosub *prompt_key
				if ( rtval == 5 ) {
					goto *pc_turn
				}
				if ( cdata(CDATA_MASTER_SERVANT2, tc) == 0 ) {
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_CUPID_OF_DEATH | cdata(CDATA_ID, tc) == CREATURE_ID_CUPID_OF_LOVE | cdata(CDATA_ID, tc) == CREATURE_ID_DOG | cdata(CDATA_ID, tc) == CREATURE_ID_DEMON ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = -5
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_CAMOUFLAGED_IMP | cdata(CDATA_ID, tc) == CREATURE_ID_M_GIRL ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = -10
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_ANGEL | cdata(CDATA_ID, tc) == CREATURE_ID_SERAPH | cdata(CDATA_ID, tc) == CREATURE_ID_DOMINION ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = 5
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_ARASIEL | cdata(CDATA_ID, tc) == CREATURE_ID_LULWY | cdata(CDATA_ID, tc) == CREATURE_ID_DEVASTATE_LULWY | cdata(CDATA_ID, tc) == CREATURE_ID_WHITE_YOUNG_LADY ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = 10
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_NERES_THE_AMNESIAC ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = 7
					}
				}
				if ( rtval == 4 ) {
					if ( cbit(CHARA_BIT_SANDBAG, tc) ) {
						txt lang("それは無理だ。", "It's impossible.")
						goto *act_use_SWEND1
					}
					cdata(CDATA_MASTER_SERVANT2, tc) += 1
					if ( cdata(CDATA_MASTER_SERVANT2, tc) == 0 ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = 1
					}
					if ( cdata(CDATA_MASTER_SERVANT2, tc) >= 10 ) {
						cdata(CDATA_MASTER_SERVANT2, tc) = 10
					}
					if ( map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_ITEM_CHIPS) != 0 ) {
						cell_itemlist cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
						f = 0
						repeat listmax
							p = list(0, cnt)
							if ( inv(INV_ITEM_ID, p) == ITEM_ID_WOODEN_HORSE ) {
								if ( jp ) {
									txtef COLOR_RED
									txt name(0) + "に三角木馬が食い込んだ！"
								}
								if ( cdata(CDATA_MASTER_SERVANT2, tc) < 10 ) {
									cdata(CDATA_MASTER_SERVANT2, tc) += 1
								}
								if ( cdata(CDATA_MASTER_SERVANT2, tc) == 0 ) {
									cdata(CDATA_MASTER_SERVANT2, tc) = 1
								}
								break
							}
						loop
					}
					if ( cdata(CDATA_MASTER_SERVANT2, tc) <= (-5) ) {
						if ( jp ) {
							txtef COLOR_SKY_BLUE
							txt name(tc) + "はなんだか残念そうだ…。", "「ぶってもらいたいのは" + _ore(3) + "なのに…」", "「あの…次は" + _ore(3) + "にも" + _tanomu(3) + "」"
						}
					}
					if ( cdata(CDATA_MASTER_SERVANT2, tc) > (-5) & cdata(CDATA_MASTER_SERVANT2, tc) < 5 ) {
						customtalk tc, DBMODE_FLAVOR_INSULT2
						gosub *convert_word
						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
							if ( jp ) {
								txtef COLOR_RED
								txt name(tc) + "は戸惑いながら鞭であなたを軽く叩いた。", "「なんだかちょっとゾクゾクする…」", "「こ、これでいいの" + _kana(3) + "」", "「痛そうだからちょっと加減する" + _na(3) + "」"
							}
						}
					}
					if ( cdata(CDATA_MASTER_SERVANT2, tc) >= 5 & cdata(CDATA_MASTER_SERVANT2, tc) < 10 ) {
						customtalk tc, DBMODE_FLAVOR_INSULT2
						gosub *convert_word
						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
							if ( jp ) {
								txtef COLOR_RED
								txt name(tc) + "はうっすらと嗜虐的な笑みを浮かべた。", "「ヘンタイにはこれでも足りない" + _nda(1) + "」", "「さぁ、" + _ore(3) + "への服従を示してもら" + _u(3) + "」", "「まだご褒美が足りない" + _noka(3) + "？」"
							}
						}
					}
					if ( cdata(CDATA_MASTER_SERVANT2, tc) == 10 ) {
						customtalk tc, DBMODE_FLAVOR_INSULT2
						gosub *convert_word
						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
							if ( jp ) {
								txtef COLOR_RED
								txt name(tc) + "は無言であなたに鞭を浴びせた。", name(tc) + "は無表情で機械的に鞭を振り下ろした。", "「" + _kimi(3) + "の親は可哀想" + _da(3) + "」", "「そうやって、いつまでうずくまってるの" + _kana(3) + "？」"
							}
						}
					}
					animeload 28, 0
					snd SOUNDLIST_PUNISH1
					snd searrow
					f = 1
				}
				if ( rtval == 2 ) {
					cdata(CDATA_TONE, tc) = cdata(CDATA_TONE, tc) + 1
					if ( cdata(CDATA_TONE_SEX, tc) == 1 ) {
						if ( cdata(CDATA_TONE, tc) >= 7 ) {
							cdata(CDATA_TONE, tc) = 0
							cdata(CDATA_TONE_SEX, tc) = 2
						}
					}
					else {
						if ( cdata(CDATA_TONE, tc) >= 7 ) {
							cdata(CDATA_TONE, tc) = 0
							cdata(CDATA_TONE_SEX, tc) = 1
						}
					}
					if ( jp ) {
						txtef COLOR_YELLOW
						txt "「わ、わかった" + _yo(3) + "！" + _ore(3) + "はこういう喋り方でどう" + _kana(3) + "？」"
					}
					f = 1
				}
				if ( rtval < 2 | rtval == 3 ) {
					if ( tc < MAX_CHARA_FOLLOWER ) {
						if ( cdata(CDATA_ROW_ACT, tc) == ACTION_EAT ) {
							if ( cdata(CDATA_ACTION_PERIOD, tc) > 0 ) {
								cdata(CDATA_ROW_ACT, tc) = ACTION_NONE, 0
								txtmore
								gosub *cell_info
							}
						}
					}
					if ( rtval == 3 ) {
						hostileaction CHARA_PLAYER, tc
					}
					if ( rtval == 0 ) {
						if ( cdata(CDATA_TAMER_WHIP_EAT, tc) == 1 ) {
							cdata(CDATA_TAMER_WHIP_EAT, tc) = 0
						}
						else {
							cdata(CDATA_TAMER_WHIP_EAT, tc) = 1
						}
					}
					if ( rtval == 1 ) {
						if ( cdata(CDATA_TAMER_WHIP_PICKUP, tc) == 1 ) {
							cdata(CDATA_TAMER_WHIP_PICKUP, tc) = 0
						}
						else {
							cdata(CDATA_TAMER_WHIP_PICKUP, tc) = 1
						}
					}
					if ( rtval == 0 & cdata(CDATA_TAMER_WHIP_EAT, tc) == 1 | (rtval == 1 & cdata(CDATA_TAMER_WHIP_PICKUP, tc) != 0) | rtval == 3 ) {
						txt lang("あなたは鞭を振り下ろした。", "You beat " + name(tc) + ".")
						animeload 28, tc
						snd SOUNDLIST_PUNISH1
						snd searrow
						cdata(CDATA_MASTER_SERVANT2, tc) -= 1
						if ( cdata(CDATA_MASTER_SERVANT2, tc) == 0 ) {
							cdata(CDATA_MASTER_SERVANT2, tc) = -1
						}
						if ( cdata(CDATA_MASTER_SERVANT2, tc) <= (-10) ) {
							cdata(CDATA_MASTER_SERVANT2, tc) = -10
						}
						if ( map(cdata(CDATA_X, tc), cdata(CDATA_Y, tc), MAP_ITEM_CHIPS) != 0 ) {
							cell_itemlist cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
							f = 0
							repeat listmax
								p = list(0, cnt)
								if ( inv(INV_ITEM_ID, p) == ITEM_ID_WOODEN_HORSE ) {
									if ( jp ) {
										txtef COLOR_RED
										txt name(tc) + "に三角木馬が食い込んだ！"
									}
									cdata(CDATA_MASTER_SERVANT2, tc) -= 1
									if ( cdata(CDATA_MASTER_SERVANT2, tc) == 0 ) {
										cdata(CDATA_MASTER_SERVANT2, tc) = -1
									}
									if ( cdata(CDATA_MASTER_SERVANT2, tc) <= (-10) ) {
										cdata(CDATA_MASTER_SERVANT2, tc) = -10
									}
									break
								}
							loop
						}
						if ( cdata(CDATA_MASTER_SERVANT2, tc) >= 5 ) {
							customtalk tc, DBMODE_FLAVOR_INSULT
							gosub *convert_word
							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
								if ( jp ) {
									txtef COLOR_RED
									txt name(tc) + "は反抗的にあなたをにらみつけた。", name(tc) + "は信じられないといった表情で呆然としている…。", "「ッ！" + _ore(3) + "にこんなことをして、どうなるかわかってるの" + _kana(3) + "！」", "「あぐっ！？…ふん、この程度" + _ka(3) + "？」"
								}
							}
						}
						if ( cdata(CDATA_MASTER_SERVANT2, tc) > (-5) & cdata(CDATA_MASTER_SERVANT2, tc) < 5 ) {
							customtalk tc, DBMODE_FLAVOR_DISCIPLINE
							gosub *convert_word
							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
								if ( jp ) {
									txtef COLOR_SKY_BLUE
									txt name(tc) + "は涙を浮かべて痛みに耐えた。", name(tc) + "は痛みと恐怖でがくがくと震えている…。", "「" + name(0) + "、怖い" + _yo(3) + "…」", "「何か悪いことした" + _kana(3) + "？」"
								}
							}
						}
						if ( cdata(CDATA_MASTER_SERVANT2, tc) <= (-5) & cdata(CDATA_MASTER_SERVANT2, tc) > (-10) ) {
							customtalk tc, DBMODE_FLAVOR_DISCIPLINE2
							gosub *convert_word
							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
								if ( jp ) {
									txtef COLOR_SKY_BLUE
									txt name(tc) + "は泣きながらも微かに笑みを浮かべた。", name(tc) + "は我慢することの快感に戸惑っている。", "「なんだか、身体が熱い…」", "「あ…！」"
								}
							}
						}
						if ( cdata(CDATA_MASTER_SERVANT2, tc) == (-10) ) {
							customtalk tc, DBMODE_FLAVOR_DISCIPLINE2
							gosub *convert_word
							if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
								if ( jp ) {
									txtef COLOR_SKY_BLUE
									txt name(tc) + "はだらしない表情を浮かべている。", name(tc) + "はあなたの与える痛みに溺れている…。", "「まだ…満足してない" + _yo(3) + "？」", "「あひっ♪」"
								}
							}
							if ( spact(SKILL_SPACT_BLAME_PAIN - STARTING_SKILL_SPACT) == 0 ) {
								spact(SKILL_SPACT_BLAME_PAIN - STARTING_SKILL_SPACT) = 1
								txtmore
								txtef COLOR_YELLOW
								txt lang("あなたは「" + skillname(SKILL_SPACT_BLAME_PAIN) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_BLAME_PAIN) + ".")
							}
						}
					}
					else {
						customtalk tc, DBMODE_FLAVOR_DISCIPLINE_OFF
						gosub *convert_word
						if ( gdata(GDATA_CUSTOM_TALK) == 100 ) {
							txtef COLOR_SKY_BLUE
							txt lang(name(tc) + "はホッと胸をなでおろした。", name(tc) + " gasp" + _s(tc) + ", " + cnvtalk("Don't stop!"))
						}
					}
					f = 1
				}
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 63 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_ARENA | mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			txt lang("何もおきない… ", "Nothing happens...")
			goto *act_use_SWEND1
		}
		np = 0
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_RELATION, cnt) == RELATION_ALLY ) {
				np++
			}
		loop
		if ( np > 15 ) {
			txt lang("これ以上は同時に使役できない。", "You can not control monster more than 10.")
			goto *act_use_SWEND1
		}
		p = 447
		if ( inv(INV_ITEM_PARAM1, ci) == 3 ) {
			p = 21
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 4 ) {
			p = 100
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 5 ) {
			p = 150
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 6 ) {
			p = 47
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 7 ) {
			p = 578
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 8 ) {
			p = 416
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 9 ) {
			p = 579
		}
		necrolv = (sdata(SKILL_NORMAL_ANATOMY, CHARA_PLAYER) + sdata(SKILL_NORMAL_ALCHEMY, CHARA_PLAYER)) * (inv(INV_ITEM_PARAM1, ci) + 5) / 14
		if ( necrolv > gdata(GDATA_DEEPEST_LEVEL) * 3 / 2 ) {
			necrolv = gdata(GDATA_DEEPEST_LEVEL) * 3 / 2
		}
		if ( inv(INV_ITEM_PARAM2, ci) != 0 ) {
			necrolv += 5
		}
		necrop3 = 0
		if ( inv(INV_ITEM_CHARA_PIC, ci) == xy2pic(1, 0) ) {
			necrop3 = 1
		}
		necrop2 = inv(INV_ITEM_PARAM2, ci)
		if ( 0 ) {
			txt lang("necrop2は" + necrop2 + "。necrop3は" + necrop3 + "。", "Undead monster creep out from coffin.")
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		flt
		initlv = necrolv
		novoidlv = 1
		fixlv = FIX_QUALITY_GOOD
		characreate -1, p, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
		cdata(CDATA_RELATION, rc) = RELATION_ALLY
		cdata(CDATA_RELATION_ORG, rc) = RELATION_ALLY
		cbitmod CHARA_BIT_NECRO, rc, TRUE
		cdata(CDATA_FORM_SHIFT_PIC, rc) = necrop2
		cdatan(CDATAN_NAME, rc) += " Lv" + cdata(CDATA_LEVEL, rc)
		if ( necrop3 == 0 ) {
			if ( necrop2 >= 1800 ) {
				cdata(CDATA_PIC, rc) = necrop2
			}
			if ( necrop2 >= 12000 & necrop2 < 18000 ) {
				cdata(CDATA_PIC, rc) = necrop2 - 12000
			}
		}
		else {
			if ( necrop2 >= 2800 ) {
				cdata(CDATA_PIC, rc) = necrop2
				cdata(CDATA_CHARA_PIC, rc) = xy2pic(1, 0)
			}
			if ( necrop2 > 13000 & necrop2 < 19000 ) {
				cdata(CDATA_PIC, rc) = necrop2 - 13000
				cdata(CDATA_CHARA_PIC, rc) = xy2pic(1, 0)
			}
		}
		necrop2 = 0
		snd SOUNDLIST_CURSE3
		txt lang("闇と共に棺からアンデッドが這いずり出てきた。", "Undead monster creep out from coffin.")
		if ( spact(SKILL_SPACT_NECRO_FORCE - STARTING_SKILL_SPACT) == 0 ) {
			spact(SKILL_SPACT_NECRO_FORCE - STARTING_SKILL_SPACT) = 1
			txtmore
			txtef COLOR_YELLOW
			txt lang("あなたは「" + skillname(SKILL_SPACT_NECRO_FORCE) + "」の能力を得た。", "You have learned new ability, " + skillname(SKILL_SPACT_NECRO_FORCE) + ".")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 74 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			txtnew
			txt lang("その行為は、ワールドマップにいる間はできない。", "You can't do that while you're in a global area.")
			goto *act_use_SWEND1
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_POTION_RACK ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 10
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BREAD_DISPLAY ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 11
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_LARGE_BOOKSHELF | inv(INV_ITEM_ID, ci) == ITEM_ID_OLD_BOOKSHELF | inv(INV_ITEM_ID, ci) == ITEM_ID_CRAFT_BOOK_SHELF | inv(INV_ITEM_ID, ci) == ITEM_ID_BOOKSHELF ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = 12
		}
		goto *act_open
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 101 | _switch_sw ) {
		_switch_sw = 0
		txt lang("どこに餌を撒く？", "Where do you sprinkle the bait?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( chipm(CHIPM_ROLE, map(x, y, MAP_TILE_ID)) != MAP_CHIP_ROLE_WATER ) {
				txt lang("水に撒こう。", "It is necessary to sprinkle on the water.")
				goto *act_use_SWEND1
			}
			inv(INV_ITEM_NUM, ci)--
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			snd SOUNDLIST_BUSH1
			if ( mapfoodtypefind(x, y, 6) != (-1) ) {
				ci = mapfoodtypefind(x, y, 6)
				item_separatefish ci
				if ( stat != (-1) ) {
					kaiwa = rnd(3)
					if ( kaiwa == 0 ) {
						txt lang(itemname(ci) + "は餌をのんびり食べている…。", itemname(ci) + " is leisurely eating the bait....")
					}
					if ( kaiwa == 1 ) {
						txt lang(itemname(ci) + "は餌を食べるのに夢中だ。", itemname(ci) + " is absorbed in eating bait.")
					}
					if ( kaiwa == 2 ) {
						txt lang(itemname(ci) + "は餌を一口で飲み込んだ！", itemname(ci) + " swallowed the bait in a mouthful!")
					}
					if ( inv(INV_ITEM_LEVEL, ci) < 15 ) {
						inv(INV_ITEM_LEVEL, ci)++
					}
					await 500
					snd SOUNDLIST_WATER2
				}
			}
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 102 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_CARD1
		txt lang(itemname(ci) + "を周囲に散布した。", "You scatter" + _s(cc) + " " + itemname(ci) + " around.")
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		gdata(GDATA_FLAG_ENCOUNTER_CANCELLER_DISTANCE_REMAINING) = 100
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 100 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_COMPLETE1
		animeload 66, cc
		txt lang(name(cc) + "はケーキを取り出した。", name(cc) + " take" + _s(cc) + " out the cake in the box.")
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		repeat 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_DIM, cnt) > 60 ) {
				cdata(CDATA_CONDITION_DIM, cnt) = 59
			}
			cdata(CDATA_CONDITION_SLEEP, cnt) = 0
			cdata(CDATA_CONDITION_SUFFOCATION, cnt) = 0
			cdata(CDATA_CONDITION_PARALYZE, cnt) = 0
			cc = cnt
			if ( cnt != 0 ) {
				tc = CHARA_PLAYER
				efid = SKILL_SPACT_SHADOW_STEP
				gosub *effect
			}
			if ( cdata(CDATA_IN_TAGTEAM, cc) != 1 ) {
				gosub *eat_meal_xmas_cake
			}
			if ( cdata(CDATA_IN_TAGTEAM, cc) == (-1) ) {
				cc = cdata(CDATA_TAGTEAM_PARTNER, cc)
				gosub *eat_meal_xmas_cake
			}
		loop
		cc = CHARA_PLAYER
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 75 | _switch_sw ) {
		_switch_sw = 0
		gdata(GDATA_FLAG_PICNIC_MULTIPLIER) = inv(INV_ITEM_LEVEL, ci)
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		txt lang(name(cc) + "はバスケット内の料理を広げた。", name(cc) + " take" + _s(cc) + " out the food in the basket.")
		flt
		itemcreate -1, ITEM_ID_LARGE_EMPTY_BASKET, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 1
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		repeat 16
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_DIM, cnt) > 60 ) {
				cdata(CDATA_CONDITION_DIM, cnt) = 59
			}
			cdata(CDATA_CONDITION_SLEEP, cnt) = 0
			cdata(CDATA_CONDITION_SUFFOCATION, cnt) = 0
			cdata(CDATA_CONDITION_PARALYZE, cnt) = 0
			cc = cnt
			if ( cnt != 0 ) {
				tc = CHARA_PLAYER
				efid = SKILL_SPACT_SHADOW_STEP
				gosub *effect
			}
			if ( cdata(CDATA_IN_TAGTEAM, cc) != 1 ) {
				gosub *eat_meal
			}
			if ( cdata(CDATA_IN_TAGTEAM, cc) == (-1) ) {
				cc = cdata(CDATA_TAGTEAM_PARTNER, cc)
				gosub *eat_meal
			}
		loop
		cc = CHARA_PLAYER
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 62 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰を対象にする？", "Who is target?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cbit(CHARA_BIT_NECRO, tc) == TRUE ) {
					undlv = 150
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_KING ) {
						undlv = 150
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_QUEEN ) {
						undlv = 140
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_JACK ) {
						undlv = 130
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_UNITDEAD_JOKER ) {
						undlv = 120
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_DEAD_EYES_BLOOD_DRAGON ) {
						undlv = 107
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_DRAGON_ZOMBIE ) {
						undlv = 65
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_NECRO_DOLL ) {
						undlv = 40
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_LICH ) {
						undlv = 20
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_WARRIOR ) {
						undlv = 12
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_MUMMY ) {
						undlv = 14
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE ) {
						undlv = 8
					}
					if ( cdata(CDATA_ID, tc) == CREATURE_ID_CAT_ZOMBIE ) {
						undlv = 4
					}
					if ( cdata(CDATA_LEVEL, CHARA_PLAYER) < undlv / 2 ) {
						txt lang("レベルが足りない。", "Your level is insufficient.")
						goto *pc_turn
					}
				}
				else {
					if ( cdata(CDATA_LEVEL, CHARA_PLAYER) < cdata(CDATA_LEVEL, tc) / 2 ) {
						txt lang("レベルが足りない。", "Your level is insufficient.")
						goto *pc_turn
					}
				}
				if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
					txt lang("ここでは使えない。", "You can't use it here.")
					goto *pc_turn
				}
				if ( tc < MAX_CHARA_FOLLOWER | (cbit(CHARA_BIT_LIVESTOCK, tc) == TRUE & (gdata(GDATA_AREA) == AREA_DOJO | adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_DISCARDED_RANCH)) ) {
					txt lang("その相手には使えない。", "You can't use it for that opponent.")
					goto *pc_turn
				}
				if ( cdata(CDATA_QUALITY, tc) < FIX_QUALITY_MIRACLE & cdata(CDATA_ROLE, tc) == ROLE_NONE & cbit(CHARA_BIT_NECRO, tc) == FALSE ) {
					txt lang("その相手には使えない。", "You can't use it for that opponent.")
					goto *pc_turn
				}
				if ( cdata(CDATA_IMPRESSION, tc) < 200 ) {
					if ( 0 == 0 ) {
						txt lang(name(tc) + "に拒絶された。", "You have been rejected.")
						goto *pc_turn
					}
				}
				astink = limit(cdata(CDATA_LEVEL, tc) / 10, 1, 200)
				if ( cbit(CHARA_BIT_NECRO, tc) == TRUE ) {
					astink = limit(undlv / 10, 1, 200)
				}
				if ( mat(36) < astink ) {
					txt lang("魔法のインクが足りない。" + astink + "個は必要だ。", "You do not have enough matMagicInk.")
					goto *pc_turn
				}
				txtef COLOR_RED
				txt lang("発動には魔法のインクを" + astink + "個消費する。効果を発動する？", "Watch " + cdatan(CDATAN_NAME, tc) + "'s change?")
				promptl(0, 0) = stryes, "y", "0"
				promptl(0, 1) = strno, "n", "1"
				promptmax = 2
				val = promptx, prompty, 160, 1
				gosub *prompt_key
				if ( rtval == 0 ) {
					matdelmain 36, astink
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					txt lang(name(tc) + "の存在が分裂した！", name(tc) + " split" + _s(tc) + "!")
					animeid = ANIMATION_GENE
					anic = 0
					gosub *anime
					p = cdata(CDATA_ID, tc)
					flt
					novoidlv = 1
					characreate -1, p, cdata(CDATA_X, tc), cdata(CDATA_Y, tc)
					cdata(CDATA_SEX, rc) = cdata(CDATA_SEX, tc)
					cdata(CDATA_PIC, rc) = cdata(CDATA_PIC, tc)
					cdata(CDATA_CHARA_PIC, rc) = cdata(CDATA_CHARA_PIC, tc)
					cdata(CDATA_PORTRAIT, rc) = cdata(CDATA_PORTRAIT, tc)
					cdata(CDATA_QUALITY, rc) = cdata(CDATA_QUALITY, tc)
					cdatan(CDATAN_NAME, rc) = "" + name(tc)
					cdata(CDATA_IMPRESSION, rc) = cdata(CDATA_IMPRESSION, tc)
					cdata(CDATA_HEIGHT, rc) = cdata(CDATA_HEIGHT, tc)
					cdata(CDATA_WEIGHT, rc) = cdata(CDATA_WEIGHT, tc)
					cdata(CDATA_AGE, rc) = cdata(CDATA_AGE, tc)
					cdata(CDATA_GOD, rc) = cdata(CDATA_GOD, tc)
					evold = lang(" Lv", " Lv") + int(cdata(CDATA_LEVEL, tc))
					if ( strmid(cdatan(CDATAN_NAME, rc), -1, strlen(evold)) == evold ) {
						cdatan(CDATAN_NAME, rc) = strmid(cdatan(CDATAN_NAME, rc), 0, strlen(cdatan(CDATAN_NAME, rc)) - strlen(evold))
					}
					wishally = 100
					gosub *add_ally
					f = 1
				}
				else {
					goto *pc_turn
				}
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 59 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰に被らせる？", "Put on who?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc != CHARA_PLAYER ) {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						txt lang("それは無理だ。", "It's impossible.")
						goto *pc_turn
					}
				}
				txt lang("新しい種族は？", "What's a new race?")
				val = (windoww - 220) / 2 + inf_screenx, winposy(90), 12, 1, 0
				inputlog = ""
				input_mode = 0
				gosub *prompt_word
				if ( inputlog == "" ) {
					txt lang("やっぱりやめた。", "You changed your mind.")
					goto *act_use_SWEND1
				}
				else {
					cdatan(CDATAN_CUSTOM_RACE, tc) = "" + inputlog
					txt lang(cdatan(CDATAN_NAME, tc) + "は「" + cdatan(CDATAN_CUSTOM_RACE, tc) + "」に生まれ変わった。", "Race of " + cdatan(CDATAN_NAME, tc) + " change to <" + cdatan(CDATAN_CUSTOM_RACE, tc) + ">.")
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					animeload 8, tc
					f = 1
				}
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 94 | _switch_sw ) {
		_switch_sw = 0
		cibk = ci
		invsubroutine = 1
		invctrl = INVCTRL_MATERIAL_ENCHANT, 15
		snd SOUNDLIST_INV
		gosub *com_inventory
		if ( stat == 1 ) {
			saiseiseimode = 0
			if ( inv(INV_ITEM_ATTACK, ci) == 0 & inv(INV_ITEM_DAMAGE, ci) == 0 & inv(INV_ITEM_DV, ci) == 0 & inv(INV_ITEM_PV, ci) == 0 & inv(INV_ITEM_DICE2, ci) == 0 ) {
				txt lang("何もおきない… ", "Nothing happens...")
				goto *act_use_SWEND1
			}
			oldcol = inv(INV_ITEM_COL, ci)
			oldweight = inv(INV_ITEM_WEIGHT, ci)
			saiseiseimode = 100
			s = itemname(ci, 1, 1)
			fixmaterial = inv(INV_ITEM_MATERIAL, ci)
			gosub *remake_material
			inv(INV_ITEM_WEIGHT, ci) = oldweight
			inv(INV_ITEM_COL, ci) = oldcol
			saiseiseimode = 0
			snd SOUNDLIST_BUILD1
			await 600
			snd SOUNDLIST_BUILD1
			await 600
			snd SOUNDLIST_DING3
			txt lang(name(cc) + "の" + s + "は" + itemname(ci, 1) + "に変化した。", name(cc) + your(cc) + " " + s + " transforms into " + itemname(ci, 1) + ".")
			ci = cibk
			inv(INV_ITEM_NUM, ci)--
			if ( ci >= 5080 ) {
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			}
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 73 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_FLAG_CAN_USE_WONDER_BODY_FORMER) != 140 ) {
			txt lang("何もおきない… ", "Nothing happens...")
			goto *pc_turn
		}
		txt lang("誰に使う？", "Who to use?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc != CHARA_PLAYER ) {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						txt lang("それは無理だ。", "It's impossible.")
						goto *pc_turn
					}
				}
				txt lang("獲得する部位は？", "What's a new body?")
				txtplusbody 10
				repeat 10
					promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
					promptmax++
				loop
				val = promptx, prompty, 200, 0
				gosub *prompt_key
				if ( rtval == 0 ) {
					goto *pc_turn
				}
				r1 = tc
				repeat 30, 100
					if ( cdata(cnt, r1) != 0 ) {
						continue
					}
					if ( rtval == 1 ) {
						cdata(cnt, r1) = 1 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(1) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(1) + "!")
							break
						}
					}
					if ( rtval == 2 ) {
						cdata(cnt, r1) = 2 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(2) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(2) + "!")
							break
						}
					}
					if ( rtval == 3 ) {
						cdata(cnt, r1) = 3 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(3) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(3) + "!")
							break
						}
					}
					if ( rtval == 4 ) {
						cdata(cnt, r1) = 4 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(4) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(4) + "!")
							break
						}
					}
					if ( rtval == 5 ) {
						cdata(cnt, r1) = 5 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(5) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(5) + "!")
							break
						}
					}
					if ( rtval == 6 ) {
						cdata(cnt, r1) = 6 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(6) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(6) + "!")
							break
						}
					}
					if ( rtval == 7 ) {
						cdata(cnt, r1) = 7 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(7) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(7) + "!")
							break
						}
					}
					if ( rtval == 8 ) {
						cdata(cnt, r1) = 8 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(8) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(8) + "!")
							break
						}
					}
					if ( rtval == 9 ) {
						cdata(cnt, r1) = 9 * 10000
						if ( cm ) {
							break
						}
						else {
							txt lang(name(r1) + "は新たな" + bodyn(9) + "を獲得した！", name(r1) + " grow" + _s(r1) + " a new " + bodyn(9) + "!")
							break
						}
					}
					break
				loop
				gosub *calcBodyFix
				inv(INV_ITEM_NUM, ci)--
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				animeload 8, tc
				f = 1
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 61 | _switch_sw ) {
		_switch_sw = 0
		f = get_freeally()
		if ( f == 0 ) {
			txt lang("何もおきない… ", "Nothing happens...")
			goto *act_use_SWEND1
		}
		if ( cc != CHARA_PLAYER & cc < MAX_CHARA_FOLLOWER ) {
			txt lang("何もおきない… ", "Nothing happens...")
			goto *act_use_SWEND1
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CLEANING_DOLL ) {
			txt lang("機械音とともに人形が動き出した。どうやらロボットだったらしい。", "The doll began to move with mechanical sound. It looks like it was a robot.")
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SMALL_STONE_GOLEM | inv(INV_ITEM_ID, ci) == ITEM_ID_SMALL_WOODEN_GOLEM ) {
			cdata(CDATA_MP, CHARA_PLAYER) = (cdata(CDATA_MP, CHARA_PLAYER) + 1) * 8 / 10
			txt lang("ゴーレムが起動した。", "The golem is activated.")
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BISQUE_DOLL ) {
			cdata(CDATA_MP, CHARA_PLAYER) = (cdata(CDATA_MP, CHARA_PLAYER) + 1) * 8 / 10
			txt lang("人形が動き出した。", "The doll began to move.")
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_CLEANING_DOLL ) {
			flt
			novoidlv = 1
			fixlv = FIX_QUALITY_GOOD
			characreate MAX_CHARA_NC, CREATURE_ID_PRO_JET, -3, 0
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SMALL_STONE_GOLEM ) {
			flt
			novoidlv = 1
			fixlv = FIX_QUALITY_GOOD
			characreate MAX_CHARA_NC, CREATURE_ID_SMALL_STONE_GOLEM, -3, 0
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_SMALL_WOODEN_GOLEM ) {
			flt
			novoidlv = 1
			fixlv = FIX_QUALITY_GOOD
			characreate MAX_CHARA_NC, CREATURE_ID_SMALL_WOODEN_GOLEM, -3, 0
		}
		if ( inv(INV_ITEM_ID, ci) == ITEM_ID_BISQUE_DOLL ) {
			flt
			novoidlv = 1
			fixlv = FIX_QUALITY_GOOD
			characreate MAX_CHARA_NC, CREATURE_ID_BISQUE_DOLL, -3, 0
		}
		rc = MAX_CHARA_NC
		gosub *add_ally
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 72 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰を対象にする？", "Who is target?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( tc == CHARA_PLAYER & cc == CHARA_PLAYER | cc == gdata(GDATA_RIDER) ) {
					if ( gdata(GDATA_RIDER) != 0 ) {
						tc = gdata(GDATA_RIDER)
					}
				}
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				inv(INV_ITEM_NUM, ci)--
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				snd SOUNDLIST_ENC
				animeload 36, cc
				csctrl = 4
				snd SOUNDLIST_POP2
				cc = tc
				gosub *com_charainfo
				cc = CHARA_PLAYER
			}
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 69 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_PRAY1
		txtef COLOR_GREEN
		txt lang(godname(cdata(CDATA_GOD, CHARA_PLAYER)) + "への信仰の深さ：" + cdata(CDATA_PIETY, CHARA_PLAYER) + "/" + sdata(SKILL_NORMAL_FAITH, CHARA_PLAYER) * 100 + "、祈りチャージ：" + limit((cdata(CDATA_PRAY, CHARA_PLAYER) + 1) / 10, 0, 100) + "％ ", "Piety : " + cdata(CDATA_PIETY, CHARA_PLAYER) + "/" + sdata(SKILL_NORMAL_FAITH, CHARA_PLAYER) * 100 + " PrayCharge : " + limit((cdata(CDATA_PRAY, CHARA_PLAYER) + 1) / 10, 0, 100) + "percent ")
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 64 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_MONTH) != 2 | gdata(GDATA_FLAG_CHOCOLATE_KIT_LIMIT) >= 10 ) {
			txt lang("次の2月を待とう。", "You have to wait next February.")
			goto *act_use_SWEND1
		}
		if ( rnd(8) == 0 ) {
			music = MUSICLIST_MCBOSS3
			gosub *music_play
		}
		else {
			music = MUSICLIST_MCARENA
			gosub *music_play
		}
		txtef COLOR_GREEN
		txt lang("おいしいチョコレートを作ろう！まずはどうしようか。", "Let's make a delicious chocolate! How would you do first?")
		txtsetchocoword 3
		repeat 3
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 310, 0
		gosub *prompt_key
		if ( rtval == 0 ) {
			snd SOUNDLIST_ATK_FIRE
		}
		if ( rtval == 1 ) {
			snd SOUNDLIST_EAT1
			txtef COLOR_YELLOW
			txt lang("それなりにおいしかった。", "It was delicious.")
			inv(INV_ITEM_NUM, ci)--
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			cdata(CDATA_HUNGER, CHARA_PLAYER) += 750
			gosub *music_play
			goto *act_use_SWEND1
		}
		if ( rtval == 2 ) {
			txtef COLOR_RED
			txt lang("考えただけでも面倒なので作るのをやめた。", "You stop making of chocolate.")
			gosub *music_play
			goto *act_use_SWEND1
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		dbg_skipevent = 1
		gdata(GDATA_HOUR)++
		gosub *advance_hour
		dbg_skipevent = 0
		txtef COLOR_GREEN
		txt lang("チョコレートを刻んで、テンパリングしながら湯煎で溶かした！次はどうしようか。", "You have to wait next February.")
		snd SOUNDLIST_ATK_POISON
		txtsetchocoword2 3
		repeat 3
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 310, 0
		gosub *prompt_key
		if ( rtval == 1 ) {
			snd SOUNDLIST_DRINK1
			txtef COLOR_RED
			txt lang("あつつ！", "It is too hot!")
			txtef COLOR_YELLOW
			txt lang("…甘くておいしい！", "...It was delicious.")
			cdata(CDATA_HUNGER, CHARA_PLAYER) += 750
			dmghp CHARA_PLAYER, cdata(CDATA_MAX_HP, CHARA_PLAYER) / 10, DAMAGE_FROM_CHOCO
			gosub *music_play
			goto *act_use_SWEND1
		}
		if ( rtval == 2 ) {
			snd SOUNDLIST_WEB
			txtef COLOR_RED
			txt lang("あつつ！", "It is too hot!")
			snd SOUNDLIST_WEB
			txtef COLOR_YELLOW
			txt lang("あなたは全身チョコまみれになった。", "...It was delicious.")
			snd SOUNDLIST_WEB
			dmghp CHARA_PLAYER, cdata(CDATA_MAX_HP, CHARA_PLAYER) / 10, DAMAGE_FROM_CHOCO
			gdata(GDATA_FLAG_CHOCOLATE_KIT_YOURSELF) = 1
			gosub *music_play
			goto *act_use_SWEND1
		}
		txtef COLOR_GREEN
		txt lang("チョコレートを型に流し込んだ！固まるまでに最後の仕上げをしよう。", "You have to wait next February.")
		txtsetchocoword3 6
		repeat 6
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 310, 0
		gosub *prompt_key
		if ( rtval == 0 ) {
			snd SOUNDLIST_ATK_MIND
			animeload 30, 0
			chop = 4
		}
		if ( rtval == 1 ) {
			snd SOUNDLIST_CURSE3
			animeload 14, 0
			chop = 2
		}
		if ( rtval == 2 ) {
			chop = 5
		}
		if ( rtval == 3 ) {
			txtef COLOR_YELLOW
			txt lang("巨大なトリュフチョコレートができた！", "It was delicious.")
			snd SOUNDLIST_COMPLETE1
			flt
			novoidlv = 1
			fixlv = FIX_QUALITY_GOOD
			characreate -1, CREATURE_ID_TRUFFE_CHOCOLATE_WISP, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER)
			gosub *music_play
			goto *act_use_SWEND1
		}
		if ( rtval == 4 ) {
			snd SOUNDLIST_CURSE3
			animeload 30, 0
			chop = 3
		}
		if ( rtval == 5 ) {
			snd SOUNDLIST_EAT1
			txtef COLOR_YELLOW
			txt lang("まだ柔らかいけどおいしい！", "It was delicious.")
			cdata(CDATA_HUNGER, CHARA_PLAYER) += 750
			gosub *music_play
			goto *act_use_SWEND1
		}
		dbg_skipevent = 1
		gdata(GDATA_MIN) += 10
		gosub *advance_hour
		dbg_skipevent = 0
		txtef COLOR_YELLOW
		txt lang("手作りチョコができた！", "It was delicious.")
		snd SOUNDLIST_COMPLETE1
		itemcreate -1, ITEM_ID_HANDMADE_CHOCOLATE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
		if ( stat ) {
			inv(INV_ITEM_SUB_NAME, ci) = 0
			inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
			inv(INV_ITEM_PARAM3, ci) = chop
		}
		gdata(GDATA_FLAG_CHOCOLATE_KIT_LIMIT)++
		gosub *music_play
		chop = 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 96 | _switch_sw ) {
		_switch_sw = 0
		if ( cc != CHARA_PLAYER ) {
			txt lang("何もおきない… ", "Nothing happens...")
			goto *act_use_SWEND1
		}
		cibk = ci
		invsubroutine = 1
		invctrl = INVCTRL_MATERIAL_ENCHANT, 16
		snd SOUNDLIST_INV
		gosub *com_inventory
		if ( stat == 1 ) {
			if ( inv(INV_ITEM_LEVEL, ci) < 15 ) {
				snd SOUNDLIST_DING2
				txt lang(itemname(ci) + "は青い光に包まれた。", itemname(ci) + " " + is2(inv(INV_ITEM_NUM, ci)) + " surrounded by a blue aura.")
				inv(INV_ITEM_LEVEL, ci)++
			}
			else {
				txt lang(itemname(ci) + "は抵抗した。", itemname(ci) + " resist" + _s2(inv(INV_ITEM_NUM, ci)) + ".")
			}
			ci = cibk
			inv(INV_ITEM_NUM, ci)--
			if ( ci >= 5080 ) {
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			}
			r1 = cc
			gosub *charaRefresh
		}
		else {
			obvious = 0
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 95 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_PURPLE
		txt lang("「スキャン及び採取の対象を選択して下さい」", "Please select the target of scanning.")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc == CHARA_PLAYER ) {
					txt lang("それは無理だ。", "It's impossible.")
					snd SOUNDLIST_FAIL1
					goto *act_use_SWEND1
				}
				animeload 8, tc
				txtef COLOR_PURPLE
				txt lang("「対象を複製しています…」", "Duplicating objects...")
				hostileaction CHARA_PLAYER, tc
				animeload 8, 0
				inv(INV_ITEM_NUM, ci)--
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				txtef COLOR_PURPLE
				txt lang("「ネットワークに接続されていません。内部構成を中止しました」", "Not connected to the network. Internal configuration has been canceled.")
				txtvalid = 0
				txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
				hostileaction CHARA_PLAYER, tc
				flt
				itemcreate -1, ITEM_ID_FIGURINE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
				inv(INV_ITEM_COL, ci) = cdata(CDATA_PIC, tc) \ 1000 + cdata(CDATA_CHARA_PIC, tc) * 1000
				inv(INV_ITEM_SUB_NAME, ci) = cdata(CDATA_ID, tc)
				cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
				flt
				itemcreate -1, ITEM_ID_CORPSE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), 0
				inv(INV_ITEM_AMUR_CAGE, ci) = 1
				remain_make ci, tc
				f = 1
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 60 | _switch_sw ) {
		_switch_sw = 0
		txt lang("誰に書かせる？", "Write who?")
		gosub *screen_draw
		val = 0
		gosub *prompt_direction
		f = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
				if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
					txtselecttc 2
					repeat 2
						promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
						promptmax++
					loop
					val = promptx, prompty, 200, 0
					gosub *prompt_key
					if ( rtval == 1 ) {
						tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
					}
				}
				if ( tc != CHARA_PLAYER ) {
					if ( tc >= MAX_CHARA_FOLLOWER ) {
						txt lang("それは無理だ。", "It's impossible.")
						goto *pc_turn
					}
				}
				txt lang("新しい職業は？", "What's a new class?")
				val = (windoww - 220) / 2 + inf_screenx, winposy(90), 12, 1, 0
				inputlog = ""
				input_mode = 0
				gosub *prompt_word
				if ( inputlog == "" ) {
					txt lang("やっぱりやめた。", "You changed your mind.")
					goto *act_use_SWEND1
				}
				else {
					if ( inputlog == "戦士" | inputlog == "warrior" ) {
						cdatan(CDATAN_CLASS, tc) = "warrior"
					}
					if ( inputlog == "遺跡荒らし" | inputlog == "thief" ) {
						cdatan(CDATAN_CLASS, tc) = "thief"
					}
					if ( inputlog == "魔法使い" | inputlog == "wizard" ) {
						cdatan(CDATAN_CLASS, tc) = "wizard"
					}
					if ( inputlog == "農民" | inputlog == "farmer" ) {
						cdatan(CDATAN_CLASS, tc) = "farmer"
					}
					if ( inputlog == "プレデター" | inputlog == "predator" ) {
						cdatan(CDATAN_CLASS, tc) = "predator"
					}
					if ( inputlog == "狩人" | inputlog == "archer" ) {
						cdatan(CDATAN_CLASS, tc) = "archer"
					}
					if ( inputlog == "魔法戦士" | inputlog == "warmage" ) {
						cdatan(CDATAN_CLASS, tc) = "warmage"
					}
					if ( inputlog == "観光客" | inputlog == "tourist" ) {
						cdatan(CDATAN_CLASS, tc) = "tourist"
					}
					if ( inputlog == "ピアニスト" | inputlog == "pianist" ) {
						cdatan(CDATAN_CLASS, tc) = "pianist"
					}
					if ( inputlog == "機工兵" | inputlog == "gunner" ) {
						cdatan(CDATAN_CLASS, tc) = "gunner"
					}
					if ( inputlog == "プリースト" | inputlog == "priest" ) {
						cdatan(CDATAN_CLASS, tc) = "priest"
					}
					if ( inputlog == "クレイモア" | inputlog == "claymore" ) {
						cdatan(CDATAN_CLASS, tc) = "claymore"
					}
					cdatan(CDATAN_FAKE_CLASS, tc) = "" + inputlog
					txt lang(cdatan(CDATAN_NAME, tc) + "は「" + cdatan(CDATAN_FAKE_CLASS, tc) + "」の職についた。", "Class of " + cdatan(CDATAN_NAME, tc) + " change to <" + cdatan(CDATAN_FAKE_CLASS, tc) + ">.")
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					animeload 8, tc
					f = 1
				}
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 68 | _switch_sw ) {
		_switch_sw = 0
		txt lang("どの曲を再生しよう？", "Which music will you play.")
		gosub *com_jukebox
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 6 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "再生した。", "You play " + itemname(ci, 1) + ".")
		music = inv(INV_ITEM_PARAM1, ci) + 50 + 1
		if ( music >= 134 - 1 ) {
			music = 134 - 2
		}
		mdata(MDATA_MUSIC) = music
		gosub *music_play
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 10 | _switch_sw ) {
		_switch_sw = 0
		screenupdate = -1
		gosub *screen_draw
		goto *com_story
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 7 | _switch_sw ) {
		_switch_sw = 0
		if ( inv(INV_ITEM_PROPERTY, ci) != PROPERTY_CONSTRUCT ) {
			if ( mdata(MDATA_CAN_SAVE) == 0 | gdata(GDATA_AREA) == AREA_QUEST | gdata(GDATA_AREA) == AREA_SHELTER ) {
				if ( gdata(GDATA_AREA) == AREA_WILDERNESS ) {
					txt lang("ワールドマップで建設するべきだ。", "You can only build it in the world map.")
				}
				else {
					txt lang("ここには建てられない。", "You can't build it here.")
				}
				gosub *screen_draw
				goto *pc_turn
			}
			gdata(GDATA_ROW_ACT) = ACTION_CONSTRUCT
			gosub *generalAct
			goto *turn_end
		}
		if ( adata(ADATA_ID, gdata(GDATA_AREA)) == AREA_RANDOM_DUNGEON ) {
			if ( gdata(GDATA_LEVEL) == adata(ADATA_MAX_LEVEL, gdata(GDATA_AREA)) ) {
				if ( adata(ADATA_BOSS, gdata(GDATA_AREA)) != (-1) ) {
					txt lang("クエストを放棄してシェルターに避難する？", "Really give up the quest and evacuate to the shelter?")
					promptl(0, 0) = stryes, "y", "0"
					promptl(0, 1) = strno, "n", "1"
					promptmax = 2
					val = promptx, prompty, 160, 1
					gosub *prompt_key
					if ( rtval != 0 ) {
						gosub *screen_draw
						goto *pc_turn
					}
				}
			}
		}
		gdata(GDATA_ROW_ACT) = ACTION_OPEN_HATCH
		gosub *generalAct
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 11 | _switch_sw ) {
		_switch_sw = 0
		if ( moneybox(inv(INV_ITEM_PARAM2, ci)) > cdata(CDATA_GOLD, CHARA_PLAYER) ) {
			txt lang("金貨が足りない…", "You count your coins and sigh...")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( inv(INV_ITEM_PARAM1, ci) >= 1000000000 ) {
			txt lang("貯金箱は一杯だ。", "The money box if ull.")
			gosub *screen_draw
			goto *pc_turn
		}
		item_separate ci
		snd SOUNDLIST_PAYGOLD1
		cdata(CDATA_GOLD, CHARA_PLAYER) -= moneybox(inv(INV_ITEM_PARAM2, ci))
		inv(INV_ITEM_PARAM1, ci) += moneybox(inv(INV_ITEM_PARAM2, ci))
		inv(INV_ITEM_WEIGHT, ci) += 100
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 20 | _switch_sw ) {
		_switch_sw = 0
		efid = SKILL_SPELL_INCOGNITO
		efp = 400
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 99 | _switch_sw ) {
		_switch_sw = 0
		if ( inv(INV_ITEM_PARAM1, ci) < 0 ) {
			cibk = ci
			kane = 210000000
			inv(INV_ITEM_PARAM1, ci) = 0
			txt lang("「計算間違えとったみたいやわ…ゴメンな」", cnvtalk("Hmm...Calculation seems to have been a mistake. Sorry..."))
			snd SOUNDLIST_PAYGOLD1
			flt
			itemcreate -1, ITEM_ID_GOLD_PIECE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), kane
			txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
			kane = 0
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), cibk) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
			ci = cibk
		}
		txt lang("[ 現在の預金額：" + inv(INV_ITEM_PARAM1, ci) + "gold ]", "You count your coins and sigh...")
		txtsetybank 6
		repeat 6
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 220, 0
		gosub *prompt_key
		if ( rtval == 0 ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
			txt lang("「ウチウチ詐欺には気をつけんといかんよ！」", cnvtalk("Please pay attention to fraud when transferring money!"))
			goto *pc_turn
		}
		if ( rtval == 1 ) {
			inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
			if ( inv(INV_ITEM_PARAM1, ci) == 0 ) {
				inv(INV_ITEM_PARAM1, ci) = 0
				txt lang("「これぞ金を産むガチョウ…って空っぽやんか！」", cnvtalk("This is the goose that gives birth to gol..d...what? empty!?"))
			}
			if ( inv(INV_ITEM_PARAM1, ci) > 0 ) {
				kane = inv(INV_ITEM_PARAM1, ci)
				inv(INV_ITEM_PARAM1, ci) = 0
				txt lang("「よいしょ…なかなか貯まっとるみたいやな」", cnvtalk("Hmm...It seems that quite accumulated coins!"))
				snd SOUNDLIST_PAYGOLD1
				flt
				itemcreate -1, ITEM_ID_GOLD_PIECE, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), kane
				txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
				kane = 0
			}
			goto *act_use_SWEND1
		}
		if ( rtval > 1 ) {
			if ( rtval == 2 ) {
				ybank = 100000
			}
			if ( rtval == 3 ) {
				ybank = 1000000
			}
			if ( rtval == 4 ) {
				ybank = 10000000
			}
			if ( rtval == 5 ) {
				ybank = 100000000
			}
			if ( ybank > cdata(CDATA_GOLD, CHARA_PLAYER) ) {
				txt lang("金貨が足りない…", "You count your coins and sigh...")
				ybank = 0
				inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
				gosub *screen_draw
				goto *pc_turn
			}
			if ( inv(INV_ITEM_PARAM1, ci) >= 1000000000 ) {
				txt lang("貯金箱は一杯だ。", "The money box if ull.")
				ybank = 0
				inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = gdata(GDATA_HOUR) + gdata(GDATA_DAY) * 24 + gdata(GDATA_MONTH) * 24 * 30 + gdata(GDATA_YEAR) * 24 * 30 * 12
				gosub *screen_draw
				goto *pc_turn
			}
			kaiwa = rnd(4)
			if ( kaiwa == 0 ) {
				txt lang("「よっしゃ！ウチが責任もって増やしたるっ！」", cnvtalk("OK! OK! I'll increase your coins with responsibility!"))
			}
			if ( kaiwa == 1 ) {
				txt lang("「金貨をーもっと用意できんかー？…ふふっ」", cnvtalk("Mm, can you prepare more coins?"))
			}
			if ( kaiwa == 2 ) {
				txt lang("「ガチョウがチョウ喜ぶで！…あかん、無表情や…」", cnvtalk("Yeah! Goose is pleased!"))
			}
			if ( kaiwa == 3 ) {
				txt lang("「ウチにかかれば、マネーの運用も思いのままねー！…なんや苦しいな」", cnvtalk("Operating money is easy if you leave it to me!"))
			}
			snd SOUNDLIST_PAYGOLD1
			cdata(CDATA_GOLD, CHARA_PLAYER) -= ybank
			item_separate ci
			if ( ybank > 0 ) {
				inv(INV_ITEM_PARAM1, ci) = (inv(INV_ITEM_PARAM1, ci) + ybank) / 10 * 11
			}
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 20 | _switch_sw ) {
		_switch_sw = 0
		efid = SKILL_SPELL_INCOGNITO
		efp = 400
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 76 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			txt lang("ここでは使えない。", "You can't place it here.")
			gosub *screen_draw
			goto *pc_turn
		}
		gdata(GDATA_TEMPORARY_FLAGS3) = 104
		efid = SKILL_SPELL_4DIM_POCKET
		efp = 650
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 47 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) != AREA_SHOW_HOUSE ) {
			txt lang("それは鈍く輝いた。", "It glows dully.")
			goto *act_use_SWEND1
		}
		if ( inv(INV_ITEM_PROPERTY, ci) != PROPERTY_SPECIAL ) {
			txt lang("水晶には領域の記憶が宿っていない。この場所の所有者が配置した水晶を探す必要がある。", "The crystal isn't filled with the memory fo this place. You need to find ones placed by the owner of this area.")
			goto *act_use_SWEND1
		}
		allyctrl = 0
		gosub *com_userNpc
		if ( stat != 1 ) {
			goto *act_use_SWEND1
		}
		snd SOUNDLIST_ENC
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 22 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_ENC
		if ( mdata(MDATA_TYPE) != MAP_TYPE_TOWN & mdata(MDATA_TYPE) != MAP_TYPE_VILLAGE ) {
			if ( 0 == 0 ) {
				txt lang("それは街でしか使えない。", "You can only use it in a town.")
				goto *act_use_SWEND1
			}
		}
		if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
			snd SOUNDLIST_FAIL1
			txt lang("今は決闘中だ！", "You can not run away from the duel!")
			goto *act_use_SWEND1
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		txt lang("突然、あなたの目の前に異次元へのゲートが現れた。", "Suddenly, a strange gate opens.")
		comctrl = 2
		gosub *com_import
		if ( stat == 1 ) {
			goto *extract_map
		}
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 49 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
			goto *act_use_SWEND1
		}
		txt lang(itemname(ci, 1) + "を振った。", "You swing " + itemname(ci, 1) + ".")
		snd SOUNDLIST_BUILD1
		efid = BUFF_RESOLUTION_HAND
		efp = 100
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 21 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE ) {
			goto *act_use_SWEND1
		}
		txt lang(itemname(ci, 1) + "を振った。", "You swing " + itemname(ci, 1) + ".")
		snd SOUNDLIST_BUILD1
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		fixmaterial = inv(INV_ITEM_MATERIAL, ci)
		efid = BUFF_GROW_CONSTITUTION
		efp = 500
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 25 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を使った。", "You hold " + itemname(ci, 1) + " up high.")
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		efid = SKILL_SPACT_RAIN_OF_SANITY
		efp = 500
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 26 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		gdata(GDATA_FLAG_RENEW_DUNGEON) = 1
		snd SOUNDLIST_PRAY1
		gdata(GDATA_FLAG_STATUE_OPATOS) = 1
		txtef COLOR_YELLOW
		txt lang("オパートス「フハハハ！間もなく、この地に変動が起こるであろう！」", "A voice echos, " + cnvtalk("Muwahahaha! I shall shake the land for you!"))
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 34 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		txtef COLOR_YELLOW
		txt lang("ジュア「べ、別にあんたのためにするんじゃないからね。バカっ！」", "A voice echos, " + cnvtalk("I-I'm not doing for you! Silly!"))
		efid = SKILL_SPACT_RAIN_OF_SANITY
		efp = 5000
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 50 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		txtef COLOR_YELLOW
		txt lang("クミロミ「種…出ちゃう…」", "A voice echos, " + cnvtalk("......!?"))
		snd SOUNDLIST_WEB
		flt
		itemcreate -1, ITEM_ID_UNKNOWN_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		if ( gdata(GDATA_DAY) == 9 | gdata(GDATA_DAY) == 19 | gdata(GDATA_DAY) == 29 | gdata(GDATA_DAY) == 3 | gdata(GDATA_DAY) == 13 | gdata(GDATA_DAY) == 23 | gdata(GDATA_DAY) == 30 | gdata(GDATA_DAY) == 6 | gdata(GDATA_DAY) == 16 | gdata(GDATA_DAY) == 26 ) {
			flt
			itemcreate -1, ITEM_ID_HERB_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		}
		else {
			flt
			itemcreate -1, ITEM_ID_FRUIT_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		}
		if ( gdata(GDATA_DAY) == 9 | gdata(GDATA_DAY) == 19 | gdata(GDATA_DAY) == 29 | gdata(GDATA_DAY) == 3 | gdata(GDATA_DAY) == 13 | gdata(GDATA_DAY) == 23 | gdata(GDATA_DAY) == 30 ) {
			flt
			itemcreate -1, ITEM_ID_ARTIFACT_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		}
		else {
			flt
			itemcreate -1, ITEM_ID_VEGETABLE_SEED, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 0
		}
		txtef COLOR_SKY_BLUE
		txtmore
		txt lang("像のスカートの中から何かが転がり落ちてきた。", "Statue generated a seed.")
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 51 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		snd SOUNDLIST_PRAY1
		txtef COLOR_YELLOW
		txt lang("マニ「さぁ、お前のスーパーモードを見せてみろ！」", "A voice echos, " + cnvtalk("Show me your super mode!"))
		addbuff tc, BUFF_BOOST, 120, 30
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 43 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		snd SOUNDLIST_PRAY1
		txtef COLOR_YELLOW
		txt lang("エヘカトル「呼んだ？呼んだ？」", "A voice echos, " + cnvtalk("Did you call me? call me?"))
		addbuff tc, BUFF_LUCK, 77, 2500
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 55 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		txtef COLOR_YELLOW
		txt lang("ヤカテクト「ほな、今日のお小遣い！1gpも無駄にしたらあかんよ？」", "A voice echos, " + cnvtalk("This is pocket money today. After wasting it must 1gp."))
		efp = 100
		animeload 10, tc
		repeat 3
			snd SOUNDLIST_PRAY1
			flt calcobjlv(efp / 10), calcfixlv(FIX_QUALITY_GREAT)
			dbid = 0
			dbid = 54
			p = 5000 + rnd(5000)
			if ( cdata(CDATA_GOD, CHARA_PLAYER) == GOD_YACATECT ) {
				if ( cdata(CDATA_PIETY, CHARA_PLAYER) != 0 ) {
					p += cdata(CDATA_PIETY, CHARA_PLAYER) / 10
				}
			}
			if ( cnt == 2 ) {
				if ( gdata(GDATA_DAY) == 8 | gdata(GDATA_DAY) == 10 ) {
					dbid = 55
					p = 1
				}
				if ( gdata(GDATA_DAY) * gdata(GDATA_MONTH) == 90 ) {
					dbid = 622
					p = 1
				}
			}
			nostack = 1
			itemcreate -1, dbid, cdata(CDATA_X, cc), cdata(CDATA_Y, cc), p
			txt lang(itemname(ci) + "が降ってきた！", itemname(ci) + " fall" + _s2(inv(INV_ITEM_NUM, ci)) + " down!")
			await 100
			redraw 1
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 56 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		txtef COLOR_YELLOW
		txt lang("イツパロトル「炎よ冷気よ、そして雷よ。我が命に応え、今こそ属性を遮る壁となれ」", "A voice echos, " + cnvtalk("Three elements will protect you from attribution."))
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cc < MAX_CHARA_FOLLOWER ) {
				if ( cnt >= 16 ) {
					continue
				}
				else {
					if ( cdata(CDATA_RELATION, cc) != cdata(CDATA_RELATION, tc) ) {
						continue
					}
				}
			}
			tc = cnt
			dx = cdata(CDATA_X, tc)
			dy = cdata(CDATA_Y, tc)
			if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
				continue
			}
			addbuff tc, BUFF_ATTRIBUTE_SHIELD, 2400, 100
			animeload 10, tc
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 27 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		snd SOUNDLIST_PRAY1
		txtef COLOR_YELLOW
		if ( gdata(GDATA_WEATHER) == WEATHER_ETHER ) {
			txt lang("ルルウィ「あさはかね。エーテルの風を止めてあげるとでも思ったの？」", "A rather angry voice echos, " + cnvtalk("Listen my little slave. Did you really think I would turn a hand in this filthy wind for you?"))
			goto *act_use_SWEND1
		}
		p = gdata(GDATA_WEATHER)
		repeat
			if ( rnd(10) == 0 ) {
				gdata(GDATA_WEATHER) = WEATHER_CLEAR
			}
			if ( rnd(10) == 0 ) {
				gdata(GDATA_WEATHER) = WEATHER_RAIN
			}
			if ( rnd(15) == 0 ) {
				gdata(GDATA_WEATHER) = WEATHER_HARD_RAIN
			}
			if ( rnd(20) == 0 ) {
				gdata(GDATA_WEATHER) = WEATHER_SNOW
			}
			if ( gdata(GDATA_WEATHER) != p ) {
				break
			}
		loop
		txt lang("ルルウィ「あらあら、定命の分際でそんなおねだりするの？ウフフ…今回は特別よ」", "An impish voice echos, " + cnvtalk("Ah you ask too much for a mortal. Still, it is hard to refuse a call from such a pretty slave like you."))
		txtmore
		txt lang("天候が変わった。", "The weather changes.")
		envonly = 1
		gosub *music_play
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 53 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 1 ) {
			snd SOUNDLIST_DING3
			txt lang("「あのなぁ…今月分はもうやったやろ？」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 2 ) {
			snd SOUNDLIST_DING3
			txt lang("「こら。来月まで辛抱せんかい」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 3 ) {
			snd SOUNDLIST_DING3
			txt lang("「せやから！今月のお小遣いはあれで終いやって！」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 4 ) {
			snd SOUNDLIST_DING3
			txt lang("「…そないにせがまれてもウチも困るんやけど」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 5 ) {
			snd SOUNDLIST_DING3
			txt lang("「隣の信者くんを見てみ？あのお小遣いでちゃあんと我慢してるやろ？」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 6 ) {
			snd SOUNDLIST_DING3
			txt lang("「また…。もしかしてツッコミ待ちなん？」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 7 ) {
			snd SOUNDLIST_DING3
			txt lang("「ま、まさか記憶喪失しとるんとちゃうやろな…あかん、心配なってきたわ」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 8 ) {
			snd SOUNDLIST_DING3
			txt lang("「…心配すんのもアホらしゅうなってきたわ」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 9 ) {
			snd SOUNDLIST_DING3
			txt lang("「うっさいわボケ…」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 10 ) {
			txt lang("「だああああああっ！！！ええ加減に！！ええ加減にせんかいアホーーー！！！…はぁはぁ」", cnvtalk("You'll have to wait until next month!!!"))
			efid = SKILL_SPACT_PUNISHMENT
			efp = 2000
			tc = CHARA_PLAYER
			gosub *effect
			snd SOUNDLIST_PUNISH1
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) == 11 ) {
			snd SOUNDLIST_DING3
			txt lang("「…前はちとやりすぎてもうたわ、勘忍な。せやけどこれは月イチなんよ、わかってや」", cnvtalk("You'll have to wait until next month."))
			gdata(GDATA_YACTECT_GEMSTONE_MSG)++
			goto *act_use_SWEND1
		}
		if ( gdata(GDATA_YACTECT_GEMSTONE_MSG) > 11 ) {
			txtef COLOR_PURPLE
			txt lang("空からものすごい勢いでプラチナ硬貨が地面に叩きつけられ粉微塵になった。", "A three-leaved falls from the sky.")
			snd SOUNDLIST_CRUSH1
			goto *act_use_SWEND1
		}
		snd SOUNDLIST_DING3
		flt
		itemcreate -1, ITEM_ID_PLATINUM_COIN, cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), limit(sdata(SKILL_NORMAL_FAITH, CHARA_PLAYER) / 6, 10, 25)
		txt lang("何かが足元に転がってきた。", "Something is put on the ground.")
		gdata(GDATA_YACTECT_GEMSTONE_MSG) = 1
		txt lang("「ほれほれ、今月のお小遣いやでー！…無駄使いしたら許さへんよ」", cnvtalk("I give pocket money to you! You must spend it usefully!"))
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 97 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			txt lang("ワールドマップで使うべきだ。", "You can only use it in the world map.")
			goto *act_use_SWEND1
		}
		txtsetnefia 6
		repeat 6
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 180, 0
		gosub *prompt_key
		nefia = rtval
		snd SOUNDLIST_OFFER2
		animeload 38, 0
		repeat 500 - 450, 450
			if ( adata(ADATA_ID, cnt) != AREA_RANDOM_DUNGEON ) {
				continue
			}
			if ( adata(ADATA_DEEPEST, cnt) != 0 ) {
				continue
			}
			if ( dist(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), adata(ADATA_X, cnt), adata(ADATA_Y, cnt)) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			adata(ADATA_MIN_LEVEL, cnt) = adata(ADATA_MIN_LEVEL, cnt) * (nefia * 2 + 5) / 10
			if ( adata(ADATA_MIN_LEVEL, cnt) < 1 ) {
				adata(ADATA_MIN_LEVEL, cnt) = 1
			}
			if ( adata(ADATA_MIN_LEVEL, cnt) > 6666 ) {
				adata(ADATA_MIN_LEVEL, cnt) = 6666
			}
			adata(ADATA_MAX_LEVEL, cnt) = adata(ADATA_MIN_LEVEL, cnt) + 3
			txtef COLOR_BLUE
			txt lang(mapname(cnt) + "は震えた。", mapname(cnt) + " vibrated.")
		loop
		nefia = 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 67 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) != MAP_TYPE_WORLD ) {
			txt lang("ワールドマップで使うべきだ。", "You can only use it in the world map.")
			goto *act_use_SWEND1
		}
		snd SOUNDLIST_OFFER2
		animeload 38, 0
		repeat 500 - 450, 450
			if ( adata(ADATA_ID, cnt) != AREA_RANDOM_DUNGEON ) {
				continue
			}
			if ( adata(ADATA_DEEPEST, cnt) != 0 ) {
				continue
			}
			if ( adata(ADATA_WAKEUP_NEFIA, cnt) != 0 ) {
				continue
			}
			if ( dist(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), adata(ADATA_X, cnt), adata(ADATA_Y, cnt)) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			txtef COLOR_RED
			txt lang(mapname(cnt) + "は活性化した！", mapname(cnt) + " was activated.")
			adata(ADATA_WAKEUP_NEFIA, cnt) = 100
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 70 | _switch_sw ) {
		_switch_sw = 0
		if ( cdatan(CDATAN_RACE, CHARA_PLAYER) == "doggod" | cdatan(CDATAN_RACE, CHARA_PLAYER) == "dog" | cdatan(CDATAN_CUSTOM_RACE, CHARA_PLAYER) == "犬" | cdatan(CDATAN_CUSTOM_RACE, CHARA_PLAYER) == "犬の神" ) {
			snd SOUNDLIST_WHISTLE
			txtef COLOR_SKY_BLUE
			txt lang(" *ピーーーー* ", "*Peeeeeeeeeep* ")
		}
		else {
			txt lang("何も聞こえない。", "...?")
		}
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cnt == 0 ) {
				continue
			}
			tc = cnt
			dx = cdata(CDATA_X, tc)
			dy = cdata(CDATA_Y, tc)
			if ( dist(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( cdatan(CDATAN_RACE, tc) == "doggod" | cdatan(CDATAN_RACE, tc) == "dog" | cdatan(CDATAN_CUSTOM_RACE, tc) == "犬" | cdatan(CDATAN_CUSTOM_RACE, tc) == "犬の神" | cdata(CDATA_ID, tc) == CREATURE_ID_OLDER_DOG_SISTER | cdata(CDATA_ID, tc) == CREATURE_ID_FOX_BROTHER ) {
				if ( rnd(2) == 0 ) {
					cdata(CDATA_EMO_ICON, tc) = 21 + 100
				}
			}
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 79 | _switch_sw ) {
		_switch_sw = 0
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cdata(CDATA_RELATION, cnt) != RELATION_ALLY ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_BRAINWASH, cnt) > 0 ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_BLIND, cnt) > 0 ) {
				continue
			}
			tc = cnt
			dx = cdata(CDATA_X, tc)
			dy = cdata(CDATA_Y, tc)
			if ( dist(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( fov_los(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), dx, dy) == 0 ) {
				continue
			}
			cc = cnt
			gosub *findTarget
			if ( stat == 0 ) {
				continue
			}
			if ( cc != CHARA_PLAYER ) {
				if ( cdata(CDATA_TARGET, cc) != 0 ) {
					if ( cdata(CDATA_RELATION, cdata(CDATA_TARGET, cc)) >= RELATION_DISLIKE ) {
						continue
					}
					if ( cbit(CHARA_BIT_SANDBAG, cdata(CDATA_TARGET, cc)) ) {
						continue
					}
					cdata(CDATA_POWER_GAUGE, cc) += 5
					if ( cdata(CDATA_POWER_GAUGE, cc) > 100 ) {
						if ( cdata(CDATA_SHIFT_FORM, cc) <= SHIFT_FORM_NONE & (cdata(CDATA_EVOLUTION_STAGE, cc) <= 0 | cc == CHARA_PLAYER) & (cdata(CDATA_QUALITY, cc) < FIX_QUALITY_MIRACLE | cc < MAX_CHARA_FOLLOWER) ) {
							cdata(CDATA_POWER_GAUGE, cc) = 100
						}
					}
					if ( cdata(CDATA_POWER_GAUGE, cc) > 200 ) {
						cdata(CDATA_POWER_GAUGE, cc) = 200
					}
				}
			}
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 57 | _switch_sw ) {
		_switch_sw = 0
		if ( synccheck(cc, -1) ) {
			txt lang("仲間にどんな指示を出そうか。", "Which instruction you serve directive to the fellow with the flag?")
		}
		txtsettactical 11
		repeat 11
			promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
			promptmax++
		loop
		val = promptx, prompty, 220, 0
		gosub *prompt_key
		if ( rtval == 0 ) {
			goto *pc_turn
		}
		if ( rtval == 1 ) {
			tact = 0
		}
		if ( rtval == 2 ) {
			tact = 1
		}
		if ( rtval == 3 ) {
			tact = 2
		}
		if ( rtval == 4 ) {
			tact = 3
		}
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( cc == cnt ) {
				continue
			}
			if ( cc < MAX_CHARA_FOLLOWER ) {
				if ( cnt >= 16 ) {
					continue
				}
			}
			if ( cdata(CDATA_RELATION, cnt) != RELATION_ALLY ) {
				continue
			}
			if ( cdata(CDATA_CONDITION_BRAINWASH, cnt) > 0 ) {
				continue
			}
			tc = cnt
			dx = cdata(CDATA_X, tc)
			dy = cdata(CDATA_Y, tc)
			if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), dx, dy) == 0 ) {
				continue
			}
			if ( rtval <= 4 ) {
				cdata(CDATA_DIRECTIVE_MODE, tc) = tact
				if ( cdata(CDATA_DIRECTIVE_MODE, tc) == DIRECTIVE_MODE_OFFENSIVE ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_RED
						txt lang(name(tc) + "は突撃の態勢に入った！", name(tc) + " switched to the offensive mode!")
					}
				}
				if ( cdata(CDATA_DIRECTIVE_MODE, tc) == DIRECTIVE_MODE_DEFENSIVE ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_BLUE
						txt lang(name(tc) + "は防御の態勢に入った！", name(tc) + " switched to the defensive mode!")
					}
				}
				if ( cdata(CDATA_DIRECTIVE_MODE, tc) == DIRECTIVE_MODE_INTERCEPT ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_YELLOW
						txt lang(name(tc) + "は迎撃の態勢に入った！", name(tc) + " switched to the intercept mode!")
					}
				}
				if ( cdata(CDATA_DIRECTIVE_MODE, tc) == DIRECTIVE_MODE_TALKING ) {
					if ( synccheck(tc, -1) ) {
						txtef COLOR_GREEN
						txt lang(name(tc) + "は交渉の態勢に入った！", name(tc) + " switched to the talking mode!")
					}
				}
			}
			if ( rtval >= 5 ) {
				f = 0
				repeat 30
					body = 100 + cnt
					if ( cdata(body, tc) \ EXT_EQUIP_SLOTS == 0 ) {
						continue
					}
					if ( cdata(body, tc) / EXT_EQUIP_SLOTS == 11 ) {
						ci = cdata(body, tc) \ EXT_EQUIP_SLOTS - 1
						f = 1
						break
					}
				loop
				if ( f == 0 ) {
					txt lang(name(tc) + "は矢弾を装備していない。", "You need to equip an ammo.")
					continue
				}
				if ( rtval == 5 ) {
					inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = -1
					s = lang("通常弾", "Normal"), lang("無限", "Unlimited")
					snd SOUNDLIST_AMMO
					txtef COLOR_GREEN
					txt lang(cdatan(CDATAN_NAME, tc) + "は" + s + "に切り替えた。", "Current Ammo Type")
				}
				else {
					if ( rtval == 6 ) {
						amp = ENCHANT_AMMO_BURST
					}
					if ( rtval == 7 ) {
						amp = ENCHANT_AMMO_MAGIC
					}
					if ( rtval == 8 ) {
						amp = ENCHANT_AMMO_PIERCING
					}
					if ( rtval == 9 ) {
						amp = ENCHANT_AMMO_EXPLOSIVE
					}
					if ( rtval == 10 ) {
						amp = ENCHANT_AMMO_RAPID
					}
					change = 0
					repeat 15
						if ( inv(40 + cnt * 2, ci) == 0 ) {
							break
						}
						enc = inv(40 + cnt * 2, ci)
						i = enc / 10000
						if ( i != 0 ) {
							enc = enc \ 10000
							if ( i == 9 ) {
								if ( inv(40 + cnt * 2, ci) \ 10000 == amp ) {
									inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) = cnt
									change = 1
									break
								}
							}
						}
					loop
					if ( change == 0 ) {
						txt lang(cdatan(CDATAN_NAME, tc) + "の矢弾はその切替に対応していない。", itemname(ci) + " isn't capable of that ammos.")
						continue
					}
					snd SOUNDLIST_AMMO
					change = 0
					i = inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) \ 1000, inv(40 + inv((9 /*!!!@[INV_ITEM_AMMO @@@ INV_ITEM_CHARGE @@@ INV_ITEM_CLIENT @@@ INV_ITEM_FILE @@@ INV_ITEM_NEXT_PERIOD]@!!! */), ci) * 2 + 1, ci) / 1000
					s = ammoname(amp), "" + i + "/" + i(1)
					s = s + ":" + s(1)
					txtef COLOR_GREEN
					txt lang(cdatan(CDATAN_NAME, tc) + "は" + s + "に切り替えた。", "Current Ammo Type")
				}
			}
		loop
		goto *pc_turn
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 54 | _switch_sw ) {
		_switch_sw = 0
		txtef COLOR_BLUE
		txt lang("衛星軌道上から荷電粒子砲が発射された！", "Rain of lazer pours into the ground!")
		gdata(GDATA_TEMPORARY_FLAGS3) = 777
		animeid = ANIMATION_HOLY
		animode = 0
		gosub *anime
		gdata(GDATA_TEMPORARY_FLAGS3) = 0
		repeat mdata(MDATA_HEIGHT)
			dy = cnt
			repeat mdata(MDATA_WIDTH)
				dx = cnt
				if ( map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) != 0 ) {
					tc = map(dx, dy, MAP_CHARA_INDEX_PLUS_ONE) - 1
					if ( tc == CHARA_PLAYER ) {
						continue
					}
					if ( cdata(CDATA_RELATION, tc) != RELATION_ENEMY ) {
						continue
					}
					if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
						if ( tc != CHARA_PLAYER ) {
							if ( rnd(cdata(CDATA_HP, tc) + 1) < rnd(cdata(CDATA_HP, cdata(CDATA_TAGTEAM_PARTNER, tc)) + 1) ) {
								tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
							}
							txt lang(name(tc) + "は" + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + "をかばった！", name(tc) + " guarded " + name(cdata(CDATA_TAGTEAM_PARTNER, tc)) + ".")
						}
					}
					map(dx, dy, MAP_TILE_ID) = xy2pic(12, 0)
					dmg = 300 + sdata(SKILL_ATTR_PER, CHARA_PLAYER) / 40 * limit(sdata(SKILL_ATTR_PER, CHARA_PLAYER), 1, 1000) + sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER) / 40 * sdata(SKILL_NORMAL_MARKSMAN, CHARA_PLAYER)
					if ( synccheck(tc, -1) ) {
						txtmore
						if ( tc >= MAX_CHARA_FOLLOWER ) {
							gdata(GDATA_DMG_TYPE) = 2
							txt3rd = 1
							txt lang("荷電粒子は" + name(tc) + "に命中し", "The lazer hits " + name(tc) + " and")
						}
						else {
							txt lang("荷電粒子は" + name(tc) + "に命中した。", "The lazer hits " + name(tc) + ".")
						}
					}
					dmghp tc, dmg, cc, SKILL_RESDMG_CRUSH, 1000
				}
			loop
		loop
		gvolley = 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 28 | _switch_sw ) {
		_switch_sw = 0
		if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD ) {
			txt lang("ここでは使えない。", "You can't place it here.")
			gosub *screen_draw
			goto *pc_turn
		}
		if ( cdata(CDATA_X, CHARA_PLAYER) != 33 | cdata(CDATA_Y, CHARA_PLAYER) != 16 ) {
			if ( gdata(GDATA_FLAG_SUB_NUKE) == 1 ) {
				txt lang("ここはクエストの目標位置ではない。本当にここに設置する？", "This location is not your quest goal. Really place it here?")
				promptl(0, 0) = stryes, "y", "0"
				promptl(0, 1) = strno, "n", "1"
				promptmax = 2
				val = promptx, prompty, 160, 1
				gosub *prompt_key
				if ( rtval != 0 ) {
					gosub *screen_draw
					goto *pc_turn
				}
			}
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		txt lang("原子爆弾を設置した。逃げろォー！", "You set up the nuke...now run!!")
		snd SOUNDLIST_BUILD1
		addmef cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MEF_TYPE_NUKE, xy2pic(5, 19), 10, 100, cc
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 48 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) != AREA_SHOW_HOUSE | usermapid == 0 ) {
			txt lang("それはこの場所ではみすぼらしく見える。", "It looks so dumb here.")
			goto *act_use_SWEND1
		}
		txt lang("この石像を見つめていると、何かを投げつけたくなってうずうずしてきた！", "Watching this strange statue makes you want to throw something at it!")
		gosub *browser
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 29 | _switch_sw ) {
		_switch_sw = 0
		trait(inv(INV_ITEM_PARAM1, ci)) = 1
		if ( inv(INV_ITEM_PARAM1, ci) == 169 ) {
			trait(TRAIT_OTHER_WICKED) = 0
		}
		if ( inv(INV_ITEM_PARAM1, ci) == 162 ) {
			trait(TRAIT_OTHER_SAINT) = 0
		}
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		txt lang("あなたは新たなフィートを獲得した！", "You gain a new feat.")
		animeload 10, 0
		r1 = cc
		gosub *charaRefresh
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 58 | _switch_sw ) {
		_switch_sw = 0
		val = 0
		gosub *prompt_direction
		f = 0
		evmode = 0
		if ( stat != 0 ) {
			if ( map(x, y, MAP_CHARA_INDEX_PLUS_ONE) > 0 ) {
				tc = map(x, y, MAP_CHARA_INDEX_PLUS_ONE) - 1
			}
		}
		if ( cdata(CDATA_IN_TAGTEAM, tc) != 0 ) {
			txtselecttc 2
			repeat 2
				promptl(0, promptmax) = s(cnt), key_select(cnt), "" + promptmax
				promptmax++
			loop
			val = promptx, prompty, 200, 0
			gosub *prompt_key
			if ( rtval == 1 ) {
				tc = cdata(CDATA_TAGTEAM_PARTNER, tc)
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOUNGER_CAT_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 1
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOUNGER_CAT_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 2
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LAME_HORSE | cdata(CDATA_ID, tc) == CREATURE_ID_WILD_HORSE | cdata(CDATA_ID, tc) == CREATURE_ID_NOYEL_HORSE | cdata(CDATA_ID, tc) == CREATURE_ID_YOWYN_HORSE | cdata(CDATA_ID, tc) == CREATURE_ID_THOROUGHBRED ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 3
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GIRAFFE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 4
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_DOG | cdata(CDATA_ID, tc) == CREATURE_ID_HOUND ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 5
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CAT | cdata(CDATA_ID, tc) == CREATURE_ID_SILVER_CAT | cdata(CDATA_ID, tc) == CREATURE_ID_STRAY_CAT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 6
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_MACHINE_INFANTRY | cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_ELITE_MACHINE_INFANTRY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 7
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR | cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_MAGICIAN | cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_BOXER | cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_KING ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 8
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR | cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_MAGICIAN | cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_BOXER | cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_KING ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 9
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_COBRA | cdata(CDATA_ID, tc) == CREATURE_ID_KING_COBRA ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 10
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GOOSE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 11
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_CAT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 0 ) {
							evmode = 12
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
						evmode = 12
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 13
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 13
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CUTE_FAIRY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 0 ) {
							evmode = 14
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
						evmode = 14
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 15
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 15
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ANDROID ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 0 ) {
							evmode = 16
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
						evmode = 16
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 17
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 17
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_ANGEL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 18
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_EXILE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 0 ) {
							evmode = 19
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
						evmode = 19
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 20
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 20
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GOLDEN_KNIGHT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 21
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_DEFENDER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 22
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_PUTIT | cdata(CDATA_ID, tc) == CREATURE_ID_RED_PUTIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 23
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BROWN_BEAR | cdata(CDATA_ID, tc) == CREATURE_ID_GRIZZLY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 24
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MILITARY_PUTIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 25
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_DOG | cdata(CDATA_ID, tc) == CREATURE_ID_HOUND ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 26
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_DOG | cdata(CDATA_ID, tc) == CREATURE_ID_HOUND ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 27
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CAT | cdata(CDATA_ID, tc) == CREATURE_ID_SILVER_CAT | cdata(CDATA_ID, tc) == CREATURE_ID_STRAY_CAT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 28
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CARBUNCLE | cdata(CDATA_ID, tc) == CREATURE_ID_LION ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 29
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_OLDER_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 30
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_OLDER_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 31
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOUNGER_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 32
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOUNGER_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 33
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_DRAGON_CHILD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 34
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_DRAGON_CHILD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 35
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BEETLE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 36
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_KABUTO ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 37
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_DRAGON_ZOMBIE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 38
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LICH | cdata(CDATA_ID, tc) == CREATURE_ID_MASTER_LICH | cdata(CDATA_ID, tc) == CREATURE_ID_DEMI_LICH ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 39
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_WARRIOR | cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_BERSERKER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 40
				}
			}
		}
		if ( cdata(CDATA_ID, tc) >= CREATURE_ID_PAWN & cdata(CDATA_ID, tc) <= CREATURE_ID_KING ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 41
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_CENTIPEDE | cdata(CDATA_ID, tc) == CREATURE_ID_CENTIPEDE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 42
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MAN_EATER_FLOWER | cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_FLOWER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 43
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GOKIBURI | cdata(CDATA_ID, tc) == CREATURE_ID_MURDER_COCKROACH ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 44
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIVING_ARMOR | cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_MASS ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 45
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_OLDER_DOG_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 46
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_OLDER_DOG_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 47
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BROWN_BEAR | cdata(CDATA_ID, tc) == CREATURE_ID_GRIZZLY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 48
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LITTLE_GIRL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 49
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOUNG_LADY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 50
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOUNG_LADY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 51
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LITTLE_GIRL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 52
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_COMBAT_PLANE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 53
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_XEREN_AUTO_TANK ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 54
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GRYFFON_CHILD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 55
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_INFECTED_YERLES_SOLDIER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 56
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_PUDDING_SPIRIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 57
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WAR_SPIRIT | cdata(CDATA_ID, tc) == CREATURE_ID_MAGIC_SPIRIT | cdata(CDATA_ID, tc) == CREATURE_ID_GUN_SPIRIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 58
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MEDUSA | cdata(CDATA_ID, tc) == CREATURE_ID_EURYALE | cdata(CDATA_ID, tc) == CREATURE_ID_STHENO ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 59
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIZARD_MAN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 60
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GIANT_SQUIRREL | cdata(CDATA_ID, tc) == CREATURE_ID_KILLER_SQUIRREL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 61
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CYCLOPS | cdata(CDATA_ID, tc) == CREATURE_ID_TITAN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 62
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LESSER_PHANTOM ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 63
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LITTLE_SISTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 64
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ELECTRIC_SHEEP ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 65
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WILD_SHEEP ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 66
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CUPID_OF_LOVE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 67
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_APPRENTICE_ANGEL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 68
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LITTLE_GIRL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 69
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BOMB_ROCK ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 70
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YEEK | cdata(CDATA_ID, tc) == CREATURE_ID_YEEK_WARRIOR | cdata(CDATA_ID, tc) == CREATURE_ID_YEEK_ARCHER | cdata(CDATA_ID, tc) == CREATURE_ID_MASTER_YEEK | cdata(CDATA_ID, tc) == CREATURE_ID_KAMIKAZE_YEEK ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 71
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_RAT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 72
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SLIME | cdata(CDATA_ID, tc) == CREATURE_ID_ACID_SLIME ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 0 ) {
							evmode = 74
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
						evmode = 74
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 73
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 73
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ALIEN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 75
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 75
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_WARRIOR | cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_BERSERKER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 76
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHICKEN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 77
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_MACHINE_INFANTRY | cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_ELITE_MACHINE_INFANTRY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 78
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_KOBOLD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 79
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLADE | cdata(CDATA_ID, tc) == CREATURE_ID_BLADE_ALPHA ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 80
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ELECTRIC_CLOUD | cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_CLOUD | cdata(CDATA_ID, tc) == CREATURE_ID_WISP ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 81
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FOX_BROTHER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 82
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FOX_BROTHER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 83
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_HERMIT_CRAB ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 84
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MILITARY_PUTIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 85
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GWEN_THE_INNOCENT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 86
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WARRIOR_OF_ELEA ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 87
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WIZARD_OF_ELEA ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 88
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_RAT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 89
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GRUDGE | cdata(CDATA_ID, tc) == CREATURE_ID_HUNGRY_DEMON ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 90
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WASP | cdata(CDATA_ID, tc) == CREATURE_ID_RED_WASP | cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_HORNET ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 91
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 91
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MUSHROOM | cdata(CDATA_ID, tc) == CREATURE_ID_SPORE_MUSHROOM | cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_MUSHROOM ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 92
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 92
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_COBRA | cdata(CDATA_ID, tc) == CREATURE_ID_KING_COBRA ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 93
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 93
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WYVERN | cdata(CDATA_ID, tc) == CREATURE_ID_VALIANT_WYVERN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 94
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_CRAB ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 95
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_JUERE_INFANTRY | cdata(CDATA_ID, tc) == CREATURE_ID_JUERE_SWORDMAN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 96
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CUB ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 97
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_HAMSTER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 98
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_DRAGON_CHILD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 2 ) {
					evmode = 99
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LESSER_PHANTOM ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 100
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BROWN_BEAR | cdata(CDATA_ID, tc) == CREATURE_ID_GRIZZLY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) >= 1 ) {
					if ( cdata(CDATA_EVOLUTION_STAGE, tc) < 3 ) {
						evmode = 101
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WOODEN_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_STONE_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_SMALL_WOODEN_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_SMALL_STONE_GOLEM ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 102
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WOODEN_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_STONE_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_SMALL_WOODEN_GOLEM | cdata(CDATA_ID, tc) == CREATURE_ID_SMALL_STONE_GOLEM ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 103
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SPIDER | cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_WIDOW | cdata(CDATA_ID, tc) == CREATURE_ID_PARALYZER | cdata(CDATA_ID, tc) == CREATURE_ID_TARANTULA | cdata(CDATA_ID, tc) == CREATURE_ID_BLOOD_SPIDER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 104
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_TYRANNOSAURUS ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 105
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_TYRANNOSAURUS ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 106
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SPIDER | cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_WIDOW | cdata(CDATA_ID, tc) == CREATURE_ID_PARALYZER | cdata(CDATA_ID, tc) == CREATURE_ID_TARANTULA | cdata(CDATA_ID, tc) == CREATURE_ID_BLOOD_SPIDER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 107
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SCORPION | cdata(CDATA_ID, tc) == CREATURE_ID_KING_SCORPION ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 108
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SCORPION | cdata(CDATA_ID, tc) == CREATURE_ID_KING_SCORPION ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 109
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WANDERING_PENGUIN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 110
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE_GIRL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 111
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE_GIRL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 112
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE_GIRL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 113
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SNAIL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 114
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_SNAIL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 115
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ELECTRIC_CLOUD | cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_CLOUD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 116
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WISP ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 117
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MOAI ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 118
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE | cdata(CDATA_ID, tc) == CREATURE_ID_EXECUTIONER | cdata(CDATA_ID, tc) == CREATURE_ID_LICH | cdata(CDATA_ID, tc) == CREATURE_ID_LESSER_MUMMY | cdata(CDATA_ID, tc) == CREATURE_ID_MUMMY | cdata(CDATA_ID, tc) == CREATURE_ID_GREATER_MUMMY | cdata(CDATA_ID, tc) == CREATURE_ID_ANCIENT_COFFIN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 119
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_KENTAURS ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 120
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CATTLE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 121
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHILD_BOAR ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 122
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHILD_BOAR ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 123
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WILD_RABBIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 124
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_WILD_RABBIT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
						if ( cdata(CDATA_SEX, tc) == 1 ) {
							evmode = 125
						}
					}
					if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
						evmode = 125
					}
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GHOST ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 126
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_NYMPH ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 127
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FLYING_FROG | cdata(CDATA_ID, tc) == CREATURE_ID_POISON_ARROW_FROG ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 128
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_AMBYSTOMA ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 129
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FAIRY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 130
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIZARD_MAN | cdata(CDATA_ID, tc) == CREATURE_ID_LIZARD_MAGE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 131
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_HARPY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 132
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_HARPY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 133
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_HALLOWEEN_NIGHTMARE | cdata(CDATA_ID, tc) == CREATURE_ID_PUMPKIN | cdata(CDATA_ID, tc) == CREATURE_ID_PUPPY | cdata(CDATA_ID, tc) == CREATURE_ID_GREATER_PUMPKIN ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 134
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_MANDRAKE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 135
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_IMP | cdata(CDATA_ID, tc) == CREATURE_ID_NETHER_IMP | cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_IMP ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 136
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_GUNFISH ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 137
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_HERMIT_CRAB ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 138
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LARGE_BIKE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 12 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 139
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_ENT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 140
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ICE_ENT ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 141
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_SEED ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 142
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_SEED ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 143
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_CATERPILLAR_SNIPER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 13 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 144
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLUE_BUBBLE | cdata(CDATA_ID, tc) == CREATURE_ID_BUBBLE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 145
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_PUPPET ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 146
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_THIEF | cdata(CDATA_ID, tc) == CREATURE_ID_ROBBER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 147
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_NURSE ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 148
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_FALLEN_SOLDIER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 149
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIVING_ARMOR | cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_MASS ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 150
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LITTLE_BOY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 15 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 151
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_LITTLE_BOY ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
					evmode = 152
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BUTLER ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 16 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 153
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_BISQUE_DOLL ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 154
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_KOBOLD ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 155
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_ORC | cdata(CDATA_ID, tc) == CREATURE_ID_ORC_WARRIOR ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 11 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 156
				}
			}
		}
		if ( cdata(CDATA_ID, tc) == CREATURE_ID_PORC ) {
			if ( inv(INV_ITEM_PARAM1, ci) == 14 ) {
				if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 0 ) {
					evmode = 157
				}
			}
		}
		if ( tc > CHARA_PLAYER & tc < MAX_CHARA_FOLLOWER ) {
			if ( cdata(CDATA_EXIST, tc) == CHAR_STATE_ALIVE ) {
				f = 1
				if ( evmode > 0 ) {
					if ( 0 != 1 ) {
						if ( cdata(CDATA_IMPRESSION, tc) < 150 ) {
							txt lang(cdatan(CDATAN_NAME, tc) + "は進化を拒絶した。", "You will need to deepen the friendship.")
							evmode = 0
							goto *turn_end
						}
					}
					txt lang("おや？" + cdatan(CDATAN_NAME, tc) + "の様子が…！？", "Oh? " + cdatan(CDATAN_NAME, tc) + "'s act strange ...")
					if ( synccheck(tc, -1) ) {
						txtef COLOR_RED
						txt lang(cdatan(CDATAN_NAME, tc) + "の変化を見守る？", "Watch " + cdatan(CDATAN_NAME, tc) + "'s change?")
					}
					promptl(0, 0) = stryes, "y", "0"
					promptl(0, 1) = strno, "n", "1"
					promptmax = 2
					val = promptx, prompty, 160, 1
					gosub *prompt_key
					if ( rtval == 0 ) {
						animeid = ANIMATION_GENE
						anic = tc
						gosub *anime
					}
					else {
						txt lang("あなたが声をかけると" + cdatan(CDATAN_NAME, tc) + "の変化は止まった…。", "Why? " + cdatan(CDATAN_NAME, tc) + "'s change stopped.")
						evmode = 0
						goto *turn_end
					}
					if ( evmode == 1 ) {
						evname = lang("猫の王女", "EV")
						evold = lang("妹猫", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(8, 17)
						skillmod SKILL_ATTR_LIFE, tc, 50000
						skillmod SKILL_ATTR_SPD, tc, 10000
					}
					if ( evmode == 2 ) {
						evname = lang("妹猫の神", "EV")
						evold = lang("妹猫", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(18, 10)
						skillmod SKILL_ATTR_SPD, tc, 100000
					}
					if ( evmode == 3 ) {
						evname = lang("ユニコーン", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LAME_HORSE ) {
							evold = lang("駄馬", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_WILD_HORSE ) {
							evold = lang("野生馬", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_NOYEL_HORSE ) {
							evold = lang("ノイエル馬", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_YOWYN_HORSE ) {
							evold = lang("ヨウィン馬", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_THOROUGHBRED ) {
							evold = lang("サラブレッド", "aaaaaaa")
						}
						cdata(CDATA_PIC, tc) = xy2pic(23, 13)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 20000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
					}
					if ( evmode == 4 ) {
						evname = lang("麒麟", "EV")
						evold = lang("キリンさん", "aaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(29, 13)
						skillmod SKILL_ATTR_SPD, tc, 35000
						skillmod SKILL_ATTR_STR, tc, 25000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 20000
					}
					if ( evmode == 5 ) {
						evname = lang("シヴァ犬", "EV")
						evold = lang("シルバーファング", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 325 + 10 * 1000
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 50000
					}
					if ( evmode == 6 ) {
						evname = lang("白虎", "EV")
						evold = lang("ネコマタ", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(19, 14)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 5000
						skillmod SKILL_ATTR_PER, tc, 5000
						skillmod SKILL_ATTR_WIL, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 200
						cdata(CDATA_WEIGHT, tc) += rnd(50) + 150
					}
					if ( evmode == 7 ) {
						evname = lang("新型武装兵", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_MACHINE_INFANTRY ) {
							evold = lang("イェルス機械兵", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_YERLES_ELITE_MACHINE_INFANTRY ) {
							evold = lang("イェルスエリート機械兵", "aaaaaaa")
						}
						cdata(CDATA_PIC, tc) = xy2pic(11, 13)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 10000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
					}
					if ( evmode == 8 ) {
						evname = lang("ミノタウロスの王者", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR ) {
							evold = lang("ミノタウロス", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_MAGICIAN ) {
							evold = lang("ミノタウロスの術士", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_BOXER ) {
							evold = lang("ミノタウロスの闘士", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MINOTAUR_KING ) {
							evold = lang("ミノタウロスの戦士", "aaaaaaa")
						}
						cdata(CDATA_PIC, tc) = 398 + 10 * 1000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 30000
						skillmod SKILL_ATTR_WIL, tc, 10000
						cbitmod CHARA_BIT_TEMPER, tc, TRUE
					}
					if ( evmode == 9 ) {
						evname = lang("アルデバラン", "EV")
						evold = lang("ミノタウロスの王者", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 656 + 5 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 50000
					}
					if ( evmode == 10 ) {
						evname = lang("ククルカン", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_COBRA ) {
							evold = lang("コブラ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KING_COBRA ) {
							evold = lang("キングコブラ", "aaaaaaa")
						}
						cdata(CDATA_PIC, tc) = xy2pic(27, 15)
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 20000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 11 ) {
						evname = lang("キンナリー", "EV")
						evold = lang("白金ガチョウ", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(5, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 10000
					}
					if ( evmode == 12 ) {
						evname = lang("大黒猫", "EV")
						evold = lang("黒猫", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(26, 15)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 200
						cdata(CDATA_WEIGHT, tc) += rnd(50) + 150
					}
					if ( evmode == 13 ) {
						evname = lang("黒猫娘", "EV")
						evold = lang("黒猫", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(6, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 20000
						cdata(CDATA_HEIGHT, tc) = rnd(50) + 120
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 30
					}
					if ( evmode == 14 ) {
						evname = lang("デスサイズ", "EV")
						evold = lang("妖精さん", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(28, 15)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 20000
						cdata(CDATA_HEIGHT, tc) = rnd(50) + 120
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 30
					}
					if ( evmode == 15 ) {
						evname = lang("ドリュアス", "EV")
						evold = lang("妖精さん", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(13, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_CON, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 20000
						cdata(CDATA_HEIGHT, tc) = rnd(50) + 120
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 30
					}
					if ( evmode == 16 ) {
						evname = lang("ガンレイザー", "EV")
						evold = lang("アンドロイド", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(30, 15)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_PER, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 200
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 300
					}
					if ( evmode == 17 ) {
						evname = lang("ガングリフ", "EV")
						evold = lang("アンドロイド", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(31, 15)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_PER, tc, 25000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 50
					}
					if ( evmode == 18 ) {
						evname = lang("黒熾天使", "EV")
						evold = lang("黒天使", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(10, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_PER, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 30000
						skillmod SKILL_ATTR_WIL, tc, 10000
					}
					if ( evmode == 19 ) {
						evname = lang("暗黒魔竜", "EV")
						evold = lang("追放者", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(32, 15)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_CON, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 20000
						skillmod SKILL_NORMAL_CONTROL_MAGIC, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 20 ) {
						evname = lang("永久追放者", "EV")
						evold = lang("追放者", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(8, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 30000
						skillmod SKILL_NORMAL_CONTROL_MAGIC, tc, 10000
					}
					if ( evmode == 21 ) {
						evname = lang("黄金聖騎士", "EV")
						evold = lang("黄金の騎士", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(9, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_STR, tc, 40000
						skillmod SKILL_ATTR_CON, tc, 10000
					}
					if ( evmode == 22 ) {
						evname = lang("絶対防衛者", "EV")
						evold = lang("防衛者", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(4, 16)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_CON, tc, 40000
						skillmod SKILL_ATTR_MAG, tc, 10000
					}
					if ( evmode == 23 ) {
						evname = lang("ロイヤルプチ", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_PUTIT ) {
							evold = lang("プチ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(21, 16)
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_RED_PUTIT ) {
							evold = lang("ベスプチ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 549 + 3 * 1000
						}
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_CHA, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 50
					}
					if ( evmode == 24 ) {
						evname = lang("鬼熊", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(23, 16)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BROWN_BEAR ) {
							evold = lang("ブラウンベア", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GRIZZLY ) {
							evold = lang("グリズリー", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 30000
					}
					if ( evmode == 25 ) {
						evname = lang("プチコマンド", "EV")
						evold = lang("軍用プチ", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 299 + 3 * 1000
						skillmod SKILL_ATTR_PER, tc, 50000
					}
					if ( evmode == 26 ) {
						evname = lang("狼王", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(15, 16)
						evold = lang("シルバーファング", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 30000
						cdata(CDATA_EVOLUTION_STAGE, tc) = 10
						cbitmod CHARA_BIT_TEMPER, tc, TRUE
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 50
					}
					if ( evmode == 27 ) {
						evname = lang("シルバーファング", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(29, 7)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_DOG ) {
							evold = lang("犬", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_HOUND ) {
							evold = lang("猟犬", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
					}
					if ( evmode == 28 ) {
						evname = lang("ネコマタ", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(28, 7)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CAT ) {
							evold = lang("猫", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SILVER_CAT ) {
							evold = lang("シルバーキャット", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_STRAY_CAT ) {
							evold = lang("迷子の子猫", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 10000
					}
					if ( evmode == 29 ) {
						evname = lang("マンティコア", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(6, 11)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CARBUNCLE ) {
							evold = lang("カーバンクル", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LION ) {
							evold = lang("ライオン", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 10000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 50
					}
					if ( evmode == 30 ) {
						evname = lang("夏姉", "EV")
						evold = lang("姉", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(24, 15)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CHA, tc, 40000
					}
					if ( evmode == 31 ) {
						evname = lang("ちび姉", "EV")
						evold = lang("姉", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(25, 16)
						skillmod SKILL_ATTR_SPD, tc, 20000
						cdata(CDATA_EVOLUTION_STAGE, tc) = 10
						cbitmod CHARA_BIT_TEMPER, tc, TRUE
						cdata(CDATA_HEIGHT, tc) = rnd(30) + 100
						cdata(CDATA_WEIGHT, tc) = rnd(5) + 25
					}
					if ( evmode == 32 ) {
						evname = lang("妹猫？", "EV")
						evold = lang("妹", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(10, 9)
						skillmod SKILL_ATTR_SPD, tc, 50000
					}
					if ( evmode == 33 ) {
						evname = lang("病妹", "EV")
						evold = lang("妹", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(6, 17)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 10000
						cdata(CDATA_EVOLUTION_STAGE, tc) = 10
						cbitmod CHARA_BIT_TEMPER, tc, TRUE
					}
					if ( evmode == 34 ) {
						evname = lang("火炎竜の成体", "EV")
						evold = lang("火炎竜の幼体", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(8, 10)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_CON, tc, 10000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 35 ) {
						evname = lang("火炎機竜", "EV")
						evold = lang("火炎竜の成体", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(27, 13)
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(500) + 500
					}
					if ( evmode == 36 ) {
						evname = lang("カブテリオン", "EV")
						evold = lang("かぶと虫", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(2, 17)
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 70000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 37 ) {
						evname = lang("ハイパービートル", "EV")
						evold = lang("ヘブンズビートル", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 40000
					}
					if ( evmode == 38 ) {
						evname = lang("ブラックドラゴン", "EV")
						evold = lang("ドラゴンゾンビ", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(12, 10)
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 10000
					}
					if ( evmode == 39 ) {
						evname = lang("オルガシズル", "EV")
						cdata(CDATA_PIC, tc) = 339 + 4 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LICH ) {
							evold = lang("リッチ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MASTER_LICH ) {
							evold = lang("マスターリッチ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_DEMI_LICH ) {
							evold = lang("デミリッチ", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_MAG, tc, 40000
					}
					if ( evmode == 40 ) {
						evname = lang("スカルビースト", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(19, 13)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_WARRIOR ) {
							evold = lang("骸骨戦士", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SKELETON_BERSERKER ) {
							evold = lang("骸骨狂戦士", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 30000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 50
					}
					if ( evmode == 41 ) {
						evname = lang("＜チェックメイター＞", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(0, 17)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_PAWN ) {
							evold = lang("＜ポーン＞", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ROOK ) {
							evold = lang("＜ルーク＞", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BISHOP ) {
							evold = lang("＜ビショップ＞", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KNIGHT ) {
							evold = lang("＜ナイト＞", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_QUEEN ) {
							evold = lang("＜クィーン＞", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KING ) {
							evold = lang("＜キング＞", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 42 ) {
						evname = lang("黄金龍虫", "EV")
						cdata(CDATA_PIC, tc) = 562 + 5 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_FIRE_CENTIPEDE ) {
							evold = lang("火炎ムカデ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CENTIPEDE ) {
							evold = lang("ムカデ", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 30000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 43 ) {
						evname = lang("ファングプラント", "fang plant")
						cdata(CDATA_PIC, tc) = 565 + 7 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MAN_EATER_FLOWER ) {
							evold = lang("人食い花", "man eater flower")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_FLOWER ) {
							evold = lang("カオスフラワー", "chaos flower")
						}
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 44 ) {
						evname = lang("セセラギ", "EV")
						cdata(CDATA_PIC, tc) = 547 + 7 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GOKIBURI ) {
							evold = lang("茶色い悪魔", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MURDER_COCKROACH ) {
							evold = lang("殺人ゴキブリ", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 40000
						skillmod SKILL_ATTR_DEX, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(50) + 50
					}
					if ( evmode == 45 ) {
						evname = lang("デュラハン", "durahan")
						cdata(CDATA_PIC, tc) = 341 + 7 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIVING_ARMOR ) {
							evold = lang("リビングアーマー", "living armor")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_MASS ) {
							evold = lang("鉄塊", "steel mass")
						}
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 20000
					}
					if ( evmode == 46 ) {
						evname = lang("姉狼", "EV")
						evold = lang("姉犬", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(26, 26)
						skillmod SKILL_ATTR_LIFE, tc, 30000
						skillmod SKILL_ATTR_SPD, tc, 10000
					}
					if ( evmode == 47 ) {
						evname = lang("アネビス", "EV")
						evold = lang("姉狼", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(11, 17)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_PER, tc, 10000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
					}
					if ( evmode == 48 ) {
						evname = lang("ナヌーク", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(7, 17)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BROWN_BEAR ) {
							evold = lang("ブラウンベア", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GRIZZLY ) {
							evold = lang("グリズリー", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 40000
						skillmod SKILL_ATTR_LIFE, tc, 30000
						resistmod tc, SKILL_RES_COLD, 50 * 10
						cdata(CDATA_EVOLUTION_STAGE, tc)++
					}
					if ( evmode == 49 ) {
						evname = lang("幼女", "EV")
						evold = lang("少女", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(12, 17)
						skillmod SKILL_ATTR_CHA, tc, 10000
						cdata(CDATA_HEIGHT, tc) = rnd(30) + 100
						cdata(CDATA_WEIGHT, tc) = rnd(5) + 25
					}
					if ( evmode == 50 ) {
						evname = lang("吸血嬢", "EV")
						evold = lang("白お嬢様", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(13, 17)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 20000
						cbitmod CHARA_BIT_CURE_BLEEDING, tc, TRUE
					}
					if ( evmode == 51 ) {
						evname = lang("白お嬢様", "EV")
						evold = lang("嬢", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(27, 2)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 20000
					}
					if ( evmode == 52 ) {
						evname = lang("魔女", "EV")
						evold = lang("幼女", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(14, 17)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 40000
						skillmod SKILL_NORMAL_CASTING, tc, 20000
					}
					if ( evmode == 53 ) {
						evname = lang("量産型メルガスト", "EV")
						evold = lang("イェルス自律型飛行ユニット", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(19, 17)
						skillmod SKILL_ATTR_SPD, tc, 50000
						skillmod SKILL_ATTR_PER, tc, 40000
					}
					if ( evmode == 54 ) {
						evname = lang("ゼイレン人型戦車", "Xeren humanoid tank")
						evold = lang("ゼイレン自動軽戦車", "Xeren auto tank")
						cdata(CDATA_PIC, tc) = 349 + 9 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_PER, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(20) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(100) + 150
					}
					if ( evmode == 55 ) {
						evname = lang("グリフォン", "EV")
						evold = lang("仔グリフォン", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(10, 17)
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 20000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
						cdata(CDATA_HEIGHT, tc) += rnd(100) + 500
						cdata(CDATA_WEIGHT, tc) += rnd(100) + 500
					}
					if ( evmode == 56 ) {
						evname = lang("メシェーラ・ソルダード", "EV")
						evold = lang("同化兵", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 460 + 7 * 1000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_PER, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(100) + 200
						cdata(CDATA_WEIGHT, tc) += rnd(100) + 200
						txtef COLOR_PURPLE
						txt lang("「ぎゃああアアアアアッ！」", cnvtalk("Gyaaaaaaa!"))
					}
					if ( evmode == 57 ) {
						evname = lang("コーヒープリンの精霊", "EV")
						evold = lang("プリンの精霊", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 467 + 7 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						resistmod tc, SKILL_RES_MAGIC, 50 * 10
					}
					if ( evmode == 58 ) {
						evname = lang("ハイスピリット", "EV")
						evold = lang("スピリット", "aaaaaaa")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_WAR_SPIRIT ) {
							if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
								if ( cdata(CDATA_SEX, tc) == 0 ) {
									cdata(CDATA_PIC, tc) = 303 + 17 * 1000
								}
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
								cdata(CDATA_PIC, tc) = 303 + 17 * 1000
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
								if ( cdata(CDATA_SEX, tc) == 1 ) {
									cdata(CDATA_PIC, tc) = 304 + 17 * 1000
								}
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
								cdata(CDATA_PIC, tc) = 304 + 17 * 1000
							}
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MAGIC_SPIRIT ) {
							if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
								if ( cdata(CDATA_SEX, tc) == 0 ) {
									cdata(CDATA_PIC, tc) = 305 + 18 * 1000
								}
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
								cdata(CDATA_PIC, tc) = 305 + 18 * 1000
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
								if ( cdata(CDATA_SEX, tc) == 1 ) {
									cdata(CDATA_PIC, tc) = 306 + 18 * 1000
								}
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
								cdata(CDATA_PIC, tc) = 306 + 18 * 1000
							}
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GUN_SPIRIT ) {
							if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
								if ( cdata(CDATA_SEX, tc) == 0 ) {
									cdata(CDATA_PIC, tc) = 96 + 16 * 1000
								}
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
								cdata(CDATA_PIC, tc) = 96 + 16 * 1000
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
								if ( cdata(CDATA_SEX, tc) == 1 ) {
									cdata(CDATA_PIC, tc) = 97 + 16 * 1000
								}
							}
							if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
								cdata(CDATA_PIC, tc) = 97 + 16 * 1000
							}
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						resistmod tc, SKILL_RES_MAGIC, 50 * 10
					}
					if ( evmode == 59 ) {
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MEDUSA ) {
							evname = lang("メデューサ・アンカースド", "EV")
							evold = lang("メデューサ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(5, 18)
							skillmod SKILL_ATTR_SPD, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_EURYALE ) {
							evname = lang("エウリュアレ・アンカースド", "EV")
							evold = lang("エウリュアレ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 599 + 5 * 1000
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_STHENO ) {
							evname = lang("ステンノ・アンカースド", "EV")
							evold = lang("ステンノ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 599 + 16 * 1000
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						skillmod SKILL_ATTR_CHA, tc, 30000
					}
					if ( evmode == 60 ) {
						evname = lang("撃龍人", "EV")
						evold = lang("リザードマン", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 588 + 2 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_PER, tc, 20000
					}
					if ( evmode == 61 ) {
						evname = lang("ラタトスク", "EV")
						cdata(CDATA_PIC, tc) = 204 + 7 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GIANT_SQUIRREL ) {
							evold = lang("巨大リス", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KILLER_SQUIRREL ) {
							evold = lang("殺人リス", "aaaaaaa")
						}
						skillmod SKILL_ATTR_SPD, tc, 30000
					}
					if ( evmode == 62 ) {
						evname = lang("凍気の巨人", "EV")
						cdata(CDATA_PIC, tc) = 351 + 4 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CYCLOPS ) {
							evold = lang("サイクロプス", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_TITAN ) {
							evold = lang("タイタン", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						skillmod SKILL_ATTR_CON, tc, 30000
					}
					if ( evmode == 63 ) {
						evname = lang("黒ファントム", "EV")
						evold = lang("レッサーファントム", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 226 + 7 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 10000
					}
					if ( evmode == 64 ) {
						evname = lang("『ビッグシスター』", "EV")
						evold = lang("『リトルシスター』", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(18, 9)
						skillmod SKILL_ATTR_SPD, tc, 60000
						cdata(CDATA_HEIGHT, tc) = rnd(30) + 140
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 40
					}
					if ( evmode == 65 ) {
						evname = lang("電気竜", "EV")
						evold = lang("電気羊", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 233 + 5 * 1000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 30000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 66 ) {
						evname = lang("バフォメット", "EV")
						evold = lang("羊", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(30, 17)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 50
					}
					if ( evmode == 67 ) {
						evname = lang("ロードキューピッド", "lord cupid")
						evold = lang("恋のキューピッド", "cupid of love")
						cdata(CDATA_PIC, tc) = xy2pic(5, 26)
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_PER, tc, 30000
					}
					if ( evmode == 68 ) {
						evname = lang("はぐれ天使", "angel astray")
						evold = lang("見習い天使", "apprentice angel")
						cdata(CDATA_PIC, tc) = 862 + 6 * 1000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) = rnd(30) + 140
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 30
					}
					if ( evmode == 69 ) {
						evname = lang("戦乙女", "EV")
						evold = lang("少女", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(15, 18)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 10000
						cdata(CDATA_EVOLUTION_STAGE, tc) += 2
					}
					if ( evmode == 70 ) {
						evname = lang("爆弾黒水晶", "EV")
						evold = lang("爆弾岩", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 524 + 7 * 1000
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 40000
					}
					if ( evmode == 71 ) {
						evname = lang("イークインペリアル", "EV")
						cdata(CDATA_PIC, tc) = 381 + 5 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_YEEK ) {
							evold = lang("イーク", "aaaaaaa")
							skillmod SKILL_ATTR_LIFE, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_YEEK_WARRIOR ) {
							evold = lang("イークの戦士", "aaaaaaa")
							skillmod SKILL_ATTR_STR, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_YEEK_ARCHER ) {
							evold = lang("イークの射手", "aaaaaaa")
							skillmod SKILL_ATTR_PER, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MASTER_YEEK ) {
							evold = lang("マスター・イーク", "aaaaaaa")
							skillmod SKILL_ATTR_MAG, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KAMIKAZE_YEEK ) {
							evold = lang("カミカゼ・イーク", "aaaaaaa")
							skillmod SKILL_ATTR_CON, tc, 30000
						}
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_DEX, tc, 10000
					}
					if ( evmode == 72 ) {
						evname = lang("エレクトリカルマウス", "EV")
						cdata(CDATA_PIC, tc) = 255 + 5 * 1000
						evold = lang("ネズミ", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 30000
						cdata(CDATA_EVOLUTION_STAGE, tc)++
					}
					if ( evmode == 73 ) {
						evname = lang("スライムノイド", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SLIME ) {
							evold = lang("スライム", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
							cdata(CDATA_PIC, tc) = 611 + 4 * 1000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ACID_SLIME ) {
							evold = lang("弱酸性スライム", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
							cdata(CDATA_PIC, tc) = 611 + 2 * 1000
						}
						skillmod SKILL_ATTR_WIL, tc, 30000
						skillmod SKILL_ATTR_LER, tc, 10000
						cdata(CDATA_HEIGHT, tc) = rnd(30) + 140
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 20
					}
					if ( evmode == 74 ) {
						evname = lang("スライムローパー", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SLIME ) {
							evold = lang("スライム", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
							cdata(CDATA_PIC, tc) = 613 + 4 * 1000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ACID_SLIME ) {
							evold = lang("弱酸性スライム", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
							cdata(CDATA_PIC, tc) = 613 + 2 * 1000
						}
						skillmod SKILL_ATTR_DEX, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) = rnd(30) + 160
						cdata(CDATA_WEIGHT, tc) = rnd(20) + 20
					}
					if ( evmode == 75 ) {
						evname = lang("女王エイリアン", "EV")
						evold = lang("エイリアン", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 10000
						cdata(CDATA_PIC, tc) = 643 + 17 * 1000
						cdata(CDATA_ELEMENT, tc) += 200
						skillmod SKILL_ATTR_STR, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 20000
					}
					if ( evmode == 76 ) {
						evname = lang("逝眼の白骨龍", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(20, 13)
						evold = lang("スカルビースト", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 40000
						skillmod SKILL_ATTR_DEX, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 77 ) {
						evname = lang("究極ひよこ", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(20, 18)
						evold = lang("鶏", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 10000
						skillmod SKILL_ATTR_CHA, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(5) + 5
						cdata(CDATA_WEIGHT, tc) = 0
					}
					if ( evmode == 78 ) {
						evname = lang("装甲機兵", "EV")
						evold = lang("新型武装兵", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(5, 17)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_PER, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_LER, tc, 10000
					}
					if ( evmode == 79 ) {
						evname = lang("コボルト", "EV")
						evold = lang("トゥーンコボルト", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(20, 10)
						skillmod SKILL_ATTR_SPD, tc, 15000
						skillmod SKILL_ATTR_CON, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_LIFE, tc, 10000
					}
					if ( evmode == 80 ) {
						evname = lang("デンジャラスブレイド", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLADE ) {
							evold = lang("ブレイド", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(24, 18)
							cdata(CDATA_ELEMENT, tc) += 300
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLADE_ALPHA ) {
							evold = lang("ブレイドβ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 618 + 17 * 1000
							cdata(CDATA_ELEMENT, tc) += 250
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLADE_OMEGA ) {
							evold = lang("ブレイドΩ", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 618 + 3 * 1000
							cdata(CDATA_ELEMENT, tc) += 200
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 30000
					}
					if ( evmode == 81 ) {
						evname = lang("ダークソウル", "EV")
						cdata(CDATA_PIC, tc) = 272 + 7 * 1000
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ELECTRIC_CLOUD ) {
							evold = lang("放電雲", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_CLOUD ) {
							evold = lang("混沌の塊", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_WISP ) {
							evold = lang("ウィスプ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 30000
						}
						skillmod SKILL_ATTR_MAG, tc, 30000
						resistmod tc, SKILL_RES_DARKNESS, 50 * 10
					}
					if ( evmode == 82 ) {
						evname = lang("弟火狐", "EV")
						evold = lang("弟狐", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(27, 18)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						cdata(CDATA_EVOLUTION_STAGE, tc) += 2
						resistmod tc, SKILL_RES_FIRE, 50 * 10
					}
					if ( evmode == 83 ) {
						evname = lang("弟九尾", "EV")
						evold = lang("弟狐", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(23, 18)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 25000
						skillmod SKILL_ATTR_LIFE, tc, 30000
					}
					if ( evmode == 84 ) {
						evname = lang("ヤドナシ", "homeless crab")
						cdata(CDATA_PIC, tc) = 638 + 3 * 1000
						evold = lang("やどかり", "hermit crab")
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 30000
						cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(5000) + 5000
					}
					if ( evmode == 85 ) {
						evname = lang("機甲軍用プチ", "EV")
						evold = lang("プチコマンド", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(0, 22)
						skillmod SKILL_ATTR_LIFE, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
					}
					if ( evmode == 86 ) {
						evname = lang("無邪気な戦士", "EV")
						evold = lang("無邪気な少女", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(18, 15)
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_CON, tc, 10000
					}
					if ( evmode == 87 ) {
						evname = lang("翻弄するエレアの戦士", "EV")
						evold = lang("エレアの戦士", "aaaaaaa")
						if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
							if ( cdata(CDATA_SEX, tc) == 0 ) {
								cdata(CDATA_PIC, tc) = xy2pic(4, 19)
							}
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
							cdata(CDATA_PIC, tc) = xy2pic(4, 19)
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
							if ( cdata(CDATA_SEX, tc) == 1 ) {
								cdata(CDATA_PIC, tc) = xy2pic(3, 22)
							}
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
							cdata(CDATA_PIC, tc) = xy2pic(3, 22)
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
					}
					if ( evmode == 88 ) {
						evname = lang("エレアの魔法学者", "EV")
						evold = lang("エレアの魔術士", "aaaaaaa")
						if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
							if ( cdata(CDATA_SEX, tc) == 0 ) {
								cdata(CDATA_PIC, tc) = xy2pic(6, 19)
							}
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
							cdata(CDATA_PIC, tc) = xy2pic(6, 19)
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
							if ( cdata(CDATA_SEX, tc) == 1 ) {
								cdata(CDATA_PIC, tc) = xy2pic(2, 22)
							}
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
							cdata(CDATA_PIC, tc) = xy2pic(2, 22)
						}
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 40000
					}
					if ( evmode == 89 ) {
						evname = lang("火鼠", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(7, 22)
						evold = lang("ネズミ", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						resistmod tc, SKILL_RES_FIRE, 50 * 10
					}
					if ( evmode == 90 ) {
						evname = lang("ハロウィン・ナイトヘッド", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GRUDGE ) {
							evold = lang("怨念", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 732 + 3 * 1000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_HUNGRY_DEMON ) {
							evold = lang("餓鬼", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 732 + 2 * 1000
						}
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_CON, tc, 30000
					}
					if ( evmode == 91 ) {
						evname = lang("ソウルビー", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_WASP ) {
							evold = lang("ワスプ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
							cdata(CDATA_PIC, tc) = xy2pic(10, 22)
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_RED_WASP ) {
							evold = lang("レッドワスプ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 15000
							cdata(CDATA_PIC, tc) = 736 + 3 * 1000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_HORNET ) {
							evold = lang("ブラックホーネット", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 736 + 7 * 1000
						}
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
						resistmod tc, SKILL_RES_MAGIC, 50 * 10
					}
					if ( evmode == 92 ) {
						evname = lang("マッシュルーマン", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(11, 22)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MUSHROOM ) {
							evold = lang("きのこ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SPORE_MUSHROOM ) {
							evold = lang("胞子きのこ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_MUSHROOM ) {
							evold = lang("混沌きのこ", "aaaaaaa")
						}
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 20000
					}
					if ( evmode == 93 ) {
						evname = lang("ラミア", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(12, 22)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_COBRA ) {
							evold = lang("コブラ", "aaaaaaa")
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KING_COBRA ) {
							evold = lang("キングコブラ", "aaaaaaa")
						}
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 30000
					}
					if ( evmode == 94 ) {
						evname = lang("スプレッド・ワイバーン", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(13, 19)
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_WYVERN ) {
							evold = lang("ワイバーン", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_VALIANT_WYVERN ) {
							evold = lang("バリアント・ワイバーン", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
					}
					if ( evmode == 95 ) {
						evname = lang("決闘蟹", "EV")
						cdata(CDATA_PIC, tc) = 237 + 4 * 1000
						evold = lang("火蟹", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 50000
					}
					if ( evmode == 96 ) {
						evname = lang("ジューア魔鎧戦士", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_JUERE_INFANTRY ) {
							evold = lang("ジューア歩兵", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(14, 22)
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_JUERE_SWORDMAN ) {
							evold = lang("ジューア剣闘士", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 740 + 4 * 1000
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
					}
					if ( evmode == 97 ) {
						evname = lang("カブ=トライズ", "EV")
						cdata(CDATA_PIC, tc) = xy2pic(15, 22)
						evold = lang("カブ", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(20) + 50
						cdata(CDATA_WEIGHT, tc) += rnd(50) + 150
					}
					if ( evmode == 98 ) {
						evname = lang("モーニングスター", "EV")
						evold = lang("ハムスター", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_WEAPON_BLUNT, tc, 20000
					}
					if ( evmode == 99 ) {
						evname = lang("華炎輝竜", "EV")
						evold = lang("火炎機竜", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(18, 17)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 50
					}
					if ( evmode == 100 ) {
						evname = lang("ダークネス", "EV")
						evold = lang("黒ファントム", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 648 + 7 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
					}
					if ( evmode == 101 ) {
						evname = lang("ベアーガ", "EV")
						if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 1 ) {
							evold = lang("鬼熊", "aaaaaaa")
							skillmod SKILL_NORMAL_TACTICS, tc, 10000
							cdata(CDATA_PIC, tc) = 778 + 22 * 1000
						}
						if ( cdata(CDATA_EVOLUTION_STAGE, tc) == 2 ) {
							evold = lang("ナヌーク", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(19, 23)
						}
						cdata(CDATA_EVOLUTION_STAGE, tc) = 3
						skillmod SKILL_ATTR_SPD, tc, 5000
						skillmod SKILL_ATTR_STR, tc, 20000
						resistmod tc, SKILL_RES_MAGIC, 50 * 10
					}
					if ( evmode == 102 ) {
						evname = lang("キャッスルゴーレム", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SMALL_WOODEN_GOLEM ) {
							evold = lang("ちびウッドゴーレム", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 651 + 6 * 1000
							cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
							cdata(CDATA_WEIGHT, tc) += rnd(5000) + 15000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SMALL_STONE_GOLEM ) {
							evold = lang("ちびストーンゴーレム", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(24, 19)
							cdata(CDATA_HEIGHT, tc) += rnd(500) + 1000
							cdata(CDATA_WEIGHT, tc) += rnd(5000) + 15000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_WOODEN_GOLEM ) {
							evold = lang("ウッドゴーレム", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 651 + 6 * 1000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_STONE_GOLEM ) {
							evold = lang("ストーンゴーレム", "aaaaaaa")
							cdata(CDATA_PIC, tc) = xy2pic(24, 19)
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_GOLEM ) {
							evold = lang("スティールゴーレム", "aaaaaaa")
							cdata(CDATA_PIC, tc) = 651 + 7 * 1000
						}
						skillmod SKILL_ATTR_SPD, tc, 5000
						skillmod SKILL_ATTR_CON, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 10000
					}
					if ( evmode == 103 ) {
						evname = lang("究極キャッスルゴーレム", "EV")
						evold = lang("キャッスルゴーレム", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 651 + 4 * 1000
						cdata(CDATA_HEIGHT, tc) += rnd(100) + 500
						cdata(CDATA_WEIGHT, tc) += rnd(2000) + 10000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 10000
					}
					if ( evmode == 104 ) {
						evname = lang("灼銅大蜘蛛", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SPIDER ) {
							evold = lang("まだら蜘蛛", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 35000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLACK_WIDOW ) {
							evold = lang("ブラックウィドウ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 25000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_PARALYZER ) {
							evold = lang("パラライザー", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 15000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_TARANTULA ) {
							evold = lang("タランチュラ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLOOD_SPIDER ) {
							evold = lang("吸血蜘蛛", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						cdata(CDATA_PIC, tc) = 787 + 10 * 1000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 200
						cdata(CDATA_WEIGHT, tc) += rnd(30) + 100
						skillmod SKILL_ATTR_CON, tc, 20000
					}
					if ( evmode == 105 ) {
						evname = lang("赤の守護獣", "EV")
						evold = lang("ティラノサウルス", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 652 + 3 * 1000
						cdata(CDATA_HEIGHT, tc) += rnd(100) + 500
						cdata(CDATA_WEIGHT, tc) += rnd(2000) + 10000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 30000
						resistmod tc, SKILL_RES_FIRE, 50 * 10
					}
					if ( evmode == 106 ) {
						evname = lang("暗黒ティラノ", "EV")
						evold = lang("ティラノサウルス", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 389 + 7 * 1000
						cdata(CDATA_HEIGHT, tc) += rnd(100) + 500
						cdata(CDATA_WEIGHT, tc) += rnd(2000) + 10000
						skillmod SKILL_ATTR_SPD, tc, 40000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
						resistmod tc, SKILL_RES_DARKNESS, 50 * 10
					}
					if ( evmode == 107 ) {
						evname = lang("灼銅のアラクニーダ", "EV")
						evold = lang("灼銅大蜘蛛", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 790 + 10 * 1000
						skillmod SKILL_ATTR_CHA, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 30000
					}
					if ( evmode == 108 ) {
						evname = lang("凄銅大蠍", "EV")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_SCORPION ) {
							evold = lang("サソリ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 35000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_KING_SCORPION ) {
							evold = lang("ダイオウサソリ", "aaaaaaa")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						cdata(CDATA_PIC, tc) = 629 + 19 * 1000
						skillmod SKILL_ATTR_STR, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 200
						cdata(CDATA_WEIGHT, tc) += rnd(30) + 100
					}
					if ( evmode == 109 ) {
						evname = lang("凄銅のアラクニーダ", "EV")
						evold = lang("凄銅大蠍", "aaaaaaa")
						cdata(CDATA_PIC, tc) = 790 + 9 * 1000
						skillmod SKILL_ATTR_CHA, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 30000
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
					}
					if ( evmode == 110 ) {
						evname = lang("大王ペンギン", "EV")
						evold = lang("放浪ペンギン", "aaaaaaa")
						cdata(CDATA_PIC, tc) = xy2pic(8, 25)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 10000
					}
					if ( evmode == 111 ) {
						evname = lang("ステーシー", "stacy")
						evold = lang("ゾンビ少女", "zombie girl")
						cdata(CDATA_PIC, tc) = 835 + 13 * 1000
						skillmod SKILL_ATTR_SPD, tc, 15000
						skillmod SKILL_ATTR_LIFE, tc, 15000
					}
					if ( evmode == 112 ) {
						evname = lang("ロマネスク", "romanesque")
						evold = lang("ゾンビ少女", "zombie girl")
						cdata(CDATA_PIC, tc) = xy2pic(10, 25)
						cdata(CDATA_EVOLUTION_STAGE, tc)++
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
					}
					if ( evmode == 113 ) {
						evname = lang("タナトス", "thanatos")
						evold = lang("ゾンビ少女", "zombie girl")
						cdata(CDATA_PIC, tc) = 835 + 10 * 1000
						cdata(CDATA_EVOLUTION_STAGE, tc) += 2
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 25000
					}
					if ( evmode == 114 ) {
						evname = lang("なめくじ", "slug")
						evold = lang("かたつむり", "snail")
						cdata(CDATA_PIC, tc) = 837 + 6 * 1000
						skillmod SKILL_ATTR_SPD, tc, 5000
					}
					if ( evmode == 115 ) {
						evname = lang("メタルスラッグ", "metalslug")
						evold = lang("なめくじ", "slug")
						cdata(CDATA_PIC, tc) = xy2pic(13, 25)
						skillmod SKILL_ATTR_SPD, tc, 5000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_PER, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 80
						cbitmod CHARA_BIT_ARMOUR, tc, TRUE
					}
					if ( evmode == 116 ) {
						evname = lang("混沌の雷雲龍", "EV")
						evold = lang("ダークソウル", "aaaaaaa")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ELECTRIC_CLOUD ) {
							resistmod tc, SKILL_RES_CHAOS, 50 * 10
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_CLOUD ) {
							resistmod tc, SKILL_RES_LIGHTNING, 50 * 10
						}
						skillmod SKILL_ATTR_SPD, tc, 25000
						skillmod SKILL_ATTR_MAG, tc, 20000
						cdata(CDATA_PIC, tc) = 654 + 7 * 1000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 300
						cdata(CDATA_WEIGHT, tc) += rnd(10) + 5
					}
					if ( evmode == 117 ) {
						evname = lang("ウィルオーガ", "EV")
						evold = lang("ダークソウル", "aaaaaaa")
						skillmod SKILL_ATTR_SPD, tc, 15000
						skillmod SKILL_ATTR_MAG, tc, 30000
						cdata(CDATA_PIC, tc) = 843 + 4 * 1000
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 50
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 20
					}
					if ( evmode == 118 ) {
						evname = lang("クロスモアイ", "cross moai")
						evold = lang("モアイ", "moai")
						skillmod SKILL_ATTR_SPD, tc, 15000
						skillmod SKILL_ATTR_CON, tc, 15000
						skillmod SKILL_ATTR_PER, tc, 20000
						cdata(CDATA_PIC, tc) = xy2pic(16, 25)
						cdata(CDATA_HEIGHT, tc) += rnd(100) + 500
						cdata(CDATA_WEIGHT, tc) += rnd(200) + 2000
					}
					if ( evmode == 119 ) {
						evname = lang("ネクロキマイラ", "necro chimera")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ZOMBIE ) {
							evold = lang("ゾンビ", "zombie")
							skillmod SKILL_ATTR_STR, tc, 25000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_EXECUTIONER ) {
							evold = lang("死刑執行人", "executioner")
							skillmod SKILL_ATTR_MAG, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LICH ) {
							evold = lang("リッチ", "lich")
							skillmod SKILL_ATTR_MAG, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LESSER_MUMMY ) {
							evold = lang("レッサーマミー", "lesser mummy")
							skillmod SKILL_ATTR_WIL, tc, 25000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_MUMMY ) {
							evold = lang("マミー", "mummy")
							skillmod SKILL_ATTR_WIL, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GREATER_MUMMY ) {
							evold = lang("グレイターマミー", "greater mummy")
							skillmod SKILL_ATTR_WIL, tc, 15000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ANCIENT_COFFIN ) {
							evold = lang("古代の棺", "ancient coffin")
							skillmod SKILL_ATTR_DEX, tc, 20000
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						cdata(CDATA_PIC, tc) = xy2pic(15, 25)
					}
					if ( evmode == 120 ) {
						evname = lang("疾風の銀騎", "silver kentaurs")
						evold = lang("ケンタウロス", "kentaurs")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						cdata(CDATA_PIC, tc) = xy2pic(21, 25)
						cdata(CDATA_WEIGHT, tc) += 10
					}
					if ( evmode == 121 ) {
						evname = lang("暴牛神", "divine cattle")
						evold = lang("牛", "cattle")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						cdata(CDATA_PIC, tc) = 848 + 7 * 1000
					}
					if ( evmode == 122 ) {
						evname = lang("イノブタ", "pig boar")
						evold = lang("うりぼう", "child boar")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						cdata(CDATA_PIC, tc) = 847 + 24 * 1000
					}
					if ( evmode == 123 ) {
						evname = lang("ビッグピッグ", "big pig")
						evold = lang("イノブタ", "pig boar")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 15000
						skillmod SKILL_ATTR_DEX, tc, 15000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						cdata(CDATA_PIC, tc) = xy2pic(22, 25)
					}
					if ( evmode == 124 ) {
						evname = lang("真紅眼の白兎", "red-eyes w.rabbit")
						evold = lang("野うさぎ", "rabbit")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						cdata(CDATA_PIC, tc) = xy2pic(27, 25)
					}
					if ( evmode == 125 ) {
						evname = lang("シルバニー", "sylbunny")
						evold = lang("野うさぎ", "rabbit")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_CHA, tc, 10000
						cdata(CDATA_PIC, tc) = xy2pic(32, 23)
						cdata(CDATA_EVOLUTION_STAGE, tc)++
					}
					if ( evmode == 126 ) {
						evname = lang("亡霊姫", "ghost princess")
						evold = lang("亡霊", "ghost")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_CHA, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 20000
						cdata(CDATA_PIC, tc) = xy2pic(0, 25)
					}
					if ( evmode == 127 ) {
						evname = lang("ローレライ", "loreley")
						evold = lang("ニンフ", "nymph")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_CHA, tc, 10000
						skillmod SKILL_ATTR_MAG, tc, 30000
						cdata(CDATA_PIC, tc) = 825 + 5 * 1000
					}
					if ( evmode == 128 ) {
						evname = lang("フロッグンローラー", "frognrolla")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_FLYING_FROG ) {
							evold = lang("飛び蛙", "flying frog")
							skillmod SKILL_ATTR_SPD, tc, 35000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_POISON_ARROW_FROG ) {
							evold = lang("毒矢蛙", "poison arrow frog")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						cdata(CDATA_PIC, tc) = xy2pic(1, 26)
						skillmod SKILL_ATTR_PER, tc, 20000
						skillmod SKILL_ATTR_CHA, tc, 20000
					}
					if ( evmode == 129 ) {
						evname = lang("メガサラマンダー", "salamander")
						evold = lang("メルカサラマンダー", "ambystoma")
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_LIFE, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 30000
						cdata(CDATA_PIC, tc) = xy2pic(2, 26)
						cdata(CDATA_HEIGHT, tc) += rnd(50) + 300
						cdata(CDATA_WEIGHT, tc) += rnd(20) + 200
					}
					if ( evmode == 130 ) {
						evname = lang("マグナ・フェアリ", "magna fairy")
						evold = lang("妖精", "fairy")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_LIFE, tc, 30000
						skillmod SKILL_ATTR_MAG, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 20000
						cdata(CDATA_PIC, tc) = xy2pic(9, 26)
					}
					if ( evmode == 131 ) {
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIZARD_MAN ) {
							evname = lang("リザードマジェスティ", "lizard majesty")
							evold = lang("リザードマン", "lizard man")
							skillmod SKILL_ATTR_SPD, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIZARD_MAGE ) {
							evname = lang("リザードマジェスティ", "lizard majesty")
							evold = lang("リザードメイジ", "lizard mage")
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
						cdata(CDATA_PIC, tc) = 869 + 25 * 1000
					}
					if ( evmode == 132 ) {
						evname = lang("フレアチック", "flare chick")
						evold = lang("ハーピー", "harpy")
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) = rnd(20) + 110
						cdata(CDATA_WEIGHT, tc) = rnd(10) + 20
						cdata(CDATA_PIC, tc) = xy2pic(14, 26)
					}
					if ( evmode == 133 ) {
						evname = lang("フェニキシアン", "phoenixian")
						evold = lang("フレアチック", "flare chick")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_LIFE, tc, 25000
						skillmod SKILL_ATTR_STR, tc, 20000
						cdata(CDATA_HEIGHT, tc) = rnd(40) + 130
						cdata(CDATA_WEIGHT, tc) = rnd(10) + 35
						resistmod tc, SKILL_RES_FIRE, 50 * 10
						cdata(CDATA_PIC, tc) = xy2pic(13, 26)
					}
					if ( evmode == 134 ) {
						evname = lang("ジャック王", "jack-king")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_PUPPY ) {
							evold = lang("パピー", "puppy")
							cdata(CDATA_PIC, tc) = 896 + 5 * 1000
							skillmod SKILL_ATTR_SPD, tc, 35000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_PUMPKIN ) {
							evold = lang("パンプキン", "pumpkin")
							cdata(CDATA_PIC, tc) = xy2pic(5, 27)
							skillmod SKILL_ATTR_SPD, tc, 30000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_GREATER_PUMPKIN ) {
							evold = lang("南瓜の怪物", "greater pumpkin")
							cdata(CDATA_PIC, tc) = 896 + 4 * 1000
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_HALLOWEEN_NIGHTMARE ) {
							evold = lang("ハロウィンナイトメア", "halloween nightmare")
							cdata(CDATA_PIC, tc) = 896 + 3 * 1000
						}
						skillmod SKILL_ATTR_LIFE, tc, 30000
						skillmod SKILL_ATTR_CON, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 20000
						cdata(CDATA_HEIGHT, tc) += rnd(20) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(50) + 150
					}
					if ( evmode == 135 ) {
						evname = lang("ソードマンドレイク", "swordmandrake")
						evold = lang("マンドレイク", "mandrake")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_MANA, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						cdata(CDATA_PIC, tc) = 894 + 8 * 1000
					}
					if ( evmode == 136 ) {
						evname = lang("グレートインプ", "great imp")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_IMP ) {
							evold = lang("インプ", "imp")
							skillmod SKILL_ATTR_SPD, tc, 35000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_NETHER_IMP ) {
							evold = lang("冥界の使い", "nether imp")
							skillmod SKILL_ATTR_SPD, tc, 25000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_CHAOS_IMP ) {
							evold = lang("カオスインプ", "chaos imp")
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						cdata(CDATA_PIC, tc) = 212 + 5 * 1000
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 20000
					}
					if ( evmode == 137 ) {
						evname = lang("スペースマンボウガン", "zap gunfish")
						evold = lang("マンボウガン", "gunfish")
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_PER, tc, 30000
						skillmod SKILL_ATTR_DEX, tc, 20000
						cdata(CDATA_PIC, tc) = 902 + 9 * 1000
					}
					if ( evmode == 138 ) {
						evname = lang("マイホーマー", "landlord crab")
						evold = lang("ヤドナシ", "homeless crab")
						cdata(CDATA_PIC, tc) = 256 + 25 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 20000
						cbitmod CHARA_BIT_ARMOUR, tc, TRUE
					}
					if ( evmode == 139 ) {
						evname = lang("マシンストーム", "machine storm")
						evold = lang("大型バイク", "large bike")
						cdata(CDATA_PIC, tc) = 890 + 2 * 1000
						skillmod SKILL_ATTR_SPD, tc, 75000
					}
					if ( evmode == 140 ) {
						evname = lang("紅葉竜樹", "maple dragon tree")
						evold = lang("火炎樹", "fire ent")
						cdata(CDATA_PIC, tc) = 928 + 3 * 1000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_CON, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 10000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
					}
					if ( evmode == 141 ) {
						evname = lang("雪葉竜樹", "snow dragon tree")
						evold = lang("氷結樹", "ice ent")
						cdata(CDATA_PIC, tc) = xy2pic(4, 28)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_DEX, tc, 10000
						skillmod SKILL_ATTR_PER, tc, 10000
						cbitmod CHARA_BIT_FLOAT, tc, TRUE
					}
					if ( evmode == 142 ) {
						evname = lang("カオス・スプラウト", "chaos sprout")
						evold = lang("カオス・シード", "chaos seed")
						if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
							if ( cdata(CDATA_SEX, tc) == 0 ) {
								cdata(CDATA_PIC, tc) = xy2pic(22, 15)
							}
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == lang("男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("自称男性", "male") | cdatan(CDATAN_NEWSEX, tc) == lang("なし", "none") ) {
							cdata(CDATA_PIC, tc) = xy2pic(22, 15)
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == "" ) {
							if ( cdata(CDATA_SEX, tc) == 1 ) {
								cdata(CDATA_PIC, tc) = xy2pic(23, 15)
							}
						}
						if ( cdatan(CDATAN_NEWSEX, tc) == lang("女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("自称女性", "female") | cdatan(CDATAN_NEWSEX, tc) == lang("両性具有", "bisexual") ) {
							cdata(CDATA_PIC, tc) = xy2pic(23, 15)
						}
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_CON, tc, 10000
						cdata(CDATA_HEIGHT, tc) += rnd(20) + 100
						cdata(CDATA_WEIGHT, tc) += rnd(10) + 30
					}
					if ( evmode == 143 ) {
						evname = lang("カオス・プラント", "chaos plant")
						evold = lang("カオス・スプラウト", "chaos sprout")
						cdata(CDATA_PIC, tc) = xy2pic(6, 28)
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_DEX, tc, 15000
						skillmod SKILL_ATTR_CON, tc, 15000
						cdata(CDATA_HEIGHT, tc) += rnd(200) + 1000
						cdata(CDATA_WEIGHT, tc) += rnd(1000) + 5000
					}
					if ( evmode == 144 ) {
						evname = lang("天虫", "god moth")
						evold = lang("芋虫スナイパー", "caterpillar sniper")
						cdata(CDATA_PIC, tc) = xy2pic(14, 30)
						skillmod SKILL_ATTR_LIFE, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 30000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_DEX, tc, 15000
						cdata(CDATA_HEIGHT, tc) += 5
					}
					if ( evmode == 145 ) {
						evname = lang("ボブルバブル", "bobble bubble")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BLUE_BUBBLE ) {
							evold = lang("ブルーバブル", "blue bubble")
							cdata(CDATA_PIC, tc) = 336 + 4 * 1000
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_BUBBLE ) {
							evold = lang("バブル", "bubble")
							cdata(CDATA_PIC, tc) = xy2pic(6, 10)
							skillmod SKILL_ATTR_SPD, tc, 20000
						}
						skillmod SKILL_ATTR_LIFE, tc, 20000
						skillmod SKILL_NORMAL_CASTING, tc, 10000
						skillmod SKILL_NORMAL_CONTROL_MAGIC, tc, 10000
						cdata(CDATA_HEIGHT, tc) = rnd(20) + 140
						cdata(CDATA_WEIGHT, tc) = rnd(10) + 40
					}
					if ( evmode == 146 ) {
						evname = lang("魔闘人形", "battle puppet")
						evold = lang("パペット", "puppet")
						cdata(CDATA_PIC, tc) = xy2pic(13, 28)
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_CON, tc, 15000
					}
					if ( evmode == 147 ) {
						evname = lang("義賊", "gizoku")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_THIEF ) {
							evold = lang("見習い盗賊", "thief")
							cdata(CDATA_PIC, tc) = xy2pic(5, 10)
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ROBBER ) {
							evold = lang("強盗", "robber")
							cdata(CDATA_PIC, tc) = 335 + 3 * 1000
							skillmod SKILL_ATTR_SPD, tc, 15000
						}
						skillmod SKILL_ATTR_DEX, tc, 20000
						skillmod SKILL_ATTR_WIL, tc, 10000
						skillmod SKILL_ACTIVE_PICKPOCKET, tc, 10000
					}
					if ( evmode == 148 ) {
						evname = lang("白衣のレッドクロス", "red cross")
						evold = lang("白衣のナース", "nurse")
						cdata(CDATA_PIC, tc) = xy2pic(24, 4)
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_WIL, tc, 15000
						skillmod SKILL_ATTR_MAG, tc, 15000
					}
					if ( evmode == 149 ) {
						evname = lang("不屈の闘将", "indomitable general")
						evold = lang("敗残兵", "fallen soldier")
						cdata(CDATA_PIC, tc) = xy2pic(13, 29)
						skillmod SKILL_ATTR_LIFE, tc, 25000
						skillmod SKILL_ATTR_SPD, tc, 15000
						skillmod SKILL_ATTR_WIL, tc, 20000
					}
					if ( evmode == 150 ) {
						evname = lang("ロードアーマー", "lord armor")
						evold = lang("デュラハン", "durahan")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_LIVING_ARMOR ) {
							cdata(CDATA_PIC, tc) = xy2pic(18, 28)
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_STEEL_MASS ) {
							cdata(CDATA_PIC, tc) = 942 + 17 * 1000
						}
						skillmod SKILL_ATTR_LIFE, tc, 50000
						skillmod SKILL_ATTR_SPD, tc, 10000
					}
					if ( evmode == 151 ) {
						evname = lang("少年スカウト", "scout boy")
						evold = lang("少年", "little boy")
						cdata(CDATA_PIC, tc) = xy2pic(7, 33)
						skillmod SKILL_ATTR_SPD, tc, 10000
						skillmod SKILL_ATTR_CON, tc, 10000
						skillmod SKILL_NORMAL_COOKING, tc, 10000
						skillmod SKILL_NORMAL_CARPENTRY, tc, 10000
					}
					if ( evmode == 152 ) {
						evname = lang("闘拳男士", "battle boy")
						evold = lang("少年スカウト", "scout boy")
						cdata(CDATA_PIC, tc) = xy2pic(8, 33)
						skillmod SKILL_ATTR_SPD, tc, 15000
						skillmod SKILL_ATTR_STR, tc, 15000
						skillmod SKILL_ATTR_DEX, tc, 15000
					}
					if ( evmode == 153 ) {
						evname = lang("執事羊", "sheep butler")
						evold = lang("執事", "butler")
						cdata(CDATA_PIC, tc) = xy2pic(9, 33)
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ATTR_MAG, tc, 20000
					}
					if ( evmode == 154 ) {
						evname = lang("ビスクドールズ", "bisque dolls")
						evold = lang("ビスクドール", "bisque doll")
						cdata(CDATA_PIC, tc) = xy2pic(10, 33)
						skillmod SKILL_ATTR_MAG, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 20000
					}
					if ( evmode == 155 ) {
						evname = lang("オーボルト", "king kobold")
						evold = lang("コボルト", "kobold")
						cdata(CDATA_PIC, tc) = xy2pic(27, 28)
						skillmod SKILL_ATTR_LIFE, tc, 10000
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 30000
					}
					if ( evmode == 156 ) {
						evname = lang("王躯", "king orc")
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ORC ) {
							evold = lang("オーク", "orc")
							cdata(CDATA_PIC, tc) = 953 + 17 * 1000
							skillmod SKILL_ATTR_SPD, tc, 15000
						}
						if ( cdata(CDATA_ID, tc) == CREATURE_ID_ORC_WARRIOR ) {
							evold = lang("オークの戦士", "orc warrior")
							cdata(CDATA_PIC, tc) = xy2pic(29, 28)
							skillmod SKILL_ATTR_SPD, tc, 10000
						}
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_LIFE, tc, 30000
						cdata(CDATA_HEIGHT, tc) += rnd(20) + 50
						cdata(CDATA_WEIGHT, tc) += rnd(10) + 40
					}
					if ( evmode == 157 ) {
						evname = lang("バーニングポーク", "burning pork")
						evold = lang("ポーク", "porc")
						cdata(CDATA_PIC, tc) = xy2pic(22, 25)
						skillmod SKILL_ATTR_STR, tc, 20000
						skillmod SKILL_ATTR_SPD, tc, 20000
						skillmod SKILL_ACTIVE_RIDING, tc, 10000
					}
					if ( synccheck(tc, -1) ) {
						txtef COLOR_GREEN
						txt lang("おめでとう！" + cdatan(CDATAN_NAME, tc) + "は" + evname + "に進化した！", "Congratulations! Your friend has evolved!")
					}
					cdata(CDATA_HP, tc) = cdata(CDATA_MAX_HP, tc)
					if ( strmid(cdatan(CDATAN_NAME, tc), 0, strlen(evold)) == evold ) {
						cdatan(CDATAN_NAME, tc) = evname + strmid(cdatan(CDATAN_NAME, tc), strlen(evold), strlen(cdatan(CDATAN_NAME, tc)) - strlen(evold))
					}
					inv(INV_ITEM_NUM, ci)--
					cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
					cdata(CDATA_EVOLUTION_STAGE, tc) += 1
					evmode = 0
					goto *turn_end
				}
				txt lang("組み合わせが違うようだ。", "Seems to have no effect using.")
				evmode = 0
				goto *turn_end
			}
		}
		if ( f == 0 ) {
			txt lang("それは無理だ。", "It's impossible.")
		}
		txt lang("仲間にしか使えない。", "Seems to have no effect using.")
		evmode = 0
		goto *turn_end
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 30 | _switch_sw ) {
		_switch_sw = 0
		txt lang(itemname(ci, 1) + "を始動させた。", "You activate " + itemname(ci, 1) + ".")
		efid = inv(INV_ITEM_PARAM1, ci)
		efp = inv(INV_ITEM_PARAM2, ci)
		tc = cc
		efstatus = 0
		gosub *effect
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 41 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_NEW_FEAT) > cdata(CDATA_LEVEL, CHARA_PLAYER) ) {
			txt lang("クミロミの声がした。「ダメ…経験…足りない…」", "Kumiromi talks to you, " + cnvtalk("No...you aren't...experienced enough...for this..."))
			gosub *screen_draw
			goto *pc_turn
		}
		snd SOUNDLIST_PRAY1
		gdata(GDATA_NEW_FEAT) += 10
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		gdata(GDATA_TRAIT_POINT)++
		txt lang("「…よく…経験をつんだね…酬いてあげる…」", cnvtalk("...You have acquired enough...experience...I shall reward you..."))
		txtef COLOR_YELLOW
		txt lang("クミロミはあなたを祝福した。あなたは新たなフィートを取得できるようになった！", "Kumiromi blesses you. You can obtain one more feat now!")
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 42 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_CURSE1
		txtef COLOR_PURPLE
		txt lang("何だか嫌な予感がする…", "You have a bad feeling about this...")
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 46 | _switch_sw ) {
		_switch_sw = 0
		txtnew
		txt lang("本当に首を吊る？", "Really hang yourself?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			goto *turn_end
		}
		dmghp CHARA_PLAYER, 99999, DAMAGE_FROM_HANGING
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 98 | _switch_sw ) {
		_switch_sw = 0
		_switch_sw++
	}
	if ( _switch_val == 46 | _switch_sw ) {
		_switch_sw = 0
		txtnew
		txt lang("本当に腹を切る？", "Really seppuku yourself?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			goto *turn_end
		}
		txtef COLOR_RED2
		txt lang("あなたはこの場をおさめるために腹を切った！", "You cut your belly for an apology!")
		snd SOUNDLIST_STAB
		cdata(CDATA_HP, CHARA_PLAYER) = cdata(CDATA_HP, CHARA_PLAYER) / 8
		dmgcon CHARA_PLAYER, CONDITION_BLEED, 1000
		if ( gdata(GDATA_FLAG_DUEL_TARGET) > 0 ) {
			gdata(GDATA_FLAG_DUEL_TARGET) = 0
			txt lang("＊決闘終了＊", "*Duel-Over!*")
		}
		repeat 245
			if ( cdata(CDATA_EXIST, cnt) != CHAR_STATE_ALIVE ) {
				continue
			}
			if ( dist(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt)) > sdataref(SKILL_DATAREF_TG, SKILL_SPACT_CHEER) \ 1000 + 1 ) {
				continue
			}
			if ( fov_los(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), cdata(CDATA_X, cnt), cdata(CDATA_Y, cnt)) == 0 ) {
				continue
			}
			cdata(CDATA_AI_AGGRO, cnt) = 0
			cdata(CDATA_TARGET, cc) = 0
			if ( cdata(CDATA_RELATION_ORG, cnt) >= RELATION_HATE ) {
				if ( cdata(CDATA_RELATION, cnt) <= RELATION_HATE ) {
					cdata(CDATA_RELATION, cnt) = cdata(CDATA_RELATION_ORG, cnt)
				}
			}
			if ( cdata(CDATA_CONDITION_SEPPUKU, cnt) > 0 ) {
				snd SOUNDLIST_ATKSWORD
				txtef COLOR_RED
				txt lang("「介錯つかまつる！」 *ブシュッ* ", "*Kaisyaku*")
				txtvalid = 0
				txt lang(name(cnt) + "は" + name(0) + "の首をちょんぎった。", name(cnt) + " cut" + _s(cnt) + " " + name(0) + your(CHARA_PLAYER) + " head.")
				cdata(CDATA_HP, CHARA_PLAYER) = 1
				cdata(CDATA_MP, CHARA_PLAYER) = 0
				dmghp CHARA_PLAYER, cdata(CDATA_MAX_HP, CHARA_PLAYER), cnt, SKILL_SPACT_DECAPITATION
				break
			}
			if ( cnt != 0 ) {
				cdata(CDATA_CONDITION_SEPPUKU, cnt) = 15 + rnd(36)
			}
			if ( cnt < 16 ) {
				continue
			}
			if ( rnd(2) == 0 ) {
				continue
			}
			txt lang("「ナイスハラキリ！」", cnvtalk("Nice harakiri!")), lang("「気が変わらないうちに早く行け」", cnvtalk("Leave before my mind changes!")), lang("「なんて無茶を…」", cnvtalk("Oh...!")), lang("「見事な切腹よ」", cnvtalk("It's a splendid seppuku!"))
		loop
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 33 | _switch_sw ) {
		_switch_sw = 0
		if ( gdata(GDATA_AREA) == AREA_SHOW_HOUSE | (gdata(GDATA_AREA) == AREA_CHAOS_CRADLE & gdata(GDATA_LEVEL) == 179) ) {
			txt lang("ここでは使えない。", "You can't place it here.")
			goto *act_use_SWEND1
		}
		if ( inv(INV_ITEM_SUB_NAME, ci) == 0 ) {
			txt lang("モンスターボールは空っぽだ。", "This ball is empty.")
			goto *act_use_SWEND1
		}
		if ( get_freeally() == 0 ) {
			txt lang("仲間はこれ以上増やせない。", "Your party is full.")
			goto *act_use_SWEND1
		}
		txt lang(itemname(ci, 1) + "を使用した。", "You activate " + itemname(ci, 1) + ".")
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		flt
		novoidlv = 1
		fixlv = FIX_QUALITY_GOOD
		characreate MAX_CHARA_NC, inv(INV_ITEM_SUB_NAME, ci), -3, 0
		rc = MAX_CHARA_NC
		gosub *add_ally
		autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 65 | _switch_sw ) {
		_switch_sw = 0
		x = cdata(CDATA_X, cc)
		y = cdata(CDATA_Y, cc)
		cell_featread x, y
		if ( chipm(CHIPM_ROLE, map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID)) != MAP_CHIP_ROLE_CROP ) {
			txt lang("畑以外には施肥できない。", "You don't see any plant on the ground.")
			goto *act_use_SWEND1
		}
		if ( feat != tile_plant + 1 ) {
			txt lang("それは成長途中の作物にしか使えない。", "The plant has already grown full.")
			goto *act_use_SWEND1
		}
		if ( feat == tile_plant + 2 ) {
			txt lang("この作物は既に成長しきっている。", "The plant has already grown full.")
			goto *act_use_SWEND1
		}
		if ( feat == tile_plant + 1 ) {
			inv(INV_ITEM_NUM, ci)--
			cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
			feat = tile_plant + 6
			txt lang("作物がみるみる成長していく！", "The plant grows.")
		}
		cell_featset x, y, feat, feat(FEAT_CELL_FEATURE_ID), feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1)
		animeload 8, 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 31 | _switch_sw ) {
		_switch_sw = 0
		x = cdata(CDATA_X, cc)
		y = cdata(CDATA_Y, cc)
		cell_featread x, y
		if ( feat(FEAT_CELL_FEATURE_ID) != CELL_FEATURE_PLANTED_SEED ) {
			txt lang("それは種を植えた場所で使わなければならない。", "You don't see any plant on the ground.")
			goto *act_use_SWEND1
		}
		if ( feat == tile_plant + 2 ) {
			txt lang("この作物は既に成長しきっている。", "The plant has already grown full.")
			goto *act_use_SWEND1
		}
		if ( feat == tile_plant + 3 ) {
			feat = tile_plant + 1
			gosub *item_seedNextGrowth
			txt lang("枯れた植物に生命が宿った。", "The plant revives.")
		}
		else {
			feat++
			txt lang("植物は成長した。", "The plant grows.")
		}
		cell_featset x, y, feat, feat(FEAT_CELL_FEATURE_ID), feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1)
		animeload 8, 0
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 32 | _switch_sw ) {
		_switch_sw = 0
		txtnew
		txt lang("まずは素体となる仲間を選ぶ必要がある。", "Choose an original body.")
		txtmore
		rc = CHARA_PLAYER
		allyctrl = 5
		gosub *com_ally
		if ( stat == (-1) ) {
			goto *turn_end
		}
		rc = stat
		txtnew
		txt lang("能力を取り出す仲間を選ぶ必要がある。この仲間は合成後、永久に失われる。", "Choose a gene. Once you extract a gene, the subject will be lost forever.")
		txtmore
		allyctrl = 5
		gosub *com_ally
		if ( stat == (-1) ) {
			goto *turn_end
		}
		tc = stat
		if ( cdata(CDATA_PRECIOUS_ALLY, tc) != 0 ) {
			snd SOUNDLIST_FAIL1
			txt lang(cdatan(CDATAN_NAME, tc) + "はあなたの大事な仲間だ。", "It's precious your ally.")
			goto *turn_end
		}
		gosub *screen_draw
		txtnew
		txt lang("本当に" + cdatan(CDATAN_NAME, rc) + "に" + cdatan(CDATAN_NAME, tc) + "の能力を組み込む？", "Really add " + cdatan(CDATAN_NAME, tc) + "'s gene to " + cdatan(CDATAN_NAME, rc) + "?")
		promptl(0, 0) = stryes, "y", "0"
		promptl(0, 1) = strno, "n", "1"
		promptmax = 2
		val = promptx, prompty, 160, 1
		gosub *prompt_key
		if ( rtval != 0 ) {
			goto *turn_end
		}
		txtnew
		txtef COLOR_YELLOW
		txt lang("" + cdatan(CDATAN_NAME, rc) + "は" + cdatan(CDATAN_NAME, tc) + "の能力を受けついだ！", "" + cdatan(CDATAN_NAME, rc) + " has inherited " + cdatan(CDATAN_NAME, tc) + "'s gene!")
		animeid = ANIMATION_GENE
		anic = rc
		gosub *anime
		gosub *gene_body
		if ( stat != (-1) ) {
			cdata(stat, rc) = rtval * 10000
			txtef COLOR_GREEN
			txt lang(cdatan(CDATAN_NAME, rc) + "は新しい" + bodyn(rtval) + "を得た！", cdatan(CDATAN_NAME, rc) + " gains new " + bodyn(rtval) + "!")
			r1 = rc
			gosub *calcBodyFix
		}
		gosub *gene_skill
		if ( stat != 0 ) {
			repeat 2
				if ( rtval(cnt) == (-1) ) {
					break
				}
				skillgain rc, rtval(cnt), 1
				txtef COLOR_GREEN
				txt lang(cdatan(CDATAN_NAME, rc) + "は" + skillname(rtval(cnt)) + "の技術を覚えた！", cdatan(CDATAN_NAME, rc) + " learns " + skillname(rtval(cnt)) + " skill!")
			loop
		}
		if ( cdata(CDATA_LEVEL, tc) > cdata(CDATA_LEVEL, rc) ) {
			if ( cdata(CDATA_ID, tc) != CREATURE_ID_USER ) {
				lv = (cdata(CDATA_LEVEL, tc) - cdata(CDATA_LEVEL, rc)) / 2 + 1
				repeat lv
					r1 = rc
					r2 = 1
					gosub *calcLevelUp
				loop
				txtef COLOR_GREEN
				txt lang(cdatan(CDATAN_NAME, rc) + "はレベル" + cdata(CDATA_LEVEL, rc) + "になった！", cdatan(CDATAN_NAME, rc) + " is now level " + cdata(CDATA_LEVEL, rc) + "!")
				listmax = 0
				repeat 18 - 10, 10
					list(0, listmax) = cnt, sorg(cnt, tc)
					listmax++
				loop
				gosub *sort_list
				repeat 3
					p = listmax - cnt - 1
					i = list(0, p)
					if ( list(1, p) > sorg(i, rc) ) {
						p = (list(1, p) - sorg(i, rc)) * 500
						p = limit(p * 10 / limit(lv, 2, 10), 1000, 10000)
						skillmod i, rc, p
						txtmore
					}
				loop
			}
		}
		cdata(CDATA_AREA, tc) = AREA_NONE
		chara_vanquish tc
		skillexp SKILL_NORMAL_GENE_ENGINEER, CHARA_PLAYER, 1200
		randomize
		screenupdate = -1
		gosub *screen_draw
		cc = rc
		csctrl = 4
		snd SOUNDLIST_POP2
		gosub *com_charainfo
		cc = CHARA_PLAYER
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 35 | _switch_sw ) {
		_switch_sw = 0
		txt lang("あなたはアイアンメイデンの中に入った。", "You enter the iron maiden.")
		txtmore
		txtef COLOR_SKY_BLUE
		txt lang("「わくわく♪」", cnvtalk("Interesting!"))
		txtmore
		txt lang("突然誰かが蓋を閉めた。", "Suddenly, someone closes the door.")
		txtmore
		txtef COLOR_SKY_BLUE
		txt lang("「ニヤリ」", "*Grin*")
		dmghp CHARA_PLAYER, 9999, DAMAGE_FROM_MAIDEN
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 36 | _switch_sw ) {
		_switch_sw = 0
		txt lang("あなたはギロチンに首をつっこんでみた。", "You set your head on the guillotine.")
		txtmore
		txtef COLOR_SKY_BLUE
		txt lang("「わくわく♪」", cnvtalk("Interesting!"))
		txtmore
		txt lang("突然誰かがギロチンの刃を落とした。", "Suddenly, someone activates the guillotine.")
		txtmore
		txtef COLOR_SKY_BLUE
		txt lang("「ニヤリ」", "*Grin*")
		dmghp CHARA_PLAYER, 9999, DAMAGE_FROM_GUILLOTINE
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 39 | _switch_sw ) {
		_switch_sw = 0
		snd SOUNDLIST_WHISTLE
		txtef COLOR_SKY_BLUE
		txt lang(" *ピーーーー* ", "*Peeeeeeeeeep* ")
		make_sound cdata(CDATA_X, cc), cdata(CDATA_Y, cc), 10, 1, 1, cc
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 37 | _switch_sw ) {
		_switch_sw = 0
		tcgdeck
		gosub *map_prepareTile
		gosub *screen_refreshFull
		txtnew
		txt lang("デッキをしまった。", "You put away the deck.")
		goto *act_use_SWEND1
		_switch_sw++
	}
	if ( _switch_val == 38 | _switch_sw ) {
		_switch_sw = 0
		inv_find ITEM_ID_DECK, CHARA_PLAYER
		if ( stat == (-1) ) {
			txt lang("デッキを所持していない。", "You don't have a deck.")
			gosub *screen_draw
			goto *pc_turn
		}
		snd SOUNDLIST_CARD1
		inv(INV_ITEM_NUM, ci)--
		cell_refresh inv(INV_ITEM_X, ci), inv(INV_ITEM_Y, ci)
		txt lang(itemname(ci, 1) + "をデッキに加えた。", "You add " + itemname(ci, 1) + " to your deck.")
		card(0, inv(INV_ITEM_SUB_NAME, ci))++
		goto *act_use_SWEND1
	}

*act_use_SWEND1
	gosub *calcBurdenPc
	goto *turn_end

*gene_skill
	if ( cdata(CDATA_ID, tc) == CREATURE_ID_USER ) {
		return 0
	}
	if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) ) {
		return 0
	}
	randomize cdata(CDATA_ID, tc)
	dbmax = 0
	repeat 100
		rtval = rnd(191 - 150) + 150
		if ( sdata(rtval, rc) == 0 ) {
			if ( sdata(rtval, tc) > 0 ) {
				dblist(0, dbmax) = rtval
				dbmax++
			}
		}
	loop
	repeat 10
		rtval = rnd(302 - 300) + 300
		if ( sdata(rtval, rc) == 0 ) {
			if ( sdata(rtval, tc) > 0 ) {
				dblist(0, dbmax) = rtval
				dbmax++
			}
		}
	loop
	rtval = dblist(0, 0), -1
	if ( dbmax >= 2 ) {
		if ( rnd(3) == 0 ) {
			repeat dbmax - 1, 1
				if ( dblist(0, cnt) != rtval ) {
					rtval(1) = dblist(0, cnt)
					break
				}
			loop
		}
	}
	randomize
	return dbmax

*gene_body
	dbmax = 0
	s(1) = refchara(cdata(CDATA_ID, tc), DBSPEC_CHARA_FILTER, 1)
	if ( instr(s(1), 0, "/man/") != (-1) ) {
		return -1
	}
	if ( cdata(CDATA_ID, tc) == CREATURE_ID_USER ) {
		return -1
	}
	if ( cbit(CHARA_BIT_SPLIT_KEEP_EFFECT, tc) | cbit(CHARA_BIT_SPLIT_NO_EFFECT, tc) | cbit(CHARA_BIT_ALTERED_LIMBS, tc) ) {
		return -1
	}
	rtval(1) = -1
	repeat 30, 100
		if ( cdata(cnt, rc) == 0 ) {
			rtval(1) = cnt
		}
	loop
	if ( rtval(1) == (-1) ) {
		return -1
	}
	repeat 30, 100
		f = cdata(cnt, tc) / EXT_EQUIP_SLOTS
		if ( f == 11 | f == 10 | f == 4 ) {
			continue
		}
		if ( f != 0 ) {
			dblist(0, dbmax) = f
			dbmax++
		}
	loop
	if ( dbmax == 0 ) {
		return -1
	}
	randomize cdata(CDATA_ID, tc)
	repeat 3
		rtval = dblist(0, rnd(dbmax))
		f = 0
		repeat 30, 100
			if ( cdata(cnt, rc) == 0 ) {
				continue
			}
			if ( cdata(cnt, rc) / EXT_EQUIP_SLOTS == rtval ) {
				f = 1
			}
		loop
		if ( f ) {
			break
		}
	loop
	if ( f == 0 ) {
		randomize
		return rtval(1)
	}
	dim dblist, 2, 1199
	repeat 30, 100
		dblist(0, cdata(cnt, tc) / EXT_EQUIP_SLOTS)++
	loop
	repeat 25
		rtval = rnd(15) + 1
		f = 0
		repeat 30, 100
			if ( cdata(cnt, rc) / EXT_EQUIP_SLOTS == rtval ) {
				f++
			}
		loop
		if ( f < dblist(0, rtval) ) {
			f = -1
			break
		}
	loop
	randomize
	if ( f == (-1) ) {
		return rtval(1)
	}
	else {
		return -1
	}

*item_seed
	screenupdate = -1
	gosub *screen_draw
	if ( mdata(MDATA_TYPE) == MAP_TYPE_WORLD | mdata(MDATA_TYPE) == MAP_TYPE_TOWN | mdata(MDATA_TYPE) == MAP_TYPE_VILLAGE ) {
		txt lang("この場所には埋められない。", "You can't plant it here.")
		gosub *screen_draw
		goto *pc_turn
	}
	if ( map(cdata(CDATA_X, cc), cdata(CDATA_Y, cc), MAP_FEATS_ON_TILE) != 0 ) {
		txt lang("この場所には埋められない。", "You can't plant it here.")
		gosub *screen_draw
		goto *pc_turn
	}
	if ( chipm(CHIPM_ROLE, map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_TILE_ID)) == MAP_CHIP_ROLE_CROP ) {
		val = 1
	}
	else {
		val = 0
	}
	feat = tile_plant, 29, inv(INV_ITEM_MATERIAL, ci)
	gosub *item_seedNextGrowth
	if ( val ) {
		s = "畑に"
	}
	else {
		s = ""
	}
	s += lang("" + itemname(ci, 1) + "を埋めた。", "You plant " + itemname(ci, 1))
	txt s
	snd SOUNDLIST_BUSH1
	removeitem ci, 1
	cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tile_plant, CELL_FEATURE_PLANTED_SEED, inv(INV_ITEM_MATERIAL, ci), feat(FEAT_CELL_PARAM_1)
	if ( dbg_plant ) {
		cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), tile_plant + 1, CELL_FEATURE_PLANTED_SEED, inv(INV_ITEM_MATERIAL, ci), feat(FEAT_CELL_PARAM_1)
	}
	goto *turn_end

*item_seedGrowth
	if ( feat == tile_plant + 6 ) {
		return
	}
	feat(FEAT_CELL_PARAM_1)--
	if ( feat(FEAT_CELL_PARAM_1) \ 50 == 0 ) {
		if ( feat(FEAT_CELL_PARAM_1) >= 50 ) {
			feat = tile_plant + 3
		}
		else {
			feat++
			gosub *item_seedNextGrowth
		}
	}
	return

*item_seedNextGrowth
	if ( feat == tile_plant + 6 ) {
		return
	}
	feat(FEAT_CELL_PARAM_1) = 4 + rnd(4 + 1)
	p = 10
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_GEM ) {
		p = 15
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_MAGIC ) {
		p = 25
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_HERB ) {
		p = 30
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_STRANGE ) {
		p = 25
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_ARTIFACT ) {
		p = 40
	}
	if ( val == 0 ) {
		p = p * 3 / 2
	}
	if ( val == 1 ) {
		p = p * 1 / 2
	}
	if ( feat == tile_plant ) {
		if ( gdata(GDATA_WEATHER) < WEATHER_RAIN ) {
			p = p * 2
		}
	}
	if ( sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) < rnd(p + 1) | rnd(20) == 0 ) {
		feat(FEAT_CELL_PARAM_1) += 50
	}
	return

*item_seedRegrowth
	p = 15
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_GEM ) {
		p = 25
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_MAGIC ) {
		p = 30
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_HERB ) {
		p = 40
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_STRANGE ) {
		p = 35
	}
	if ( val == 0 ) {
		p = p * 4
	}
	if ( val == 1 ) {
		p = p * 1 / 2
	}
	if ( gdata(GDATA_WEATHER) < WEATHER_RAIN ) {
		p = p * 4 / 3
	}
	saibai = 0
	item_find ITEM_ID_SCISSORS_OF_KUMIROMI, ITEM_FIND_MODE_DBID, ITEM_FIND_LOCATION_CHARAS
	if ( stat != (-1) ) {
		if ( inv(INV_ITEM_NUM, stat) >= 1 ) {
			saibai = 100
		}
	}
	if ( sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) < rnd(p + 1) | rnd(200) < p - saibai | feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_ARTIFACT ) {
		map(cdata(CDATA_X, CHARA_PLAYER), cdata(CDATA_Y, CHARA_PLAYER), MAP_FEATS_ON_TILE) = 0
		return
	}
	saibai = 0
	feat = tile_plant
	gosub *item_seedNextGrowth
	cell_featset cdata(CDATA_X, cc), cdata(CDATA_Y, cc), feat, feat(FEAT_CELL_FEATURE_ID), feat(FEAT_CELL_SUB_FEATURE_ID), feat(FEAT_CELL_PARAM_1)
	txtef COLOR_GREEN
	txt lang("新しい芽が息吹いている！", "A new plant grows!")
	return

*item_seedPick
	skillexp SKILL_NORMAL_GARDENING, CHARA_PLAYER, 300
	gardenlv != 0
	snd SOUNDLIST_BUSH1
	flt (sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) + 1) / 2 + 15, FIX_QUALITY_GOOD
	dbid = 0
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_STRANGE ) {
		if ( rnd(6) == 0 ) {
			flttypemajor = fsetplantunknown(rnd(length(fsetplantunknowns)))
		}
		else {
			gardenlv = 10
			if ( gdata(GDATA_MONTH) >= 3 & gdata(GDATA_MONTH) <= 5 ) {
				dbid = isetplantunknownh(rnd(length(isetplantunknownh)))
			}
			if ( gdata(GDATA_MONTH) >= 6 & gdata(GDATA_MONTH) <= 8 ) {
				dbid = isetplantunknownn(rnd(length(isetplantunknownn)))
			}
			if ( gdata(GDATA_MONTH) >= 9 & gdata(GDATA_MONTH) <= 11 ) {
				dbid = isetplantunknowna(rnd(length(isetplantunknowna)))
			}
			if ( gdata(GDATA_MONTH) == 12 | gdata(GDATA_MONTH) <= 2 ) {
				dbid = isetplantunknownf(rnd(length(isetplantunknownf)))
			}
		}
		if ( rnd(100) == 0 ) {
			dbid = 559
			gardenlv = 0
		}
	}
	if ( gardenlv != 10 ) {
		if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_ARTIFACT | (feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_STRANGE & rnd(50) == 0) ) {
			flttypemajor = fsetplantartifact(rnd(length(fsetplantartifact)))
			fixlv = FIX_QUALITY_MIRACLE
			autosave = 1 * (gdata(GDATA_AREA) != AREA_SHOW_HOUSE)
		}
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_VEGETABLE ) {
		gardenlv = 10
		if ( gdata(GDATA_MONTH) >= 3 & gdata(GDATA_MONTH) <= 5 ) {
			dbid = isetplantvegeh(rnd(length(isetplantvegeh)))
		}
		if ( gdata(GDATA_MONTH) >= 6 & gdata(GDATA_MONTH) <= 8 ) {
			dbid = isetplantvegen(rnd(length(isetplantvegen)))
		}
		if ( gdata(GDATA_MONTH) >= 9 & gdata(GDATA_MONTH) <= 11 ) {
			dbid = isetplantvegea(rnd(length(isetplantvegea)))
		}
		if ( gdata(GDATA_MONTH) == 12 | gdata(GDATA_MONTH) <= 2 ) {
			dbid = isetplantvegef(rnd(length(isetplantvegef)))
		}
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_FRUIT ) {
		gardenlv = 10
		if ( gdata(GDATA_MONTH) >= 3 & gdata(GDATA_MONTH) <= 5 ) {
			dbid = isetplantfruith(rnd(length(isetplantfruith)))
		}
		if ( gdata(GDATA_MONTH) >= 6 & gdata(GDATA_MONTH) <= 8 ) {
			dbid = isetplantfruitn(rnd(length(isetplantfruitn)))
		}
		if ( gdata(GDATA_MONTH) >= 9 & gdata(GDATA_MONTH) <= 11 ) {
			dbid = isetplantfruita(rnd(length(isetplantfruita)))
		}
		if ( gdata(GDATA_MONTH) == 12 | gdata(GDATA_MONTH) <= 2 ) {
			dbid = isetplantfruitf(rnd(length(isetplantfruitf)))
		}
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_HERB ) {
		flttypeminor = FILTER_ITEM_FOOD_HERB
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_GEM ) {
		flttypeminor = FILTER_ORE_GEM
	}
	if ( feat(FEAT_CELL_SUB_FEATURE_ID) == CELL_SUB_FEATURE_SEED_MAGIC ) {
		if ( gdata(GDATA_MONTH) >= 3 & gdata(GDATA_MONTH) <= 5 ) {
			flttypeminor = FILTER_ITEM_ROD_HEALING
		}
		if ( gdata(GDATA_MONTH) >= 6 & gdata(GDATA_MONTH) <= 8 ) {
			flttypeminor = FILTER_ITEM_ROD_DAMAGE
		}
		if ( gdata(GDATA_MONTH) >= 9 & gdata(GDATA_MONTH) <= 11 ) {
			flttypeminor = FILTER_ITEM_ROD_UTILITY
		}
		if ( gdata(GDATA_MONTH) == 12 | gdata(GDATA_MONTH) <= 2 ) {
			flttypeminor = FILTER_ITEM_ROD_ENVIRONMENTAL
		}
	}
	if ( gardenlv != 0 ) {
		itemcreate CHARA_PLAYER, dbid, -1, -1, 0
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
		inv(INV_ITEM_LEVEL, ci) += limit(rnd((sdata(SKILL_NORMAL_GARDENING, CHARA_PLAYER) + 1) / 12 + 2), 0, 10)
		if ( feat == tile_plant + 6 ) {
			inv(INV_ITEM_LEVEL, ci) += 5
		}
		gardenlv = 0
	}
	else {
		itemcreate CHARA_PLAYER, dbid, -1, -1, 0
		inv(INV_ITEM_STATUS, ci) = ITEM_STATUS_NORMAL
	}
	txt lang(itemname(ci, 1) + "を収穫した。", "You harvest " + itemname(ci, 1) + ".")
	item_stack CHARA_PLAYER, ci, 1
	return

*act_pickpocket
	gdata(GDATA_ROW_ACT) = ACTION_STEAL
	gosub *generalAct
	return
	goto *chat_refresh



















































